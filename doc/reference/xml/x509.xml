<?xml version="1.0"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
               "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd"
[
  <!ENTITY % local.common.attrib "xmlns:xi  CDATA  #FIXED 'http://www.w3.org/2003/XInclude'">
  <!ENTITY version SYSTEM "version.xml">
]>
<refentry id="gnutls-x509">
<refmeta>
<refentrytitle role="top_of_page" id="gnutls-x509.top_of_page">x509</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo>
  GNUTLS Library
</refmiscinfo>
</refmeta>
<refnamediv>
<refname>x509</refname>
<refpurpose></refpurpose>
</refnamediv>

<refsynopsisdiv id="gnutls-x509.synopsis" role="synopsis">
<title role="synopsis.title">Synopsis</title>

<synopsis>#define             <link linkend="GNUTLS-CRL-REASON-SUPERSEEDED:CAPS">GNUTLS_CRL_REASON_SUPERSEEDED</link>
#define             <link linkend="GNUTLS-FSAN-APPEND:CAPS">GNUTLS_FSAN_APPEND</link>
#define             <link linkend="GNUTLS-FSAN-SET:CAPS">GNUTLS_FSAN_SET</link>
#define             <link linkend="GNUTLS-KP-ANY:CAPS">GNUTLS_KP_ANY</link>
#define             <link linkend="GNUTLS-KP-CODE-SIGNING:CAPS">GNUTLS_KP_CODE_SIGNING</link>
#define             <link linkend="GNUTLS-KP-EMAIL-PROTECTION:CAPS">GNUTLS_KP_EMAIL_PROTECTION</link>
#define             <link linkend="GNUTLS-KP-IPSEC-IKE:CAPS">GNUTLS_KP_IPSEC_IKE</link>
#define             <link linkend="GNUTLS-KP-MS-SMART-CARD-LOGON:CAPS">GNUTLS_KP_MS_SMART_CARD_LOGON</link>
#define             <link linkend="GNUTLS-KP-OCSP-SIGNING:CAPS">GNUTLS_KP_OCSP_SIGNING</link>
#define             <link linkend="GNUTLS-KP-TIME-STAMPING:CAPS">GNUTLS_KP_TIME_STAMPING</link>
#define             <link linkend="GNUTLS-KP-TLS-WWW-CLIENT:CAPS">GNUTLS_KP_TLS_WWW_CLIENT</link>
#define             <link linkend="GNUTLS-KP-TLS-WWW-SERVER:CAPS">GNUTLS_KP_TLS_WWW_SERVER</link>
#define             <link linkend="GNUTLS-MAX-QUALIFIERS:CAPS">GNUTLS_MAX_QUALIFIERS</link>
#define             <link linkend="GNUTLS-OID-AD-CAISSUERS:CAPS">GNUTLS_OID_AD_CAISSUERS</link>
#define             <link linkend="GNUTLS-OID-AD-OCSP:CAPS">GNUTLS_OID_AD_OCSP</link>
#define             <link linkend="GNUTLS-OID-AIA:CAPS">GNUTLS_OID_AIA</link>
#define             <link linkend="GNUTLS-OID-LDAP-DC:CAPS">GNUTLS_OID_LDAP_DC</link>
#define             <link linkend="GNUTLS-OID-LDAP-UID:CAPS">GNUTLS_OID_LDAP_UID</link>
#define             <link linkend="GNUTLS-OID-PKCS9-EMAIL:CAPS">GNUTLS_OID_PKCS9_EMAIL</link>
#define             <link linkend="GNUTLS-OID-PKIX-COUNTRY-OF-CITIZENSHIP:CAPS">GNUTLS_OID_PKIX_COUNTRY_OF_CITIZENSHIP</link>
#define             <link linkend="GNUTLS-OID-PKIX-COUNTRY-OF-RESIDENCE:CAPS">GNUTLS_OID_PKIX_COUNTRY_OF_RESIDENCE</link>
#define             <link linkend="GNUTLS-OID-PKIX-DATE-OF-BIRTH:CAPS">GNUTLS_OID_PKIX_DATE_OF_BIRTH</link>
#define             <link linkend="GNUTLS-OID-PKIX-GENDER:CAPS">GNUTLS_OID_PKIX_GENDER</link>
#define             <link linkend="GNUTLS-OID-PKIX-PLACE-OF-BIRTH:CAPS">GNUTLS_OID_PKIX_PLACE_OF_BIRTH</link>
#define             <link linkend="GNUTLS-OID-X520-COMMON-NAME:CAPS">GNUTLS_OID_X520_COMMON_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-COUNTRY-NAME:CAPS">GNUTLS_OID_X520_COUNTRY_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-DN-QUALIFIER:CAPS">GNUTLS_OID_X520_DN_QUALIFIER</link>
#define             <link linkend="GNUTLS-OID-X520-GENERATION-QUALIFIER:CAPS">GNUTLS_OID_X520_GENERATION_QUALIFIER</link>
#define             <link linkend="GNUTLS-OID-X520-GIVEN-NAME:CAPS">GNUTLS_OID_X520_GIVEN_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-INITIALS:CAPS">GNUTLS_OID_X520_INITIALS</link>
#define             <link linkend="GNUTLS-OID-X520-LOCALITY-NAME:CAPS">GNUTLS_OID_X520_LOCALITY_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-NAME:CAPS">GNUTLS_OID_X520_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-ORGANIZATIONAL-UNIT-NAME:CAPS">GNUTLS_OID_X520_ORGANIZATIONAL_UNIT_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-ORGANIZATION-NAME:CAPS">GNUTLS_OID_X520_ORGANIZATION_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-POSTALCODE:CAPS">GNUTLS_OID_X520_POSTALCODE</link>
#define             <link linkend="GNUTLS-OID-X520-PSEUDONYM:CAPS">GNUTLS_OID_X520_PSEUDONYM</link>
#define             <link linkend="GNUTLS-OID-X520-STATE-OR-PROVINCE-NAME:CAPS">GNUTLS_OID_X520_STATE_OR_PROVINCE_NAME</link>
#define             <link linkend="GNUTLS-OID-X520-SURNAME:CAPS">GNUTLS_OID_X520_SURNAME</link>
#define             <link linkend="GNUTLS-OID-X520-TITLE:CAPS">GNUTLS_OID_X520_TITLE</link>
#define             <link linkend="GNUTLS-PKCS8-PLAIN:CAPS">GNUTLS_PKCS8_PLAIN</link>
#define             <link linkend="GNUTLS-PKCS8-USE-PKCS12-3DES:CAPS">GNUTLS_PKCS8_USE_PKCS12_3DES</link>
#define             <link linkend="GNUTLS-PKCS8-USE-PKCS12-ARCFOUR:CAPS">GNUTLS_PKCS8_USE_PKCS12_ARCFOUR</link>
#define             <link linkend="GNUTLS-PKCS8-USE-PKCS12-RC2-40:CAPS">GNUTLS_PKCS8_USE_PKCS12_RC2_40</link>
#define             <link linkend="GNUTLS-TL-VERIFY-CRL:CAPS">GNUTLS_TL_VERIFY_CRL</link>
#define             <link linkend="GNUTLS-X509-DN-OID-RETURN-OID:CAPS">GNUTLS_X509_DN_OID_RETURN_OID</link>
enum                <link linkend="gnutls-certificate-import-flags">gnutls_certificate_import_flags</link>;
enum                <link linkend="gnutls-certificate-verify-flags">gnutls_certificate_verify_flags</link>;
enum                <link linkend="gnutls-info-access-what-t">gnutls_info_access_what_t</link>;
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-pkcs7-deinit">gnutls_pkcs7_deinit</link>                 (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-delete-crl">gnutls_pkcs7_delete_crl</link>             (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-delete-crt">gnutls_pkcs7_delete_crt</link>             (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-export">gnutls_pkcs7_export</link>                 (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-export2">gnutls_pkcs7_export2</link>                (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-get-crl-count">gnutls_pkcs7_get_crl_count</link>          (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-get-crl-raw">gnutls_pkcs7_get_crl_raw</link>            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *crl</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *crl_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-get-crt-count">gnutls_pkcs7_get_crt_count</link>          (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-get-crt-raw">gnutls_pkcs7_get_crt_raw</link>            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *certificate</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *certificate_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-import">gnutls_pkcs7_import</link>                 (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-init">gnutls_pkcs7_init</link>                   (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> *pkcs7</parameter>);
struct              <link linkend="gnutls-pkcs7-int">gnutls_pkcs7_int</link>;
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-set-crl">gnutls_pkcs7_set_crl</link>                (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-set-crl-raw">gnutls_pkcs7_set_crl_raw</link>            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-set-crt">gnutls_pkcs7_set_crt</link>                (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-pkcs7-set-crt-raw">gnutls_pkcs7_set_crt_raw</link>            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *crt</parameter>);
typedef             <link linkend="gnutls-pkcs7-t">gnutls_pkcs7_t</link>;
enum                <link linkend="gnutls-pkcs-encrypt-flags-t">gnutls_pkcs_encrypt_flags_t</link>;
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-check-issuer">gnutls_x509_crl_check_issuer</link>        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-crl-deinit">gnutls_x509_crl_deinit</link>              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-export">gnutls_x509_crl_export</link>              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-export2">gnutls_x509_crl_export2</link>             (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-authority-key-gn-serial">gnutls_x509_crl_get_authority_key_gn_serial</link>
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *alt</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *alt_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *alt_type</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *serial_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-authority-key-id">gnutls_x509_crl_get_authority_key_id</link>
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *id_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
#define             <link linkend="gnutls-x509-crl-get-certificate">gnutls_x509_crl_get_certificate</link>
#define             <link linkend="gnutls-x509-crl-get-certificate-count">gnutls_x509_crl_get_certificate_count</link>
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-crt-count">gnutls_x509_crl_get_crt_count</link>       (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-crt-serial">gnutls_x509_crl_get_crt_serial</link>      (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *serial_size</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *t</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-dn-oid">gnutls_x509_crl_get_dn_oid</link>          (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-extension-data">gnutls_x509_crl_get_extension_data</link>  (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-extension-info">gnutls_x509_crl_get_extension_info</link>  (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-extension-oid">gnutls_x509_crl_get_extension_oid</link>   (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-issuer-dn">gnutls_x509_crl_get_issuer_dn</link>       (<parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-issuer-dn-by-oid">gnutls_x509_crl_get_issuer_dn_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="time-t"><returnvalue>time_t</returnvalue></link>              <link linkend="gnutls-x509-crl-get-next-update">gnutls_x509_crl_get_next_update</link>     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-number">gnutls_x509_crl_get_number</link>          (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-raw-issuer-dn">gnutls_x509_crl_get_raw_issuer_dn</link>   (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *dn</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-signature">gnutls_x509_crl_get_signature</link>       (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *sig</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_sig</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-signature-algorithm">gnutls_x509_crl_get_signature_algorithm</link>
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="time-t"><returnvalue>time_t</returnvalue></link>              <link linkend="gnutls-x509-crl-get-this-update">gnutls_x509_crl_get_this_update</link>     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-get-version">gnutls_x509_crl_get_version</link>         (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-import">gnutls_x509_crl_import</link>              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-init">gnutls_x509_crl_init</link>                (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crl</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-list-import">gnutls_x509_crl_list_import</link>         (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crls</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *crl_max</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-list-import2">gnutls_x509_crl_list_import2</link>        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> **crls</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *size</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-print">gnutls_x509_crl_print</link>               (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-certificate-print-formats-t"><type>gnutls_certificate_print_formats_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
enum                <link linkend="gnutls-x509-crl-reason-flags-t">gnutls_x509_crl_reason_flags_t</link>;
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-authority-key-id">gnutls_x509_crl_set_authority_key_id</link>
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> id_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-crt">gnutls_x509_crl_set_crt</link>             (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> revocation_time</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-crt-serial">gnutls_x509_crl_set_crt_serial</link>      (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> serial_size</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> revocation_time</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-next-update">gnutls_x509_crl_set_next_update</link>     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> exp_time</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-number">gnutls_x509_crl_set_number</link>          (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *nr</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> nr_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-this-update">gnutls_x509_crl_set_this_update</link>     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> act_time</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-set-version">gnutls_x509_crl_set_version</link>         (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> version</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-sign2">gnutls_x509_crl_sign2</link>               (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> issuer_key</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> dig</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crl-verify">gnutls_x509_crl_verify</link>              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *CA_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CA_list_length</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-crq-deinit">gnutls_x509_crq_deinit</link>              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-export">gnutls_x509_crq_export</link>              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-export2">gnutls_x509_crq_export2</link>             (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-attribute-by-oid">gnutls_x509_crq_get_attribute_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-attribute-data">gnutls_x509_crq_get_attribute_data</link>  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-attribute-info">gnutls_x509_crq_get_attribute_info</link>  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-basic-constraints">gnutls_x509_crq_get_basic_constraints</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> *pathlen</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-challenge-password">gnutls_x509_crq_get_challenge_password</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *pass</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_pass</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-dn">gnutls_x509_crq_get_dn</link>              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-dn-by-oid">gnutls_x509_crq_get_dn_by_oid</link>       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-dn-oid">gnutls_x509_crq_get_dn_oid</link>          (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-extension-by-oid">gnutls_x509_crq_get_extension_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-extension-data">gnutls_x509_crq_get_extension_data</link>  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-extension-info">gnutls_x509_crq_get_extension_info</link>  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-key-id">gnutls_x509_crq_get_key_id</link>          (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-key-purpose-oid">gnutls_x509_crq_get_key_purpose_oid</link> (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-key-rsa-raw">gnutls_x509_crq_get_key_rsa_raw</link>     (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-key-usage">gnutls_x509_crq_get_key_usage</link>       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *key_usage</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-pk-algorithm">gnutls_x509_crq_get_pk_algorithm</link>    (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *bits</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-private-key-usage-period">gnutls_x509_crq_get_private_key_usage_period</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *expiration</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-subject-alt-name">gnutls_x509_crq_get_subject_alt_name</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ret_type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-subject-alt-othername-oid">gnutls_x509_crq_get_subject_alt_othername_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-get-version">gnutls_x509_crq_get_version</link>         (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-import">gnutls_x509_crq_import</link>              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-init">gnutls_x509_crq_init</link>                (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> *crq</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-print">gnutls_x509_crq_print</link>               (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-certificate-print-formats-t"><type>gnutls_certificate_print_formats_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-attribute-by-oid">gnutls_x509_crq_set_attribute_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-basic-constraints">gnutls_x509_crq_set_basic_constraints</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> pathLenConstraint</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-challenge-password">gnutls_x509_crq_set_challenge_password</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *pass</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-dn-by-oid">gnutls_x509_crq_set_dn_by_oid</link>       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-key">gnutls_x509_crq_set_key</link>             (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-key-purpose-oid">gnutls_x509_crq_set_key_purpose_oid</link> (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-key-rsa-raw">gnutls_x509_crq_set_key_rsa_raw</link>     (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-key-usage">gnutls_x509_crq_set_key_usage</link>       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> usage</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-private-key-usage-period">gnutls_x509_crq_set_private_key_usage_period</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> expiration</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-subject-alt-name">gnutls_x509_crq_set_subject_alt_name</link>
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> nt</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> data_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-set-version">gnutls_x509_crq_set_version</link>         (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> version</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-sign2">gnutls_x509_crq_sign2</link>               (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> dig</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crq-verify">gnutls_x509_crq_verify</link>              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-check-hostname">gnutls_x509_crt_check_hostname</link>      (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *hostname</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-check-issuer">gnutls_x509_crt_check_issuer</link>        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-check-revocation">gnutls_x509_crt_check_revocation</link>    (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crl_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> crl_list_length</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-cpy-crl-dist-points">gnutls_x509_crt_cpy_crl_dist_points</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> dst</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> src</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-crt-deinit">gnutls_x509_crt_deinit</link>              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-export">gnutls_x509_crt_export</link>              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-export2">gnutls_x509_crt_export2</link>             (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="time-t"><returnvalue>time_t</returnvalue></link>              <link linkend="gnutls-x509-crt-get-activation-time">gnutls_x509_crt_get_activation_time</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-authority-info-access">gnutls_x509_crt_get_authority_info_access</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> what</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-authority-key-gn-serial">gnutls_x509_crt_get_authority_key_gn_serial</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *alt</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *alt_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *alt_type</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *serial_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-authority-key-id">gnutls_x509_crt_get_authority_key_id</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *id_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-basic-constraints">gnutls_x509_crt_get_basic_constraints</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> *pathlen</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-ca-status">gnutls_x509_crt_get_ca_status</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-crl-dist-points">gnutls_x509_crt_get_crl_dist_points</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *reason_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-dn">gnutls_x509_crt_get_dn</link>              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-dn-by-oid">gnutls_x509_crt_get_dn_by_oid</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-dn-oid">gnutls_x509_crt_get_dn_oid</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);
<link linkend="time-t"><returnvalue>time_t</returnvalue></link>              <link linkend="gnutls-x509-crt-get-expiration-time">gnutls_x509_crt_get_expiration_time</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-extension-by-oid">gnutls_x509_crt_get_extension_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-extension-data">gnutls_x509_crt_get_extension_data</link>  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-extension-info">gnutls_x509_crt_get_extension_info</link>  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-extension-oid">gnutls_x509_crt_get_extension_oid</link>   (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-fingerprint">gnutls_x509_crt_get_fingerprint</link>     (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> algo</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer">gnutls_x509_crt_get_issuer</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> *dn</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-alt-name">gnutls_x509_crt_get_issuer_alt_name</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ian</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ian_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-alt-name2">gnutls_x509_crt_get_issuer_alt_name2</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ian</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ian_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ian_type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-alt-othername-oid">gnutls_x509_crt_get_issuer_alt_othername_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-dn">gnutls_x509_crt_get_issuer_dn</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-dn-by-oid">gnutls_x509_crt_get_issuer_dn_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-dn-oid">gnutls_x509_crt_get_issuer_dn_oid</link>   (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-issuer-unique-id">gnutls_x509_crt_get_issuer_unique_id</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-key-id">gnutls_x509_crt_get_key_id</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-key-purpose-oid">gnutls_x509_crt_get_key_purpose_oid</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-key-usage">gnutls_x509_crt_get_key_usage</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *key_usage</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-pk-algorithm">gnutls_x509_crt_get_pk_algorithm</link>    (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *bits</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-pk-dsa-raw">gnutls_x509_crt_get_pk_dsa_raw</link>      (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *g</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-pk-rsa-raw">gnutls_x509_crt_get_pk_rsa_raw</link>      (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-policy">gnutls_x509_crt_get_policy</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><type>struct gnutls_x509_policy_st</type> *policy</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-private-key-usage-period">gnutls_x509_crt_get_private_key_usage_period</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *expiration</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-proxy">gnutls_x509_crt_get_proxy</link>           (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> *pathlen</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> **policyLanguage</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> **policy</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_policy</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-raw-dn">gnutls_x509_crt_get_raw_dn</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *start</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-raw-issuer-dn">gnutls_x509_crt_get_raw_issuer_dn</link>   (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *start</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-serial">gnutls_x509_crt_get_serial</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *result</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *result_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-signature">gnutls_x509_crt_get_signature</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *sig</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_sig</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-signature-algorithm">gnutls_x509_crt_get_signature_algorithm</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-subject">gnutls_x509_crt_get_subject</link>         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> *dn</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-subject-alt-name">gnutls_x509_crt_get_subject_alt_name</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *san</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *san_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-subject-alt-name2">gnutls_x509_crt_get_subject_alt_name2</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *san</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *san_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *san_type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-subject-alt-othername-oid">gnutls_x509_crt_get_subject_alt_othername_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-subject-key-id">gnutls_x509_crt_get_subject_key_id</link>  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-subject-unique-id">gnutls_x509_crt_get_subject_unique_id</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-get-version">gnutls_x509_crt_get_version</link>         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-import">gnutls_x509_crt_import</link>              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-init">gnutls_x509_crt_init</link>                (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *cert</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-list-import">gnutls_x509_crt_list_import</link>         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *certs</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *cert_max</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-list-import2">gnutls_x509_crt_list_import2</link>        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> **certs</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *size</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-list-verify">gnutls_x509_crt_list_verify</link>         (<parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *cert_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> cert_list_length</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *CA_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CA_list_length</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *CRL_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CRL_list_length</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-print">gnutls_x509_crt_print</link>               (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-certificate-print-formats-t"><type>gnutls_certificate_print_formats_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-activation-time">gnutls_x509_crt_set_activation_time</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> act_time</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-authority-info-access">gnutls_x509_crt_set_authority_info_access</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> what</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-authority-key-id">gnutls_x509_crt_set_authority_key_id</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> id_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-basic-constraints">gnutls_x509_crt_set_basic_constraints</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> pathLenConstraint</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-ca-status">gnutls_x509_crt_set_ca_status</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> ca</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-crl-dist-points">gnutls_x509_crt_set_crl_dist_points</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data_string</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> reason_flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-crl-dist-points2">gnutls_x509_crt_set_crl_dist_points2</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> data_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> reason_flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-crq">gnutls_x509_crt_set_crq</link>             (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-crq-extensions">gnutls_x509_crt_set_crq_extensions</link>  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-dn-by-oid">gnutls_x509_crt_set_dn_by_oid</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_name</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-expiration-time">gnutls_x509_crt_set_expiration_time</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> exp_time</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-extension-by-oid">gnutls_x509_crt_set_extension_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> sizeof_buf</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-issuer-dn-by-oid">gnutls_x509_crt_set_issuer_dn_by_oid</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_name</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-key">gnutls_x509_crt_set_key</link>             (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-key-purpose-oid">gnutls_x509_crt_set_key_purpose_oid</link> (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-key-usage">gnutls_x509_crt_set_key_usage</link>       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> usage</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-crt-set-pin-function">gnutls_x509_crt_set_pin_function</link>    (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-pin-callback-t"><type>gnutls_pin_callback_t</type></link> fn</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *userdata</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-policy">gnutls_x509_crt_set_policy</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><type>struct gnutls_x509_policy_st</type> *policy</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-private-key-usage-period">gnutls_x509_crt_set_private_key_usage_period</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> expiration</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-proxy">gnutls_x509_crt_set_proxy</link>           (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> pathLenConstraint</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *policyLanguage</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *policy</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> sizeof_policy</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-proxy-dn">gnutls_x509_crt_set_proxy_dn</link>        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> eecrt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_name</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-serial">gnutls_x509_crt_set_serial</link>          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> serial_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-subject-alt-name">gnutls_x509_crt_set_subject_alt_name</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> data_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-subject-alternative-name">gnutls_x509_crt_set_subject_alternative_name</link>
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *data_string</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-subject-key-id">gnutls_x509_crt_set_subject_key_id</link>  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> id_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-set-version">gnutls_x509_crt_set_version</link>         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> version</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-sign">gnutls_x509_crt_sign</link>                (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> issuer_key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-sign2">gnutls_x509_crt_sign2</link>               (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> issuer_key</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> dig</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-crt-verify">gnutls_x509_crt_verify</link>              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *CA_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CA_list_length</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-dn-deinit">gnutls_x509_dn_deinit</link>               (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-dn-export">gnutls_x509_dn_export</link>               (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-dn-export2">gnutls_x509_dn_export2</link>              (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-dn-get-rdn-ava">gnutls_x509_dn_get_rdn_ava</link>          (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> irdn</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> iava</parameter>,
                                                         <parameter><link linkend="gnutls-x509-ava-st"><type>gnutls_x509_ava_st</type></link> *ava</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-dn-import">gnutls_x509_dn_import</link>               (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-dn-init">gnutls_x509_dn_init</link>                 (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> *dn</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-dn-oid-known">gnutls_x509_dn_oid_known</link>            (<parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>);
const <link linkend="char"><returnvalue>char</returnvalue></link> *        <link linkend="gnutls-x509-dn-oid-name">gnutls_x509_dn_oid_name</link>             (<parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
typedef             <link linkend="gnutls-x509-dn-t">gnutls_x509_dn_t</link>;
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-policy-release">gnutls_x509_policy_release</link>          (<parameter><type>struct gnutls_x509_policy_st</type> *policy</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-cpy">gnutls_x509_privkey_cpy</link>             (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> dst</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> src</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-privkey-deinit">gnutls_x509_privkey_deinit</link>          (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export">gnutls_x509_privkey_export</link>          (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export2">gnutls_x509_privkey_export2</link>         (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export2-pkcs8">gnutls_x509_privkey_export2_pkcs8</link>   (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export-dsa-raw">gnutls_x509_privkey_export_dsa_raw</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *g</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export-ecc-raw">gnutls_x509_privkey_export_ecc_raw</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-ecc-curve-t"><type>gnutls_ecc_curve_t</type></link> *curve</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *k</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export-pkcs8">gnutls_x509_privkey_export_pkcs8</link>    (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export-rsa-raw">gnutls_x509_privkey_export_rsa_raw</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-export-rsa-raw2">gnutls_x509_privkey_export_rsa_raw2</link> (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e1</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e2</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-fix">gnutls_x509_privkey_fix</link>             (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-generate">gnutls_x509_privkey_generate</link>        (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link> algo</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> bits</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-get-key-id">gnutls_x509_privkey_get_key_id</link>      (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-get-pk-algorithm">gnutls_x509_privkey_get_pk_algorithm</link>
                                                        (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-get-pk-algorithm2">gnutls_x509_privkey_get_pk_algorithm2</link>
                                                        (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *bits</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import">gnutls_x509_privkey_import</link>          (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import2">gnutls_x509_privkey_import2</link>         (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import-dsa-raw">gnutls_x509_privkey_import_dsa_raw</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *g</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import-ecc-raw">gnutls_x509_privkey_import_ecc_raw</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-ecc-curve-t"><type>gnutls_ecc_curve_t</type></link> curve</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *k</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import-openssl">gnutls_x509_privkey_import_openssl</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import-pkcs8">gnutls_x509_privkey_import_pkcs8</link>    (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import-rsa-raw">gnutls_x509_privkey_import_rsa_raw</link>  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-import-rsa-raw2">gnutls_x509_privkey_import_rsa_raw2</link> (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e1</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e2</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-init">gnutls_x509_privkey_init</link>            (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> *key</parameter>);
<link linkend="gnutls-sec-param-t"><returnvalue>gnutls_sec_param_t</returnvalue></link>  <link linkend="gnutls-x509-privkey-sec-param">gnutls_x509_privkey_sec_param</link>       (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-privkey-verify-params">gnutls_x509_privkey_verify_params</link>   (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);
enum                <link linkend="gnutls-x509-qualifier-t">gnutls_x509_qualifier_t</link>;
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-rdn-get">gnutls_x509_rdn_get</link>                 (<parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *idn</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-rdn-get-by-oid">gnutls_x509_rdn_get_by_oid</link>          (<parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *idn</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-rdn-get-oid">gnutls_x509_rdn_get_oid</link>             (<parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *idn</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-add-cas">gnutls_x509_trust_list_add_cas</link>      (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *clist</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> clist_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-add-crls">gnutls_x509_trust_list_add_crls</link>     (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crl_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> crl_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> verification_flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-add-named-crt">gnutls_x509_trust_list_add_named_crt</link>
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> name_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-add-system-trust">gnutls_x509_trust_list_add_system_trust</link>
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_vflags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-add-trust-file">gnutls_x509_trust_list_add_trust_file</link>
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *ca_file</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *crl_file</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_vflags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-add-trust-mem">gnutls_x509_trust_list_add_trust_mem</link>
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *cas</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *crls</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_vflags</parameter>);
<link linkend="void"><returnvalue>void</returnvalue></link>                <link linkend="gnutls-x509-trust-list-deinit">gnutls_x509_trust_list_deinit</link>       (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> all</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-get-issuer">gnutls_x509_trust_list_get_issuer</link>   (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *issuer</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-init">gnutls_x509_trust_list_init</link>         (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> *list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> size</parameter>);
typedef             <link linkend="gnutls-x509-trust-list-t">gnutls_x509_trust_list_t</link>;
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-verify-crt">gnutls_x509_trust_list_verify_crt</link>   (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *cert_list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> cert_list_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>,
                                                         <parameter><link linkend="gnutls-verify-output-function"><type>gnutls_verify_output_function</type></link> func</parameter>);
<link linkend="int"><returnvalue>int</returnvalue></link>                 <link linkend="gnutls-x509-trust-list-verify-named-crt">gnutls_x509_trust_list_verify_named_crt</link>
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> name_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>,
                                                         <parameter><link linkend="gnutls-verify-output-function"><type>gnutls_verify_output_function</type></link> func</parameter>);
</synopsis>
</refsynopsisdiv>

<refsect1 id="gnutls-x509.description" role="desc">
<title role="desc.title">Description</title>
<para>
</para>
</refsect1>
<refsect1 id="gnutls-x509.details" role="details">
<title role="details.title">Details</title>
<refsect2 id="GNUTLS-CRL-REASON-SUPERSEEDED:CAPS" role="macro">
<title>GNUTLS_CRL_REASON_SUPERSEEDED</title>
<indexterm zone="GNUTLS-CRL-REASON-SUPERSEEDED:CAPS"><primary>GNUTLS_CRL_REASON_SUPERSEEDED</primary></indexterm>
<programlisting>#define GNUTLS_CRL_REASON_SUPERSEEDED GNUTLS_CRL_REASON_SUPERSEDED,
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-FSAN-APPEND:CAPS" role="macro">
<title>GNUTLS_FSAN_APPEND</title>
<indexterm zone="GNUTLS-FSAN-APPEND:CAPS"><primary>GNUTLS_FSAN_APPEND</primary></indexterm>
<programlisting>#define GNUTLS_FSAN_APPEND 1
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-FSAN-SET:CAPS" role="macro">
<title>GNUTLS_FSAN_SET</title>
<indexterm zone="GNUTLS-FSAN-SET:CAPS"><primary>GNUTLS_FSAN_SET</primary></indexterm>
<programlisting>#define GNUTLS_FSAN_SET 0
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-ANY:CAPS" role="macro">
<title>GNUTLS_KP_ANY</title>
<indexterm zone="GNUTLS-KP-ANY:CAPS"><primary>GNUTLS_KP_ANY</primary></indexterm>
<programlisting>#define GNUTLS_KP_ANY				"2.5.29.37.0"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-CODE-SIGNING:CAPS" role="macro">
<title>GNUTLS_KP_CODE_SIGNING</title>
<indexterm zone="GNUTLS-KP-CODE-SIGNING:CAPS"><primary>GNUTLS_KP_CODE_SIGNING</primary></indexterm>
<programlisting>#define GNUTLS_KP_CODE_SIGNING			"1.3.6.1.5.5.7.3.3"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-EMAIL-PROTECTION:CAPS" role="macro">
<title>GNUTLS_KP_EMAIL_PROTECTION</title>
<indexterm zone="GNUTLS-KP-EMAIL-PROTECTION:CAPS"><primary>GNUTLS_KP_EMAIL_PROTECTION</primary></indexterm>
<programlisting>#define GNUTLS_KP_EMAIL_PROTECTION		"1.3.6.1.5.5.7.3.4"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-IPSEC-IKE:CAPS" role="macro">
<title>GNUTLS_KP_IPSEC_IKE</title>
<indexterm zone="GNUTLS-KP-IPSEC-IKE:CAPS"><primary>GNUTLS_KP_IPSEC_IKE</primary></indexterm>
<programlisting>#define GNUTLS_KP_IPSEC_IKE			"1.3.6.1.5.5.7.3.17"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-MS-SMART-CARD-LOGON:CAPS" role="macro">
<title>GNUTLS_KP_MS_SMART_CARD_LOGON</title>
<indexterm zone="GNUTLS-KP-MS-SMART-CARD-LOGON:CAPS"><primary>GNUTLS_KP_MS_SMART_CARD_LOGON</primary></indexterm>
<programlisting>#define GNUTLS_KP_MS_SMART_CARD_LOGON		"1.3.6.1.4.1.311.20.2.2"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-OCSP-SIGNING:CAPS" role="macro">
<title>GNUTLS_KP_OCSP_SIGNING</title>
<indexterm zone="GNUTLS-KP-OCSP-SIGNING:CAPS"><primary>GNUTLS_KP_OCSP_SIGNING</primary></indexterm>
<programlisting>#define GNUTLS_KP_OCSP_SIGNING			"1.3.6.1.5.5.7.3.9"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-TIME-STAMPING:CAPS" role="macro">
<title>GNUTLS_KP_TIME_STAMPING</title>
<indexterm zone="GNUTLS-KP-TIME-STAMPING:CAPS"><primary>GNUTLS_KP_TIME_STAMPING</primary></indexterm>
<programlisting>#define GNUTLS_KP_TIME_STAMPING			"1.3.6.1.5.5.7.3.8"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-TLS-WWW-CLIENT:CAPS" role="macro">
<title>GNUTLS_KP_TLS_WWW_CLIENT</title>
<indexterm zone="GNUTLS-KP-TLS-WWW-CLIENT:CAPS"><primary>GNUTLS_KP_TLS_WWW_CLIENT</primary></indexterm>
<programlisting>#define GNUTLS_KP_TLS_WWW_CLIENT                "1.3.6.1.5.5.7.3.2"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-KP-TLS-WWW-SERVER:CAPS" role="macro">
<title>GNUTLS_KP_TLS_WWW_SERVER</title>
<indexterm zone="GNUTLS-KP-TLS-WWW-SERVER:CAPS"><primary>GNUTLS_KP_TLS_WWW_SERVER</primary></indexterm>
<programlisting>#define GNUTLS_KP_TLS_WWW_SERVER		"1.3.6.1.5.5.7.3.1"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-MAX-QUALIFIERS:CAPS" role="macro">
<title>GNUTLS_MAX_QUALIFIERS</title>
<indexterm zone="GNUTLS-MAX-QUALIFIERS:CAPS"><primary>GNUTLS_MAX_QUALIFIERS</primary></indexterm>
<programlisting>#define GNUTLS_MAX_QUALIFIERS 8
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-AD-CAISSUERS:CAPS" role="macro">
<title>GNUTLS_OID_AD_CAISSUERS</title>
<indexterm zone="GNUTLS-OID-AD-CAISSUERS:CAPS"><primary>GNUTLS_OID_AD_CAISSUERS</primary></indexterm>
<programlisting>#define GNUTLS_OID_AD_CAISSUERS			"1.3.6.1.5.5.7.48.2"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-AD-OCSP:CAPS" role="macro">
<title>GNUTLS_OID_AD_OCSP</title>
<indexterm zone="GNUTLS-OID-AD-OCSP:CAPS"><primary>GNUTLS_OID_AD_OCSP</primary></indexterm>
<programlisting>#define GNUTLS_OID_AD_OCSP			"1.3.6.1.5.5.7.48.1"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-AIA:CAPS" role="macro">
<title>GNUTLS_OID_AIA</title>
<indexterm zone="GNUTLS-OID-AIA:CAPS"><primary>GNUTLS_OID_AIA</primary></indexterm>
<programlisting>#define GNUTLS_OID_AIA				"1.3.6.1.5.5.7.1.1"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-LDAP-DC:CAPS" role="macro">
<title>GNUTLS_OID_LDAP_DC</title>
<indexterm zone="GNUTLS-OID-LDAP-DC:CAPS"><primary>GNUTLS_OID_LDAP_DC</primary></indexterm>
<programlisting>#define GNUTLS_OID_LDAP_DC			"0.9.2342.19200300.100.1.25"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-LDAP-UID:CAPS" role="macro">
<title>GNUTLS_OID_LDAP_UID</title>
<indexterm zone="GNUTLS-OID-LDAP-UID:CAPS"><primary>GNUTLS_OID_LDAP_UID</primary></indexterm>
<programlisting>#define GNUTLS_OID_LDAP_UID			"0.9.2342.19200300.100.1.1"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-PKCS9-EMAIL:CAPS" role="macro">
<title>GNUTLS_OID_PKCS9_EMAIL</title>
<indexterm zone="GNUTLS-OID-PKCS9-EMAIL:CAPS"><primary>GNUTLS_OID_PKCS9_EMAIL</primary></indexterm>
<programlisting>#define GNUTLS_OID_PKCS9_EMAIL			"1.2.840.113549.1.9.1"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-PKIX-COUNTRY-OF-CITIZENSHIP:CAPS" role="macro">
<title>GNUTLS_OID_PKIX_COUNTRY_OF_CITIZENSHIP</title>
<indexterm zone="GNUTLS-OID-PKIX-COUNTRY-OF-CITIZENSHIP:CAPS"><primary>GNUTLS_OID_PKIX_COUNTRY_OF_CITIZENSHIP</primary></indexterm>
<programlisting>#define GNUTLS_OID_PKIX_COUNTRY_OF_CITIZENSHIP&#160;"1.3.6.1.5.5.7.9.4"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-PKIX-COUNTRY-OF-RESIDENCE:CAPS" role="macro">
<title>GNUTLS_OID_PKIX_COUNTRY_OF_RESIDENCE</title>
<indexterm zone="GNUTLS-OID-PKIX-COUNTRY-OF-RESIDENCE:CAPS"><primary>GNUTLS_OID_PKIX_COUNTRY_OF_RESIDENCE</primary></indexterm>
<programlisting>#define GNUTLS_OID_PKIX_COUNTRY_OF_RESIDENCE&#160;"1.3.6.1.5.5.7.9.5"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-PKIX-DATE-OF-BIRTH:CAPS" role="macro">
<title>GNUTLS_OID_PKIX_DATE_OF_BIRTH</title>
<indexterm zone="GNUTLS-OID-PKIX-DATE-OF-BIRTH:CAPS"><primary>GNUTLS_OID_PKIX_DATE_OF_BIRTH</primary></indexterm>
<programlisting>#define GNUTLS_OID_PKIX_DATE_OF_BIRTH		"1.3.6.1.5.5.7.9.1"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-PKIX-GENDER:CAPS" role="macro">
<title>GNUTLS_OID_PKIX_GENDER</title>
<indexterm zone="GNUTLS-OID-PKIX-GENDER:CAPS"><primary>GNUTLS_OID_PKIX_GENDER</primary></indexterm>
<programlisting>#define GNUTLS_OID_PKIX_GENDER			"1.3.6.1.5.5.7.9.3"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-PKIX-PLACE-OF-BIRTH:CAPS" role="macro">
<title>GNUTLS_OID_PKIX_PLACE_OF_BIRTH</title>
<indexterm zone="GNUTLS-OID-PKIX-PLACE-OF-BIRTH:CAPS"><primary>GNUTLS_OID_PKIX_PLACE_OF_BIRTH</primary></indexterm>
<programlisting>#define GNUTLS_OID_PKIX_PLACE_OF_BIRTH		"1.3.6.1.5.5.7.9.2"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-COMMON-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_COMMON_NAME</title>
<indexterm zone="GNUTLS-OID-X520-COMMON-NAME:CAPS"><primary>GNUTLS_OID_X520_COMMON_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_COMMON_NAME		"2.5.4.3"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-COUNTRY-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_COUNTRY_NAME</title>
<indexterm zone="GNUTLS-OID-X520-COUNTRY-NAME:CAPS"><primary>GNUTLS_OID_X520_COUNTRY_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_COUNTRY_NAME		"2.5.4.6"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-DN-QUALIFIER:CAPS" role="macro">
<title>GNUTLS_OID_X520_DN_QUALIFIER</title>
<indexterm zone="GNUTLS-OID-X520-DN-QUALIFIER:CAPS"><primary>GNUTLS_OID_X520_DN_QUALIFIER</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_DN_QUALIFIER		"2.5.4.46"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-GENERATION-QUALIFIER:CAPS" role="macro">
<title>GNUTLS_OID_X520_GENERATION_QUALIFIER</title>
<indexterm zone="GNUTLS-OID-X520-GENERATION-QUALIFIER:CAPS"><primary>GNUTLS_OID_X520_GENERATION_QUALIFIER</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_GENERATION_QUALIFIER&#160;"2.5.4.44"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-GIVEN-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_GIVEN_NAME</title>
<indexterm zone="GNUTLS-OID-X520-GIVEN-NAME:CAPS"><primary>GNUTLS_OID_X520_GIVEN_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_GIVEN_NAME		"2.5.4.42"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-INITIALS:CAPS" role="macro">
<title>GNUTLS_OID_X520_INITIALS</title>
<indexterm zone="GNUTLS-OID-X520-INITIALS:CAPS"><primary>GNUTLS_OID_X520_INITIALS</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_INITIALS		"2.5.4.43"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-LOCALITY-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_LOCALITY_NAME</title>
<indexterm zone="GNUTLS-OID-X520-LOCALITY-NAME:CAPS"><primary>GNUTLS_OID_X520_LOCALITY_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_LOCALITY_NAME		"2.5.4.7"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_NAME</title>
<indexterm zone="GNUTLS-OID-X520-NAME:CAPS"><primary>GNUTLS_OID_X520_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_NAME                    "2.5.4.41"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-ORGANIZATIONAL-UNIT-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_ORGANIZATIONAL_UNIT_NAME</title>
<indexterm zone="GNUTLS-OID-X520-ORGANIZATIONAL-UNIT-NAME:CAPS"><primary>GNUTLS_OID_X520_ORGANIZATIONAL_UNIT_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_ORGANIZATIONAL_UNIT_NAME "2.5.4.11"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-ORGANIZATION-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_ORGANIZATION_NAME</title>
<indexterm zone="GNUTLS-OID-X520-ORGANIZATION-NAME:CAPS"><primary>GNUTLS_OID_X520_ORGANIZATION_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_ORGANIZATION_NAME&#160;"2.5.4.10"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-POSTALCODE:CAPS" role="macro">
<title>GNUTLS_OID_X520_POSTALCODE</title>
<indexterm zone="GNUTLS-OID-X520-POSTALCODE:CAPS"><primary>GNUTLS_OID_X520_POSTALCODE</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_POSTALCODE              "2.5.4.17"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-PSEUDONYM:CAPS" role="macro">
<title>GNUTLS_OID_X520_PSEUDONYM</title>
<indexterm zone="GNUTLS-OID-X520-PSEUDONYM:CAPS"><primary>GNUTLS_OID_X520_PSEUDONYM</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_PSEUDONYM		"2.5.4.65"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-STATE-OR-PROVINCE-NAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_STATE_OR_PROVINCE_NAME</title>
<indexterm zone="GNUTLS-OID-X520-STATE-OR-PROVINCE-NAME:CAPS"><primary>GNUTLS_OID_X520_STATE_OR_PROVINCE_NAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_STATE_OR_PROVINCE_NAME&#160;"2.5.4.8"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-SURNAME:CAPS" role="macro">
<title>GNUTLS_OID_X520_SURNAME</title>
<indexterm zone="GNUTLS-OID-X520-SURNAME:CAPS"><primary>GNUTLS_OID_X520_SURNAME</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_SURNAME			"2.5.4.4"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-OID-X520-TITLE:CAPS" role="macro">
<title>GNUTLS_OID_X520_TITLE</title>
<indexterm zone="GNUTLS-OID-X520-TITLE:CAPS"><primary>GNUTLS_OID_X520_TITLE</primary></indexterm>
<programlisting>#define GNUTLS_OID_X520_TITLE			"2.5.4.12"
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-PKCS8-PLAIN:CAPS" role="macro">
<title>GNUTLS_PKCS8_PLAIN</title>
<indexterm zone="GNUTLS-PKCS8-PLAIN:CAPS"><primary>GNUTLS_PKCS8_PLAIN</primary></indexterm>
<programlisting>#define GNUTLS_PKCS8_PLAIN GNUTLS_PKCS_PLAIN
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-PKCS8-USE-PKCS12-3DES:CAPS" role="macro">
<title>GNUTLS_PKCS8_USE_PKCS12_3DES</title>
<indexterm zone="GNUTLS-PKCS8-USE-PKCS12-3DES:CAPS"><primary>GNUTLS_PKCS8_USE_PKCS12_3DES</primary></indexterm>
<programlisting>#define GNUTLS_PKCS8_USE_PKCS12_3DES GNUTLS_PKCS_USE_PKCS12_3DES
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-PKCS8-USE-PKCS12-ARCFOUR:CAPS" role="macro">
<title>GNUTLS_PKCS8_USE_PKCS12_ARCFOUR</title>
<indexterm zone="GNUTLS-PKCS8-USE-PKCS12-ARCFOUR:CAPS"><primary>GNUTLS_PKCS8_USE_PKCS12_ARCFOUR</primary></indexterm>
<programlisting>#define GNUTLS_PKCS8_USE_PKCS12_ARCFOUR GNUTLS_PKCS_USE_PKCS12_ARCFOUR
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-PKCS8-USE-PKCS12-RC2-40:CAPS" role="macro">
<title>GNUTLS_PKCS8_USE_PKCS12_RC2_40</title>
<indexterm zone="GNUTLS-PKCS8-USE-PKCS12-RC2-40:CAPS"><primary>GNUTLS_PKCS8_USE_PKCS12_RC2_40</primary></indexterm>
<programlisting>#define GNUTLS_PKCS8_USE_PKCS12_RC2_40 GNUTLS_PKCS_USE_PKCS12_RC2_40
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-TL-VERIFY-CRL:CAPS" role="macro">
<title>GNUTLS_TL_VERIFY_CRL</title>
<indexterm zone="GNUTLS-TL-VERIFY-CRL:CAPS"><primary>GNUTLS_TL_VERIFY_CRL</primary></indexterm>
<programlisting>#define GNUTLS_TL_VERIFY_CRL 1
</programlisting>
<para>
</para></refsect2>
<refsect2 id="GNUTLS-X509-DN-OID-RETURN-OID:CAPS" role="macro">
<title>GNUTLS_X509_DN_OID_RETURN_OID</title>
<indexterm zone="GNUTLS-X509-DN-OID-RETURN-OID:CAPS"><primary>GNUTLS_X509_DN_OID_RETURN_OID</primary></indexterm>
<programlisting>#define GNUTLS_X509_DN_OID_RETURN_OID 1
</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-certificate-import-flags" role="enum">
<title>enum gnutls_certificate_import_flags</title>
<indexterm zone="gnutls-certificate-import-flags"><primary>gnutls_certificate_import_flags</primary></indexterm>
<programlisting>typedef enum {
    GNUTLS_X509_CRT_LIST_IMPORT_FAIL_IF_EXCEED = 1,
    GNUTLS_X509_CRT_LIST_FAIL_IF_UNSORTED = 2
} gnutls_certificate_import_flags;
</programlisting>
<para>
Enumeration of different certificate import flags.
</para><variablelist role="enum">
<varlistentry id="GNUTLS-X509-CRT-LIST-IMPORT-FAIL-IF-EXCEED:CAPS" role="constant">
<term><literal>GNUTLS_X509_CRT_LIST_IMPORT_FAIL_IF_EXCEED</literal></term>
<listitem><simpara>Fail if the
  certificates in the buffer are more than the space allocated for
  certificates. The error code will be <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link>.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-X509-CRT-LIST-FAIL-IF-UNSORTED:CAPS" role="constant">
<term><literal>GNUTLS_X509_CRT_LIST_FAIL_IF_UNSORTED</literal></term>
<listitem><simpara>Fail if the certificates
  in the buffer are not ordered starting from subject to issuer.
  The error code will be <link linkend="GNUTLS-E-CERTIFICATE-LIST-UNSORTED:CAPS"><literal>GNUTLS_E_CERTIFICATE_LIST_UNSORTED</literal></link>.
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-certificate-verify-flags" role="enum">
<title>enum gnutls_certificate_verify_flags</title>
<indexterm zone="gnutls-certificate-verify-flags"><primary>gnutls_certificate_verify_flags</primary></indexterm>
<programlisting>typedef enum {
    GNUTLS_VERIFY_DISABLE_CA_SIGN = 1&lt;&lt;0,
    GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT = 1&lt;&lt;1,
    GNUTLS_VERIFY_DO_NOT_ALLOW_SAME = 1&lt;&lt;2,
    GNUTLS_VERIFY_ALLOW_ANY_X509_V1_CA_CRT = 1&lt;&lt;3,
    GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD2 = 1&lt;&lt;4,
    GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD5 = 1&lt;&lt;5,
    GNUTLS_VERIFY_DISABLE_TIME_CHECKS = 1&lt;&lt;6,
    GNUTLS_VERIFY_DISABLE_TRUSTED_TIME_CHECKS = 1&lt;&lt;7,
    GNUTLS_VERIFY_DO_NOT_ALLOW_X509_V1_CA_CRT = 1&lt;&lt;8,
    GNUTLS_VERIFY_DISABLE_CRL_CHECKS = 1&lt;&lt;9,
    GNUTLS_VERIFY_ALLOW_UNSORTED_CHAIN = 1&lt;&lt;10,
    GNUTLS_VERIFY_DO_NOT_ALLOW_UNSORTED_CHAIN = 1&lt;&lt;11,
} gnutls_certificate_verify_flags;
</programlisting>
<para>
Enumeration of different certificate verify flags.
</para><variablelist role="enum">
<varlistentry id="GNUTLS-VERIFY-DISABLE-CA-SIGN:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DISABLE_CA_SIGN</literal></term>
<listitem><simpara>If set a signer does not have to be
  a certificate authority. This flag should normaly be disabled,
  unless you know what this means.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-ALLOW-X509-V1-CA-CRT:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT</literal></term>
<listitem><simpara>Allow trusted CA certiﬁcates
  with version 1. This is safer than <link linkend="GNUTLS-VERIFY-ALLOW-ANY-X509-V1-CA-CRT:CAPS"><literal>GNUTLS_VERIFY_ALLOW_ANY_X509_V1_CA_CRT</literal></link>,
  and should be used instead. That way only signers in your trusted list
  will be allowed to have certiﬁcates of version 1. This is the default.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-DO-NOT-ALLOW-SAME:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DO_NOT_ALLOW_SAME</literal></term>
<listitem><simpara>If a certificate is not signed by
  anyone trusted but exists in the trusted CA list do not treat it
  as trusted.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-ALLOW-ANY-X509-V1-CA-CRT:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_ALLOW_ANY_X509_V1_CA_CRT</literal></term>
<listitem><simpara>Allow CA certificates that
  have version 1 (both root and intermediate). This might be
  dangerous since those haven't the basicConstraints
  extension. Must be used in combination with
  <link linkend="GNUTLS-VERIFY-ALLOW-X509-V1-CA-CRT:CAPS"><literal>GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT</literal></link>.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-ALLOW-SIGN-RSA-MD2:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD2</literal></term>
<listitem><simpara>Allow certificates to be signed
  using the broken MD2 algorithm.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-ALLOW-SIGN-RSA-MD5:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD5</literal></term>
<listitem><simpara>Allow certificates to be signed
  using the broken MD5 algorithm.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-DISABLE-TIME-CHECKS:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DISABLE_TIME_CHECKS</literal></term>
<listitem><simpara>Disable checking of activation
  and expiration validity periods of certificate chains. Don't set
  this unless you understand the security implications.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-DISABLE-TRUSTED-TIME-CHECKS:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DISABLE_TRUSTED_TIME_CHECKS</literal></term>
<listitem><simpara>If set a signer in the trusted
  list is never checked for expiration or activation.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-DO-NOT-ALLOW-X509-V1-CA-CRT:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DO_NOT_ALLOW_X509_V1_CA_CRT</literal></term>
<listitem><simpara>Do not allow trusted CA
  certificates that have version 1.  This option is to be used
  to deprecate all certificates of version 1.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-DISABLE-CRL-CHECKS:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DISABLE_CRL_CHECKS</literal></term>
<listitem><simpara>Disable checking for validity
  using certificate revocation lists or the available OCSP data.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-ALLOW-UNSORTED-CHAIN:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_ALLOW_UNSORTED_CHAIN</literal></term>
<listitem><simpara>A certificate chain is tolerated
  if unsorted (the case with many TLS servers out there). This is the
  default since GnuTLS 3.1.4.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-VERIFY-DO-NOT-ALLOW-UNSORTED-CHAIN:CAPS" role="constant">
<term><literal>GNUTLS_VERIFY_DO_NOT_ALLOW_UNSORTED_CHAIN</literal></term>
<listitem><simpara>Do not tolerate an unsorted
  certificate chain.
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-info-access-what-t" role="enum">
<title>enum gnutls_info_access_what_t</title>
<indexterm zone="gnutls-info-access-what-t"><primary>gnutls_info_access_what_t</primary></indexterm>
<programlisting>typedef enum {
      GNUTLS_IA_ACCESSMETHOD_OID = 1,
      GNUTLS_IA_ACCESSLOCATION_GENERALNAME_TYPE = 2,
      /* use 100-108 for the generalName types, populate as needed */
      GNUTLS_IA_URI = 106,
      /* quick-access variants that match both OID and name type. */
      GNUTLS_IA_OCSP_URI = 10006,
      GNUTLS_IA_CAISSUERS_URI = 10106
} gnutls_info_access_what_t;
</programlisting>
<para>
Enumeration of types for the <parameter>what</parameter> parameter of
<link linkend="gnutls-x509-crt-get-authority-info-access"><function>gnutls_x509_crt_get_authority_info_access()</function></link>.
</para><variablelist role="enum">
<varlistentry id="GNUTLS-IA-ACCESSMETHOD-OID:CAPS" role="constant">
<term><literal>GNUTLS_IA_ACCESSMETHOD_OID</literal></term>
<listitem><simpara>Get accessMethod OID.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-IA-ACCESSLOCATION-GENERALNAME-TYPE:CAPS" role="constant">
<term><literal>GNUTLS_IA_ACCESSLOCATION_GENERALNAME_TYPE</literal></term>
<listitem><simpara>Get accessLocation name type.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-IA-URI:CAPS" role="constant">
<term><literal>GNUTLS_IA_URI</literal></term>
<listitem><simpara>Get accessLocation URI value.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-IA-OCSP-URI:CAPS" role="constant">
<term><literal>GNUTLS_IA_OCSP_URI</literal></term>
<listitem><simpara>get accessLocation URI value for OCSP.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-IA-CAISSUERS-URI:CAPS" role="constant">
<term><literal>GNUTLS_IA_CAISSUERS_URI</literal></term>
<listitem><simpara>get accessLocation URI value for caIssuers.
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-deinit" role="function">
<title>gnutls_pkcs7_deinit ()</title>
<indexterm zone="gnutls-pkcs7-deinit"><primary>gnutls_pkcs7_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_pkcs7_deinit                 (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>);</programlisting>
<para>
This function will deinitialize a PKCS7 structure.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-delete-crl" role="function">
<title>gnutls_pkcs7_delete_crl ()</title>
<indexterm zone="gnutls-pkcs7-delete-crl"><primary>gnutls_pkcs7_delete_crl</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_delete_crl             (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>);</programlisting>
<para>
This function will delete a crl from a PKCS7 or RFC2630 crl set.
Index starts from 0. Returns 0 on success.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>the index of the crl to delete</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-delete-crt" role="function">
<title>gnutls_pkcs7_delete_crt ()</title>
<indexterm zone="gnutls-pkcs7-delete-crt"><primary>gnutls_pkcs7_delete_crt</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_delete_crt             (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>);</programlisting>
<para>
This function will delete a certificate from a PKCS7 or RFC2630
certificate set.  Index starts from 0. Returns 0 on success.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_pkcs7_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>the index of the certificate to delete</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-export" role="function">
<title>gnutls_pkcs7_export ()</title>
<indexterm zone="gnutls-pkcs7-export"><primary>gnutls_pkcs7_export</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_export                 (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the pkcs7 structure to DER or PEM format.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>output_data_size</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link>
will be returned.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN PKCS7".
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>Holds the pkcs7 structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a structure PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-export2" role="function">
<title>gnutls_pkcs7_export2 ()</title>
<indexterm zone="gnutls-pkcs7-export2"><primary>gnutls_pkcs7_export2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_export2                (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the pkcs7 structure to DER or PEM format.
</para>
<para>
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN PKCS7".
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>Holds the pkcs7 structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a structure PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-get-crl-count" role="function">
<title>gnutls_pkcs7_get_crl_count ()</title>
<indexterm zone="gnutls-pkcs7-get-crl-count"><primary>gnutls_pkcs7_get_crl_count</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_get_crl_count          (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>);</programlisting>
<para>
This function will return the number of certifcates in the PKCS7
or RFC2630 crl set.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_pkcs7_t structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-get-crl-raw" role="function">
<title>gnutls_pkcs7_get_crl_raw ()</title>
<indexterm zone="gnutls-pkcs7-get-crl-raw"><primary>gnutls_pkcs7_get_crl_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_get_crl_raw            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *crl</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *crl_size</parameter>);</programlisting>
<para>
This function will return a crl of the PKCS7 or RFC2630 crl set.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>contains the index of the crl to extract</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>the contents of the crl will be copied there (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_size</parameter>&#160;:</term>
<listitem><simpara>should hold the size of the crl</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.  If the provided buffer is not long enough,
then <parameter>crl_size</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> is
returned.  After the last crl has been read
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-get-crt-count" role="function">
<title>gnutls_pkcs7_get_crt_count ()</title>
<indexterm zone="gnutls-pkcs7-get-crt-count"><primary>gnutls_pkcs7_get_crt_count</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_get_crt_count          (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>);</programlisting>
<para>
This function will return the number of certifcates in the PKCS7
or RFC2630 certificate set.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-get-crt-raw" role="function">
<title>gnutls_pkcs7_get_crt_raw ()</title>
<indexterm zone="gnutls-pkcs7-get-crt-raw"><primary>gnutls_pkcs7_get_crt_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_get_crt_raw            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *certificate</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *certificate_size</parameter>);</programlisting>
<para>
This function will return a certificate of the PKCS7 or RFC2630
certificate set.
</para>
<para>
After the last certificate has been read
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be returned.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_pkcs7_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>contains the index of the certificate to extract</simpara></listitem></varlistentry>
<varlistentry><term><parameter>certificate</parameter>&#160;:</term>
<listitem><simpara>the contents of the certificate will be copied
there (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>certificate_size</parameter>&#160;:</term>
<listitem><simpara>should hold the size of the certificate</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.  If the provided buffer is not long enough,
then <parameter>certificate_size</parameter> is updated and
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-import" role="function">
<title>gnutls_pkcs7_import ()</title>
<indexterm zone="gnutls-pkcs7-import"><primary>gnutls_pkcs7_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_import                 (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);</programlisting>
<para>
This function will convert the given DER or PEM encoded PKCS7 to
the native <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> format.  The output will be stored in
<parameter>pkcs7</parameter>.
</para>
<para>
If the PKCS7 is PEM encoded it should have a header of "PKCS7".
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed PKCS7.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded PKCS7.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-init" role="function">
<title>gnutls_pkcs7_init ()</title>
<indexterm zone="gnutls-pkcs7-init"><primary>gnutls_pkcs7_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_init                   (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> *pkcs7</parameter>);</programlisting>
<para>
This function will initialize a PKCS7 structure. PKCS7 structures
usually contain lists of X.509 Certificates and X.509 Certificate
revocation lists.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-int" role="struct">
<title>struct gnutls_pkcs7_int</title>
<indexterm zone="gnutls-pkcs7-int"><primary>gnutls_pkcs7_int</primary></indexterm>
<programlisting>struct gnutls_pkcs7_int;</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-pkcs7-set-crl" role="function">
<title>gnutls_pkcs7_set_crl ()</title>
<indexterm zone="gnutls-pkcs7-set-crl"><primary>gnutls_pkcs7_set_crl</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_set_crl                (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will add a parsed CRL to the PKCS7 or RFC2630 crl
set.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>the DER encoded crl to be added</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-set-crl-raw" role="function">
<title>gnutls_pkcs7_set_crl_raw ()</title>
<indexterm zone="gnutls-pkcs7-set-crl-raw"><primary>gnutls_pkcs7_set_crl_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_set_crl_raw            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *crl</parameter>);</programlisting>
<para>
This function will add a crl to the PKCS7 or RFC2630 crl set.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>the DER encoded crl to be added</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-set-crt" role="function">
<title>gnutls_pkcs7_set_crt ()</title>
<indexterm zone="gnutls-pkcs7-set-crt"><primary>gnutls_pkcs7_set_crt</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_set_crt                (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>);</programlisting>
<para>
This function will add a parsed certificate to the PKCS7 or
RFC2630 certificate set.  This is a wrapper function over
<link linkend="gnutls-pkcs7-set-crt-raw"><function>gnutls_pkcs7_set_crt_raw()</function></link> .
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>the certificate to be copied.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-set-crt-raw" role="function">
<title>gnutls_pkcs7_set_crt_raw ()</title>
<indexterm zone="gnutls-pkcs7-set-crt-raw"><primary>gnutls_pkcs7_set_crt_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_pkcs7_set_crt_raw            (<parameter><link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> pkcs7</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *crt</parameter>);</programlisting>
<para>
This function will add a certificate to the PKCS7 or RFC2630
certificate set.
</para><variablelist role="params">
<varlistentry><term><parameter>pkcs7</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-pkcs7-t"><type>gnutls_pkcs7_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>the DER encoded certificate to be added</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-pkcs7-t" role="typedef">
<title>gnutls_pkcs7_t</title>
<indexterm zone="gnutls-pkcs7-t"><primary>gnutls_pkcs7_t</primary></indexterm>
<programlisting>  typedef struct gnutls_pkcs7_int *gnutls_pkcs7_t;
</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-pkcs-encrypt-flags-t" role="enum">
<title>enum gnutls_pkcs_encrypt_flags_t</title>
<indexterm zone="gnutls-pkcs-encrypt-flags-t"><primary>gnutls_pkcs_encrypt_flags_t</primary></indexterm>
<programlisting>typedef enum {
    GNUTLS_PKCS_PLAIN = 1,
    GNUTLS_PKCS_USE_PKCS12_3DES = 2,
    GNUTLS_PKCS_USE_PKCS12_ARCFOUR = 4,
    GNUTLS_PKCS_USE_PKCS12_RC2_40 = 8,
    GNUTLS_PKCS_USE_PBES2_3DES = 16,
    GNUTLS_PKCS_USE_PBES2_AES_128 = 32,
    GNUTLS_PKCS_USE_PBES2_AES_192 = 64,
    GNUTLS_PKCS_USE_PBES2_AES_256 = 128,
    GNUTLS_PKCS_NULL_PASSWORD = 256
} gnutls_pkcs_encrypt_flags_t;
</programlisting>
<para>
Enumeration of different PKCS encryption flags.
</para><variablelist role="enum">
<varlistentry id="GNUTLS-PKCS-PLAIN:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_PLAIN</literal></term>
<listitem><simpara>Unencrypted private key.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PKCS12-3DES:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PKCS12_3DES</literal></term>
<listitem><simpara>PKCS-12 3DES.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PKCS12-ARCFOUR:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PKCS12_ARCFOUR</literal></term>
<listitem><simpara>PKCS-12 ARCFOUR.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PKCS12-RC2-40:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PKCS12_RC2_40</literal></term>
<listitem><simpara>PKCS-12 RC2-40.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PBES2-3DES:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PBES2_3DES</literal></term>
<listitem><simpara>PBES2 3DES.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PBES2-AES-128:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PBES2_AES_128</literal></term>
<listitem><simpara>PBES2 AES-128.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PBES2-AES-192:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PBES2_AES_192</literal></term>
<listitem><simpara>PBES2 AES-192.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-USE-PBES2-AES-256:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_USE_PBES2_AES_256</literal></term>
<listitem><simpara>PBES2 AES-256.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-PKCS-NULL-PASSWORD:CAPS" role="constant">
<term><literal>GNUTLS_PKCS_NULL_PASSWORD</literal></term>
<listitem><simpara>Some schemas distinguish between an empty and a NULL password.
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-check-issuer" role="function">
<title>gnutls_x509_crl_check_issuer ()</title>
<indexterm zone="gnutls-x509-crl-check-issuer"><primary>gnutls_x509_crl_check_issuer</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_check_issuer        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>);</programlisting>
<para>
This function will check if the given CRL was issued by the given
issuer certificate.  It will return true (1) if the given CRL was
issued by the given issuer, and false (0) if not.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>is the CRL to be checked</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer</parameter>&#160;:</term>
<listitem><simpara>is the certificate of a possible issuer</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-deinit" role="function">
<title>gnutls_x509_crl_deinit ()</title>
<indexterm zone="gnutls-x509-crl-deinit"><primary>gnutls_x509_crl_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_crl_deinit              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will deinitialize a CRL structure.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-export" role="function">
<title>gnutls_x509_crl_export ()</title>
<indexterm zone="gnutls-x509-crl-export"><primary>gnutls_x509_crl_export</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_export              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the revocation list to DER or PEM format.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will be returned.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN X509 CRL".
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>Holds the revocation list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a private key PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will
be replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value. and a negative error code on failure.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-export2" role="function">
<title>gnutls_x509_crl_export2 ()</title>
<indexterm zone="gnutls-x509-crl-export2"><primary>gnutls_x509_crl_export2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_export2             (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the revocation list to DER or PEM format.
</para>
<para>
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN X509 CRL".
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>Holds the revocation list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a private key PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value. and a negative error code on failure.
Since 3.1.3</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-authority-key-gn-serial" role="function" condition="since:3.0">
<title>gnutls_x509_crl_get_authority_key_gn_serial ()</title>
<indexterm zone="gnutls-x509-crl-get-authority-key-gn-serial" role="3.0"><primary>gnutls_x509_crl_get_authority_key_gn_serial</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_authority_key_gn_serial
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *alt</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *alt_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *alt_type</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *serial_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the X.509 authority key
identifier when stored as a general name (authorityCertIssuer) 
and serial number.
</para>
<para>
Because more than one general names might be stored
<parameter>seq</parameter> can be used as a counter to request them all until 
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>alt</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>alt_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of alt.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>alt_type</parameter>&#160;:</term>
<listitem><simpara>holds the type of the alternative name (one of gnutls_x509_subject_alt_name_t).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial</parameter>&#160;:</term>
<listitem><simpara>buffer to store the serial number (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>Returns 0 on success, or an error code.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-authority-key-id" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_get_authority_key_id ()</title>
<indexterm zone="gnutls-x509-crl-get-authority-key-id" role="2.8.0"><primary>gnutls_x509_crl_get_authority_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_authority_key_id
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *id_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the CRL authority's key identifier.  This
is obtained by the X.509 Authority Key identifier extension field
(2.5.29.35).  Note that this function 
only returns the keyIdentifier field of the extension and
<link linkend="GNUTLS-E-X509-UNSUPPORTED-EXTENSION:CAPS"><literal>GNUTLS_E_X509_UNSUPPORTED_EXTENSION</literal></link>, if the extension contains
the name and serial number of the certificate. In that case
<link linkend="gnutls-x509-crl-get-authority-key-gn-serial"><function>gnutls_x509_crl_get_authority_key_gn_serial()</function></link> may be used.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id</parameter>&#160;:</term>
<listitem><simpara>The place where the identifier will be copied</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the result field.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical
(may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-certificate" role="macro">
<title>gnutls_x509_crl_get_certificate</title>
<indexterm zone="gnutls-x509-crl-get-certificate"><primary>gnutls_x509_crl_get_certificate</primary></indexterm>
<programlisting>#define gnutls_x509_crl_get_certificate gnutls_x509_crl_get_crt_serial
</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-certificate-count" role="macro">
<title>gnutls_x509_crl_get_certificate_count</title>
<indexterm zone="gnutls-x509-crl-get-certificate-count"><primary>gnutls_x509_crl_get_certificate_count</primary></indexterm>
<programlisting>#define gnutls_x509_crl_get_certificate_count gnutls_x509_crl_get_crt_count
</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-crt-count" role="function">
<title>gnutls_x509_crl_get_crt_count ()</title>
<indexterm zone="gnutls-x509-crl-get-crt-count"><primary>gnutls_x509_crl_get_crt_count</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_crt_count       (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will return the number of revoked certificates in the
given CRL.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>number of certificates, a negative error code on failure.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-crt-serial" role="function">
<title>gnutls_x509_crl_get_crt_serial ()</title>
<indexterm zone="gnutls-x509-crl-get-crt-serial"><primary>gnutls_x509_crl_get_crt_serial</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_crt_serial      (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *serial_size</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *t</parameter>);</programlisting>
<para>
This function will retrieve the serial number of the specified, by
the index, revoked certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>the index of the certificate to extract (starting from 0)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial</parameter>&#160;:</term>
<listitem><simpara>where the serial number will be copied</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of serial</simpara></listitem></varlistentry>
<varlistentry><term><parameter>t</parameter>&#160;:</term>
<listitem><simpara>if non null, will hold the time this certificate was revoked</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value. and a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-dn-oid" role="function">
<title>gnutls_x509_crl_get_dn_oid ()</title>
<indexterm zone="gnutls-x509-crl-get-dn-oid"><primary>gnutls_x509_crl_get_dn_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_dn_oid          (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);</programlisting>
<para>
This function will extract the requested OID of the name of the CRL
issuer, specified by the given index.
</para>
<para>
If oid is null then only the size will be filled.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which DN OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of 'oid'</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the sizeof_oid will be updated
with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-extension-data" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_get_extension_data ()</title>
<indexterm zone="gnutls-x509-crl-get-extension-data" role="2.8.0"><primary>gnutls_x509_crl_get_extension_data</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_extension_data  (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);</programlisting>
<para>
This function will return the requested extension data in the CRL.
The extension data will be stored as a string in the provided
buffer.
</para>
<para>
Use <link linkend="gnutls-x509-crl-get-extension-info"><function>gnutls_x509_crl_get_extension_info()</function></link> to extract the OID and
critical flag.  Use <link linkend="gnutls-x509-crl-get-extension-info"><function>gnutls_x509_crl_get_extension_info()</function></link> instead,
if you want to get data indexed by the extension OID rather than
sequence.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the data (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_data</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-extension-info" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_get_extension_info ()</title>
<indexterm zone="gnutls-x509-crl-get-extension-info" role="2.8.0"><primary>gnutls_x509_crl_get_extension_info</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_extension_info  (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the requested extension OID in the CRL,
and the critical flag for it.  The extension OID will be stored as
a string in the provided buffer.  Use
<link linkend="gnutls-x509-crl-get-extension-data"><function>gnutls_x509_crl_get_extension_data()</function></link> to extract the data.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>sizeof_oid</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will be
returned.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send, use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the maximum size of <parameter>oid</parameter>, on return
holds actual size of <parameter>oid</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>output variable with critical flag, may be NULL.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-extension-oid" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_get_extension_oid ()</title>
<indexterm zone="gnutls-x509-crl-get-extension-oid" role="2.8.0"><primary>gnutls_x509_crl_get_extension_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_extension_oid   (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);</programlisting>
<para>
This function will return the requested extension OID in the CRL.
The extension OID will be stored as a string in the provided
buffer.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send, use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the OID (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-issuer-dn" role="function">
<title>gnutls_x509_crl_get_issuer_dn ()</title>
<indexterm zone="gnutls-x509-crl-get-issuer-dn"><primary>gnutls_x509_crl_get_issuer_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_issuer_dn       (<parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will copy the name of the CRL issuer in the provided
buffer. The name will be in the form "C=xxxx,O=yyyy,CN=zzzz" as
described in RFC4514. The output string will be ASCII or UTF-8
encoded, depending on the certificate data.
</para>
<para>
If buf is <link linkend="NULL:CAPS"><literal>NULL</literal></link> then only the size will be filled.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the peer's name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the sizeof_buf will be updated
with the required size, and 0 on success.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-issuer-dn-by-oid" role="function">
<title>gnutls_x509_crl_get_issuer_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crl-get-issuer-dn-by-oid"><primary>gnutls_x509_crl_get_issuer_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_issuer_dn_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will extract the part of the name of the CRL issuer
specified by the given OID. The output will be encoded as described
in RFC4514. The output string will be ASCII or UTF-8 encoded,
depending on the certificate data.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is (0), this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC4514 -- in
hex format with a '#' prefix.  You can check about known OIDs
using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>.
</para>
<para>
If buf is null then only the size will be filled.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the RDN, this specifies which to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>If non-zero returns the raw DER data of the DN part.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the peer's name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the sizeof_buf will be updated
with the required size, and 0 on success.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-next-update" role="function">
<title>gnutls_x509_crl_get_next_update ()</title>
<indexterm zone="gnutls-x509-crl-get-next-update"><primary>gnutls_x509_crl_get_next_update</primary></indexterm>
<programlisting><link linkend="time-t"><returnvalue>time_t</returnvalue></link>              gnutls_x509_crl_get_next_update     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will return the time the next CRL will be issued.
This field is optional in a CRL so it might be normal to get an
error instead.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>when the next CRL will be issued, or (time_t)-1 on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-number" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_get_number ()</title>
<indexterm zone="gnutls-x509-crl-get-number" role="2.8.0"><primary>gnutls_x509_crl_get_number</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_number          (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the CRL number extension.  This is
obtained by the CRL Number extension field (2.5.29.20).
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret</parameter>&#160;:</term>
<listitem><simpara>The place where the number will be copied</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the result field.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical
(may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-raw-issuer-dn" role="function" condition="since:2.12.0">
<title>gnutls_x509_crl_get_raw_issuer_dn ()</title>
<indexterm zone="gnutls-x509-crl-get-raw-issuer-dn" role="2.12.0"><primary>gnutls_x509_crl_get_raw_issuer_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_raw_issuer_dn   (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *dn</parameter>);</programlisting>
<para>
This function will return a pointer to the DER encoded DN structure
and the length.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>will hold the starting point of the DN</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>a negative error code on error, and (0) on success.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.12.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-get-signature" role="function">
<title>gnutls_x509_crl_get_signature ()</title>
<indexterm zone="gnutls-x509-crl-get-signature"><primary>gnutls_x509_crl_get_signature</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_signature       (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *sig</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_sig</parameter>);</programlisting>
<para>
This function will extract the signature field of a CRL.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sig</parameter>&#160;:</term>
<listitem><simpara>a pointer where the signature part will be copied (may be null).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_sig</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>sig</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value. and a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-signature-algorithm" role="function">
<title>gnutls_x509_crl_get_signature_algorithm ()</title>
<indexterm zone="gnutls-x509-crl-get-signature-algorithm"><primary>gnutls_x509_crl_get_signature_algorithm</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_signature_algorithm
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will return a value of the <link linkend="gnutls-sign-algorithm-t"><type>gnutls_sign_algorithm_t</type></link>
enumeration that is the signature algorithm.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-this-update" role="function">
<title>gnutls_x509_crl_get_this_update ()</title>
<indexterm zone="gnutls-x509-crl-get-this-update"><primary>gnutls_x509_crl_get_this_update</primary></indexterm>
<programlisting><link linkend="time-t"><returnvalue>time_t</returnvalue></link>              gnutls_x509_crl_get_this_update     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will return the time this CRL was issued.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>when the CRL was issued, or (time_t)-1 on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-get-version" role="function">
<title>gnutls_x509_crl_get_version ()</title>
<indexterm zone="gnutls-x509-crl-get-version"><primary>gnutls_x509_crl_get_version</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_get_version         (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>);</programlisting>
<para>
This function will return the version of the specified CRL.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>The version number, or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-import" role="function">
<title>gnutls_x509_crl_import ()</title>
<indexterm zone="gnutls-x509-crl-import"><primary>gnutls_x509_crl_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_import              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);</programlisting>
<para>
This function will convert the given DER or PEM encoded CRL
to the native <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> format. The output will be stored in 'crl'.
</para>
<para>
If the CRL is PEM encoded it should have a header of "X509 CRL".
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed CRL.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded CRL.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-init" role="function">
<title>gnutls_x509_crl_init ()</title>
<indexterm zone="gnutls-x509-crl-init"><primary>gnutls_x509_crl_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_init                (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crl</parameter>);</programlisting>
<para>
This function will initialize a CRL structure. CRL stands for
Certificate Revocation List. A revocation list usually contains
lists of certificate serial numbers that have been revoked by an
Authority. The revocation lists are always signed with the
authority's private key.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-list-import" role="function" condition="since:3.0">
<title>gnutls_x509_crl_list_import ()</title>
<indexterm zone="gnutls-x509-crl-list-import" role="3.0"><primary>gnutls_x509_crl_list_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_list_import         (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crls</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *crl_max</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will convert the given PEM encoded CRL list
to the native gnutls_x509_crl_t format. The output will be stored
in <parameter>crls</parameter>.  They will be automatically initialized.
</para>
<para>
If the Certificate is PEM encoded it should have a header of "X509 CRL".
</para><variablelist role="params">
<varlistentry><term><parameter>crls</parameter>&#160;:</term>
<listitem><simpara>The structures to store the parsed CRLs. Must not be initialized.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_max</parameter>&#160;:</term>
<listitem><simpara>Initially must hold the maximum number of crls. It will be updated with the number of crls available.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The PEM encoded CRLs</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be (0) or an OR'd sequence of gnutls_certificate_import_flags.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the number of certificates read or a negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-list-import2" role="function" condition="since:3.0">
<title>gnutls_x509_crl_list_import2 ()</title>
<indexterm zone="gnutls-x509-crl-list-import2" role="3.0"><primary>gnutls_x509_crl_list_import2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_list_import2        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> **crls</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *size</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will convert the given PEM encoded CRL list
to the native gnutls_x509_crl_t format. The output will be stored
in <parameter>crls</parameter>.  They will be automatically initialized.
</para>
<para>
If the Certificate is PEM encoded it should have a header of "X509
CRL".
</para><variablelist role="params">
<varlistentry><term><parameter>crls</parameter>&#160;:</term>
<listitem><simpara>The structures to store the parsed crl list. Must not be initialized.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>size</parameter>&#160;:</term>
<listitem><simpara>It will contain the size of the list.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The PEM encoded CRL.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be (0) or an OR'd sequence of gnutls_certificate_import_flags.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the number of certificates read or a negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-print" role="function">
<title>gnutls_x509_crl_print ()</title>
<indexterm zone="gnutls-x509-crl-print"><primary>gnutls_x509_crl_print</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_print               (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-certificate-print-formats-t"><type>gnutls_certificate_print_formats_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will pretty print a X.509 certificate revocation
list, suitable for display to a human.
</para>
<para>
The output <parameter>out</parameter> needs to be deallocated using <link linkend="gnutls-free"><function>gnutls_free()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>The structure to be printed</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>Indicate the format to use</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>Newly allocated datum with (0) terminated string.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-reason-flags-t" role="enum">
<title>enum gnutls_x509_crl_reason_flags_t</title>
<indexterm zone="gnutls-x509-crl-reason-flags-t"><primary>gnutls_x509_crl_reason_flags_t</primary></indexterm>
<programlisting>typedef enum {
      GNUTLS_CRL_REASON_UNSPECIFIED=0,
      GNUTLS_CRL_REASON_PRIVILEGE_WITHDRAWN=1,
      GNUTLS_CRL_REASON_CERTIFICATE_HOLD=2,
      GNUTLS_CRL_REASON_CESSATION_OF_OPERATION=4,
      GNUTLS_CRL_REASON_SUPERSEDED=8,
      GNUTLS_CRL_REASON_AFFILIATION_CHANGED=16,
      GNUTLS_CRL_REASON_CA_COMPROMISE=32,
      GNUTLS_CRL_REASON_KEY_COMPROMISE=64,
      GNUTLS_CRL_REASON_UNUSED=128,
      GNUTLS_CRL_REASON_AA_COMPROMISE=32768
} gnutls_x509_crl_reason_flags_t;
</programlisting>
<para>
Enumeration of types for the CRL revocation reasons.
</para><variablelist role="enum">
<varlistentry id="GNUTLS-CRL-REASON-UNSPECIFIED:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_UNSPECIFIED</literal></term>
<listitem><simpara>
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-PRIVILEGE-WITHDRAWN:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_PRIVILEGE_WITHDRAWN</literal></term>
<listitem><simpara>The privileges were withdrawn from the owner.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-CERTIFICATE-HOLD:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_CERTIFICATE_HOLD</literal></term>
<listitem><simpara>The certificate is on hold.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-CESSATION-OF-OPERATION:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_CESSATION_OF_OPERATION</literal></term>
<listitem><simpara>The end-entity is no longer operating.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-SUPERSEDED:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_SUPERSEDED</literal></term>
<listitem><simpara>There is a newer certificate of the owner.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-AFFILIATION-CHANGED:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_AFFILIATION_CHANGED</literal></term>
<listitem><simpara>The end-entity affiliation has changed.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-CA-COMPROMISE:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_CA_COMPROMISE</literal></term>
<listitem><simpara>The CA was compromised.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-KEY-COMPROMISE:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_KEY_COMPROMISE</literal></term>
<listitem><simpara>The certificate's key was compromised.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-UNUSED:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_UNUSED</literal></term>
<listitem><simpara>The key was never used.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-CRL-REASON-AA-COMPROMISE:CAPS" role="constant">
<term><literal>GNUTLS_CRL_REASON_AA_COMPROMISE</literal></term>
<listitem><simpara>AA compromised.
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-set-authority-key-id" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_set_authority_key_id ()</title>
<indexterm zone="gnutls-x509-crl-set-authority-key-id" role="2.8.0"><primary>gnutls_x509_crl_set_authority_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_authority_key_id
                                                        (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> id_size</parameter>);</programlisting>
<para>
This function will set the CRL's authority key ID extension.  Only
the keyIdentifier field can be set with this function. This may
be used by an authority that holds multiple private keys, to distinguish
the used key.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>a CRL of type <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>id</parameter>&#160;:</term>
<listitem><simpara>The key ID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-set-crt" role="function">
<title>gnutls_x509_crl_set_crt ()</title>
<indexterm zone="gnutls-x509-crl-set-crt"><primary>gnutls_x509_crl_set_crt</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_crt             (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> revocation_time</parameter>);</programlisting>
<para>
This function will set a revoked certificate's serial number to the CRL.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> with the revoked certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>revocation_time</parameter>&#160;:</term>
<listitem><simpara>The time this certificate was revoked</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-set-crt-serial" role="function">
<title>gnutls_x509_crl_set_crt_serial ()</title>
<indexterm zone="gnutls-x509-crl-set-crt-serial"><primary>gnutls_x509_crl_set_crt_serial</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_crt_serial      (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> serial_size</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> revocation_time</parameter>);</programlisting>
<para>
This function will set a revoked certificate's serial number to the CRL.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial</parameter>&#160;:</term>
<listitem><simpara>The revoked certificate's serial number</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>revocation_time</parameter>&#160;:</term>
<listitem><simpara>The time this certificate was revoked</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-set-next-update" role="function">
<title>gnutls_x509_crl_set_next_update ()</title>
<indexterm zone="gnutls-x509-crl-set-next-update"><primary>gnutls_x509_crl_set_next_update</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_next_update     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> exp_time</parameter>);</programlisting>
<para>
This function will set the time this CRL will be updated.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>exp_time</parameter>&#160;:</term>
<listitem><simpara>The actual time</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-set-number" role="function" condition="since:2.8.0">
<title>gnutls_x509_crl_set_number ()</title>
<indexterm zone="gnutls-x509-crl-set-number" role="2.8.0"><primary>gnutls_x509_crl_set_number</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_number          (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *nr</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> nr_size</parameter>);</programlisting>
<para>
This function will set the CRL's number extension. This
is to be used as a unique and monotonic number assigned to
the CRL by the authority.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>a CRL of type <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>nr</parameter>&#160;:</term>
<listitem><simpara>The CRL number</simpara></listitem></varlistentry>
<varlistentry><term><parameter>nr_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the nr field.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crl-set-this-update" role="function">
<title>gnutls_x509_crl_set_this_update ()</title>
<indexterm zone="gnutls-x509-crl-set-this-update"><primary>gnutls_x509_crl_set_this_update</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_this_update     (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> act_time</parameter>);</programlisting>
<para>
This function will set the time this CRL was issued.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>act_time</parameter>&#160;:</term>
<listitem><simpara>The actual time</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-set-version" role="function">
<title>gnutls_x509_crl_set_version ()</title>
<indexterm zone="gnutls-x509-crl-set-version"><primary>gnutls_x509_crl_set_version</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_set_version         (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> version</parameter>);</programlisting>
<para>
This function will set the version of the CRL. This
must be one for CRL version 1, and so on. The CRLs generated
by gnutls should have a version number of 2.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>version</parameter>&#160;:</term>
<listitem><simpara>holds the version number. For CRLv1 crls must be 1.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-sign2" role="function">
<title>gnutls_x509_crl_sign2 ()</title>
<indexterm zone="gnutls-x509-crl-sign2"><primary>gnutls_x509_crl_sign2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_sign2               (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> issuer_key</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> dig</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will sign the CRL with the issuer's private key, and
will copy the issuer's information into the CRL.
</para>
<para>
This must be the last step in a certificate CRL since all
the previously set parameters are now signed.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crl_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer</parameter>&#160;:</term>
<listitem><simpara>is the certificate of the certificate issuer</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer_key</parameter>&#160;:</term>
<listitem><simpara>holds the issuer's private key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dig</parameter>&#160;:</term>
<listitem><simpara>The message digest to use. GNUTLS_DIG_SHA1 is the safe choice unless you know what you're doing.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be 0</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crl-verify" role="function">
<title>gnutls_x509_crl_verify ()</title>
<indexterm zone="gnutls-x509-crl-verify"><primary>gnutls_x509_crl_verify</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crl_verify              (<parameter><link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> crl</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *CA_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CA_list_length</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>);</programlisting>
<para>
This function will try to verify the given crl and return its status.
See <link linkend="gnutls-x509-crt-list-verify"><function>gnutls_x509_crt_list_verify()</function></link> for a detailed description of
return values. Note that since GnuTLS 3.1.4 this function includes
the time checks.
</para><variablelist role="params">
<varlistentry><term><parameter>crl</parameter>&#160;:</term>
<listitem><simpara>is the crl to be verified</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CA_list</parameter>&#160;:</term>
<listitem><simpara>is a certificate list that is considered to be trusted one</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CA_list_length</parameter>&#160;:</term>
<listitem><simpara>holds the number of CA certificates in CA_list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>verify</parameter>&#160;:</term>
<listitem><simpara>will hold the crl verification output.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-deinit" role="function">
<title>gnutls_x509_crq_deinit ()</title>
<indexterm zone="gnutls-x509-crq-deinit"><primary>gnutls_x509_crq_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_crq_deinit              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);</programlisting>
<para>
This function will deinitialize a PKCS<link linkend="10:CAPS"><type>10</type></link> certificate request
structure.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-export" role="function">
<title>gnutls_x509_crq_export ()</title>
<indexterm zone="gnutls-x509-crq-export"><primary>gnutls_x509_crq_export</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_export              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the certificate request to a PEM or DER
encoded PKCS10 structure.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will be returned and
*<parameter>output_data_size</parameter> will be updated.
</para>
<para>
If the structure is PEM encoded, it will have a header of "BEGIN
NEW CERTIFICATE REQUEST".
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a certificate request PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-export2" role="function">
<title>gnutls_x509_crq_export2 ()</title>
<indexterm zone="gnutls-x509-crq-export2"><primary>gnutls_x509_crq_export2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_export2             (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the certificate request to a PEM or DER
encoded PKCS10 structure.
</para>
<para>
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header of "BEGIN
NEW CERTIFICATE REQUEST".
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a certificate request PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.
Since 3.1.3</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-attribute-by-oid" role="function">
<title>gnutls_x509_crq_get_attribute_by_oid ()</title>
<indexterm zone="gnutls-x509-crq-get-attribute-by-oid"><primary>gnutls_x509_crq_get_attribute_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_attribute_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will return the attribute in the certificate request
specified by the given Object ID.  The attribute will be DER
encoded.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in (0)-terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the attribute list, this
specifies which to send, use (0) to get the first one</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the attribute data (may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-attribute-data" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_attribute_data ()</title>
<indexterm zone="gnutls-x509-crq-get-attribute-data" role="2.8.0"><primary>gnutls_x509_crq_get_attribute_data</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_attribute_data  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);</programlisting>
<para>
This function will return the requested attribute data in the
certificate request.  The attribute data will be stored as a string in the
provided buffer.
</para>
<para>
Use <link linkend="gnutls-x509-crq-get-attribute-info"><function>gnutls_x509_crq_get_attribute_info()</function></link> to extract the OID.
Use <link linkend="gnutls-x509-crq-get-attribute-by-oid"><function>gnutls_x509_crq_get_attribute_by_oid()</function></link> instead,
if you want to get data indexed by the attribute OID rather than
sequence.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which attribute OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the data (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_data</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-attribute-info" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_attribute_info ()</title>
<indexterm zone="gnutls-x509-crq-get-attribute-info" role="2.8.0"><primary>gnutls_x509_crq_get_attribute_info</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_attribute_info  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);</programlisting>
<para>
This function will return the requested attribute OID in the
certificate, and the critical flag for it.  The attribute OID will
be stored as a string in the provided buffer.  Use
<link linkend="gnutls-x509-crq-get-attribute-data"><function>gnutls_x509_crq_get_attribute_data()</function></link> to extract the data.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>sizeof_oid</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will be
returned.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which attribute OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the maximum size of <parameter>oid</parameter>, on return
holds actual size of <parameter>oid</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-basic-constraints" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_basic_constraints ()</title>
<indexterm zone="gnutls-x509-crq-get-basic-constraints" role="2.8.0"><primary>gnutls_x509_crq_get_basic_constraints</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_basic_constraints
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> *pathlen</parameter>);</programlisting>
<para>
This function will read the certificate's basic constraints, and
return the certificates CA status.  It reads the basicConstraints
X.509 extension (2.5.29.19).
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ca</parameter>&#160;:</term>
<listitem><simpara>pointer to output integer indicating CA status, may be NULL,
value is 1 if the certificate CA flag is set, 0 otherwise.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pathlen</parameter>&#160;:</term>
<listitem><simpara>pointer to output integer indicating path length (may be
NULL), non-negative error codes indicate a present pathLenConstraint
field and the actual value, -1 indicate that the field is absent.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>If the certificate is a CA a positive value will be
returned, or (0) if the certificate does not have CA flag set.
A negative error code may be returned in case of errors.  If the
certificate does not contain the basicConstraints extension
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-challenge-password" role="function">
<title>gnutls_x509_crq_get_challenge_password ()</title>
<indexterm zone="gnutls-x509-crq-get-challenge-password"><primary>gnutls_x509_crq_get_challenge_password</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_challenge_password
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *pass</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_pass</parameter>);</programlisting>
<para>
This function will return the challenge password in the request.
The challenge password is intended to be used for requesting a
revocation of the certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pass</parameter>&#160;:</term>
<listitem><simpara>will hold a (0)-terminated password string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_pass</parameter>&#160;:</term>
<listitem><simpara>Initially holds the size of <parameter>pass</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-dn" role="function">
<title>gnutls_x509_crq_get_dn ()</title>
<indexterm zone="gnutls-x509-crq-get-dn"><primary>gnutls_x509_crq_get_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_dn              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will copy the name of the Certificate request subject
to the provided buffer.  The name will be in the form
"C=xxxx,O=yyyy,CN=zzzz" as described in RFC 2253. The output string
<parameter>buf</parameter> will be ASCII or UTF-8 encoded, depending on the certificate
data.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is not
long enough, and in that case the *<parameter>sizeof_buf</parameter> will be updated with
the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-dn-by-oid" role="function">
<title>gnutls_x509_crq_get_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crq-get-dn-by-oid"><primary>gnutls_x509_crq_get_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_dn_by_oid       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will extract the part of the name of the Certificate
request subject, specified by the given OID. The output will be
encoded as described in RFC2253. The output string will be ASCII
or UTF-8 encoded, depending on the certificate data.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is (0), this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC2253 --
in hex format with a '#' prefix.  You can check about known OIDs
using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crq_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the RDN, this specifies
which to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>If non-zero returns the raw DER data of the DN part.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the *<parameter>sizeof_buf</parameter> will be
updated with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-dn-oid" role="function">
<title>gnutls_x509_crq_get_dn_oid ()</title>
<indexterm zone="gnutls-x509-crq-get-dn-oid"><primary>gnutls_x509_crq_get_dn_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_dn_oid          (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>);</programlisting>
<para>
This function will extract the requested OID of the name of the
certificate request subject, specified by the given index.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a gnutls_x509_crq_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which DN OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the *<parameter>sizeof_oid</parameter> will be
updated with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-extension-by-oid" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_extension_by_oid ()</title>
<indexterm zone="gnutls-x509-crq-get-extension-by-oid" role="2.8.0"><primary>gnutls_x509_crq_get_extension_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_extension_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the extension specified by the OID in
the certificate.  The extensions will be returned as binary data
DER encoded, in the provided buffer.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the extensions, this
specifies which to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If the certificate does not
contain the specified extension
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-extension-data" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_extension_data ()</title>
<indexterm zone="gnutls-x509-crq-get-extension-data" role="2.8.0"><primary>gnutls_x509_crq_get_extension_data</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_extension_data  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);</programlisting>
<para>
This function will return the requested extension data in the
certificate.  The extension data will be stored as a string in the
provided buffer.
</para>
<para>
Use <link linkend="gnutls-x509-crq-get-extension-info"><function>gnutls_x509_crq_get_extension_info()</function></link> to extract the OID and
critical flag.  Use <link linkend="gnutls-x509-crq-get-extension-by-oid"><function>gnutls_x509_crq_get_extension_by_oid()</function></link> instead,
if you want to get data indexed by the extension OID rather than
sequence.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the data (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_data</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-extension-info" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_extension_info ()</title>
<indexterm zone="gnutls-x509-crq-get-extension-info" role="2.8.0"><primary>gnutls_x509_crq_get_extension_info</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_extension_info  (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the requested extension OID in the
certificate, and the critical flag for it.  The extension OID will
be stored as a string in the provided buffer.  Use
<link linkend="gnutls-x509-crq-get-extension-data"><function>gnutls_x509_crq_get_extension_data()</function></link> to extract the data.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>sizeof_oid</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will be
returned.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the maximum size of <parameter>oid</parameter>, on return
holds actual size of <parameter>oid</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>output variable with critical flag, may be NULL.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error code in case of an error.  If your have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-key-id" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_key_id ()</title>
<indexterm zone="gnutls-x509-crq-get-key-id" role="2.8.0"><primary>gnutls_x509_crq_get_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_key_id          (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will return a unique ID that depends on the public key
parameters.  This ID can be used in checking whether a certificate
corresponds to the given private key.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>output_data_size</parameter> is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.  The output will normally be a SHA-1 hash output,
which is 20 bytes.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>should be 0 for now</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain the key ID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of failure a negative error code will be
returned, and 0 on success.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-key-purpose-oid" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_key_purpose_oid ()</title>
<indexterm zone="gnutls-x509-crq-get-key-purpose-oid" role="2.8.0"><primary>gnutls_x509_crq_get_key_purpose_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_key_purpose_oid (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will extract the key purpose OIDs of the Certificate
specified by the given index.  These are stored in the Extended Key
Usage extension (2.5.29.37).  See the GNUTLS_KP_* definitions for
human readable names.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>This specifies which OID to return, use (0) to get the first one</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a buffer to hold the OID (may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_oid</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>output variable with critical flag, may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the *<parameter>sizeof_oid</parameter> will be
updated with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-key-rsa-raw" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_key_rsa_raw ()</title>
<indexterm zone="gnutls-x509-crq-get-key-rsa-raw" role="2.8.0"><primary>gnutls_x509_crq_get_key_rsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_key_rsa_raw     (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>);</programlisting>
<para>
This function will export the RSA public key's parameters found in
the given structure.  The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>will hold the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>will hold the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-key-usage" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_key_usage ()</title>
<indexterm zone="gnutls-x509-crq-get-key-usage" role="2.8.0"><primary>gnutls_x509_crq_get_key_usage</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_key_usage       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *key_usage</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return certificate's key usage, by reading the
keyUsage X.509 extension (2.5.29.15).  The key usage value will
ORed values of the: <link linkend="GNUTLS-KEY-DIGITAL-SIGNATURE:CAPS"><literal>GNUTLS_KEY_DIGITAL_SIGNATURE</literal></link>,
<link linkend="GNUTLS-KEY-NON-REPUDIATION:CAPS"><literal>GNUTLS_KEY_NON_REPUDIATION</literal></link>, <link linkend="GNUTLS-KEY-KEY-ENCIPHERMENT:CAPS"><literal>GNUTLS_KEY_KEY_ENCIPHERMENT</literal></link>,
<link linkend="GNUTLS-KEY-DATA-ENCIPHERMENT:CAPS"><literal>GNUTLS_KEY_DATA_ENCIPHERMENT</literal></link>, <link linkend="GNUTLS-KEY-KEY-AGREEMENT:CAPS"><literal>GNUTLS_KEY_KEY_AGREEMENT</literal></link>,
<link linkend="GNUTLS-KEY-KEY-CERT-SIGN:CAPS"><literal>GNUTLS_KEY_KEY_CERT_SIGN</literal></link>, <link linkend="GNUTLS-KEY-CRL-SIGN:CAPS"><literal>GNUTLS_KEY_CRL_SIGN</literal></link>,
<link linkend="GNUTLS-KEY-ENCIPHER-ONLY:CAPS"><literal>GNUTLS_KEY_ENCIPHER_ONLY</literal></link>, <link linkend="GNUTLS-KEY-DECIPHER-ONLY:CAPS"><literal>GNUTLS_KEY_DECIPHER_ONLY</literal></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>key_usage</parameter>&#160;:</term>
<listitem><simpara>where the key usage bits will be stored</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the certificate key usage, or a negative error code in case of
parsing error.  If the certificate does not contain the keyUsage
extension <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be
returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-pk-algorithm" role="function">
<title>gnutls_x509_crq_get_pk_algorithm ()</title>
<indexterm zone="gnutls-x509-crq-get-pk-algorithm"><primary>gnutls_x509_crq_get_pk_algorithm</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_pk_algorithm    (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *bits</parameter>);</programlisting>
<para>
This function will return the public key algorithm of a PKCS<link linkend="10:CAPS"><type>10</type></link>
certificate request.
</para>
<para>
If bits is non-<link linkend="NULL:CAPS"><literal>NULL</literal></link>, it should have enough size to hold the
parameters size in bits.  For RSA the bits returned is the modulus.
For DSA the bits returned are of the public exponent.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>bits</parameter>&#160;:</term>
<listitem><simpara>if bits is non-<link linkend="NULL:CAPS"><literal>NULL</literal></link> it will hold the size of the parameters' in bits</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>a member of the <link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link> enumeration on
success, or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-private-key-usage-period" role="function">
<title>gnutls_x509_crq_get_private_key_usage_period ()</title>
<indexterm zone="gnutls-x509-crq-get-private-key-usage-period"><primary>gnutls_x509_crq_get_private_key_usage_period</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_private_key_usage_period
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *expiration</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the expiration and activation
times of the private key of the certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>activation</parameter>&#160;:</term>
<listitem><simpara>The activation time</simpara></listitem></varlistentry>
<varlistentry><term><parameter>expiration</parameter>&#160;:</term>
<listitem><simpara>The expiration time</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>the extension status</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
if the extension is not present, otherwise a negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-get-subject-alt-name" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_subject_alt_name ()</title>
<indexterm zone="gnutls-x509-crq-get-subject-alt-name" role="2.8.0"><primary>gnutls_x509_crq_get_subject_alt_name</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_subject_alt_name
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ret_type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the alternative names, contained in the
given certificate.  It is the same as
<link linkend="gnutls-x509-crq-get-subject-alt-name"><function>gnutls_x509_crq_get_subject_alt_name()</function></link> except for the fact that it
will return the type of the alternative name in <parameter>ret_type</parameter> even if
the function fails for some reason (i.e.  the buffer provided is
not enough).
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name, 0 for the
first one, 1 for the second etc.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_type</parameter>&#160;:</term>
<listitem><simpara>holds the <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> name type</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical
(may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative subject name type on success, one of the
enumerated <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link>.  It will return
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if <parameter>ret_size</parameter> is not large enough to
hold the value.  In that case <parameter>ret_size</parameter> will be updated with the
required size.  If the certificate request does not have an
Alternative name with the specified sequence number then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-subject-alt-othername-oid" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_get_subject_alt_othername_oid ()</title>
<indexterm zone="gnutls-x509-crq-get-subject-alt-othername-oid" role="2.8.0"><primary>gnutls_x509_crq_get_subject_alt_othername_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_subject_alt_othername_oid
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>);</programlisting>
<para>
This function will extract the type OID of an otherName Subject
Alternative Name, contained in the given certificate, and return
the type as an enumerated element.
</para>
<para>
This function is only useful if
<link linkend="gnutls-x509-crq-get-subject-alt-name"><function>gnutls_x509_crq_get_subject_alt_name()</function></link> returned
<link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret</parameter>&#160;:</term>
<listitem><simpara>is the place where the otherName OID will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative subject name type on success, one of the
enumerated gnutls_x509_subject_alt_name_t.  For supported OIDs,
it will return one of the virtual (GNUTLS_SAN_OTHERNAME_*) types,
e.g. <link linkend="GNUTLS-SAN-OTHERNAME-XMPP:CAPS"><literal>GNUTLS_SAN_OTHERNAME_XMPP</literal></link>, and <link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link> for
unknown OIDs.  It will return <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if
<parameter>ret_size</parameter> is not large enough to hold the value.  In that case
<parameter>ret_size</parameter> will be updated with the required size.  If the
certificate does not have an Alternative name with the specified
sequence number and with the otherName type then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-get-version" role="function">
<title>gnutls_x509_crq_get_version ()</title>
<indexterm zone="gnutls-x509-crq-get-version"><primary>gnutls_x509_crq_get_version</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_get_version         (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);</programlisting>
<para>
This function will return the version of the specified Certificate
request.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>version of certificate request, or a negative error code on
error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-import" role="function">
<title>gnutls_x509_crq_import ()</title>
<indexterm zone="gnutls-x509-crq-import"><primary>gnutls_x509_crq_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_import              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);</programlisting>
<para>
This function will convert the given DER or PEM encoded certificate
request to a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure.  The output will be
stored in <parameter>crq</parameter>.
</para>
<para>
If the Certificate is PEM encoded it should have a header of "NEW
CERTIFICATE REQUEST".
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed certificate request.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded certificate.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-init" role="function">
<title>gnutls_x509_crq_init ()</title>
<indexterm zone="gnutls-x509-crq-init"><primary>gnutls_x509_crq_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_init                (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> *crq</parameter>);</programlisting>
<para>
This function will initialize a PKCS<link linkend="10:CAPS"><type>10</type></link> certificate request
structure.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-print" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_print ()</title>
<indexterm zone="gnutls-x509-crq-print" role="2.8.0"><primary>gnutls_x509_crq_print</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_print               (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-certificate-print-formats-t"><type>gnutls_certificate_print_formats_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will pretty print a certificate request, suitable for
display to a human.
</para>
<para>
The output <parameter>out</parameter> needs to be deallocated using <link linkend="gnutls-free"><function>gnutls_free()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>The structure to be printed</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>Indicate the format to use</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>Newly allocated datum with (0) terminated string.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-set-attribute-by-oid" role="function">
<title>gnutls_x509_crq_set_attribute_by_oid ()</title>
<indexterm zone="gnutls-x509-crq-set-attribute-by-oid"><primary>gnutls_x509_crq_set_attribute_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_attribute_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> sizeof_buf</parameter>);</programlisting>
<para>
This function will set the attribute in the certificate request
specified by the given Object ID.  The attribute must be be DER
encoded.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in (0)-terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure that holds the attribute data</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-set-basic-constraints" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_set_basic_constraints ()</title>
<indexterm zone="gnutls-x509-crq-set-basic-constraints" role="2.8.0"><primary>gnutls_x509_crq_set_basic_constraints</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_basic_constraints
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> pathLenConstraint</parameter>);</programlisting>
<para>
This function will set the basicConstraints certificate extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>a certificate request of type <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>ca</parameter>&#160;:</term>
<listitem><simpara>true(1) or false(0) depending on the Certificate authority status.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pathLenConstraint</parameter>&#160;:</term>
<listitem><simpara>non-negative error codes indicate maximum length of path,
and negative error codes indicate that the pathLenConstraints field should
not be present.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-set-challenge-password" role="function">
<title>gnutls_x509_crq_set_challenge_password ()</title>
<indexterm zone="gnutls-x509-crq-set-challenge-password"><primary>gnutls_x509_crq_set_challenge_password</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_challenge_password
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *pass</parameter>);</programlisting>
<para>
This function will set a challenge password to be used when
revoking the request.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pass</parameter>&#160;:</term>
<listitem><simpara>holds a (0)-terminated password</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-set-dn-by-oid" role="function">
<title>gnutls_x509_crq_set_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crq-set-dn-by-oid"><primary>gnutls_x509_crq_set_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_dn_by_oid       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_data</parameter>);</programlisting>
<para>
This function will set the part of the name of the Certificate
request subject, specified by the given OID.  The input string
should be ASCII or UTF-8 encoded.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
With this function you can only set the known OIDs.  You can test
for known OIDs using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>.  For OIDs that are
not known (by gnutls) you should properly DER encode your data, and
call this function with raw_flag set.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identifier in a (0)-terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>must be 0, or 1 if the data are DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>a pointer to the input data</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_data</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>data</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-set-key" role="function">
<title>gnutls_x509_crq_set_key ()</title>
<indexterm zone="gnutls-x509-crq-set-key"><primary>gnutls_x509_crq_set_key</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_key             (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will set the public parameters from the given private
key to the request.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>holds a private key</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-set-key-purpose-oid" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_set_key_purpose_oid ()</title>
<indexterm zone="gnutls-x509-crq-set-key-purpose-oid" role="2.8.0"><primary>gnutls_x509_crq_set_key_purpose_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_key_purpose_oid (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);</programlisting>
<para>
This function will set the key purpose OIDs of the Certificate.
These are stored in the Extended Key Usage extension (2.5.29.37)
See the GNUTLS_KP_* definitions for human readable names.
</para>
<para>
Subsequent calls to this function will append OIDs to the OID list.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a (0)-terminated string that holds the OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>Whether this extension will be critical or not</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-set-key-rsa-raw" role="function" condition="since:2.6.0">
<title>gnutls_x509_crq_set_key_rsa_raw ()</title>
<indexterm zone="gnutls-x509-crq-set-key-rsa-raw" role="2.6.0"><primary>gnutls_x509_crq_set_key_rsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_key_rsa_raw     (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>);</programlisting>
<para>
This function will set the public parameters from the given private
key to the request. Only RSA keys are currently supported.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>holds the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>holds the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.6.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-set-key-usage" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_set_key_usage ()</title>
<indexterm zone="gnutls-x509-crq-set-key-usage" role="2.8.0"><primary>gnutls_x509_crq_set_key_usage</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_key_usage       (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> usage</parameter>);</programlisting>
<para>
This function will set the keyUsage certificate extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>a certificate request of type <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>usage</parameter>&#160;:</term>
<listitem><simpara>an ORed sequence of the GNUTLS_KEY_* elements.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-set-private-key-usage-period" role="function">
<title>gnutls_x509_crq_set_private_key_usage_period ()</title>
<indexterm zone="gnutls-x509-crq-set-private-key-usage-period"><primary>gnutls_x509_crq_set_private_key_usage_period</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_private_key_usage_period
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> expiration</parameter>);</programlisting>
<para>
This function will set the private key usage period extension (2.5.29.16).
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>activation</parameter>&#160;:</term>
<listitem><simpara>The activation time</simpara></listitem></varlistentry>
<varlistentry><term><parameter>expiration</parameter>&#160;:</term>
<listitem><simpara>The expiration time</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-set-subject-alt-name" role="function" condition="since:2.8.0">
<title>gnutls_x509_crq_set_subject_alt_name ()</title>
<indexterm zone="gnutls-x509-crq-set-subject-alt-name" role="2.8.0"><primary>gnutls_x509_crq_set_subject_alt_name</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_subject_alt_name
                                                        (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> nt</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> data_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will set the subject alternative name certificate
extension.  It can set the following types:
</para>
<para>
<link linkend="GNUTLS-SAN-DNSNAME:CAPS"><literal>GNUTLS_SAN_DNSNAME</literal></link>: as a text string
</para>
<para>
<link linkend="GNUTLS-SAN-RFC822NAME:CAPS"><literal>GNUTLS_SAN_RFC822NAME</literal></link>: as a text string
</para>
<para>
<link linkend="GNUTLS-SAN-URI:CAPS"><literal>GNUTLS_SAN_URI</literal></link>: as a text string
</para>
<para>
<link linkend="GNUTLS-SAN-IPADDRESS:CAPS"><literal>GNUTLS_SAN_IPADDRESS</literal></link>: as a binary IP address (4 or 16 bytes)
</para>
<para>
Other values can be set as binary values with the proper DER encoding.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>a certificate request of type <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>nt</parameter>&#160;:</term>
<listitem><simpara>is one of the <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> enumerations</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The data to be set</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data_size</parameter>&#160;:</term>
<listitem><simpara>The size of data to be set</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara><link linkend="GNUTLS-FSAN-SET:CAPS"><literal>GNUTLS_FSAN_SET</literal></link> to clear previous data or
<link linkend="GNUTLS-FSAN-APPEND:CAPS"><literal>GNUTLS_FSAN_APPEND</literal></link> to append.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crq-set-version" role="function">
<title>gnutls_x509_crq_set_version ()</title>
<indexterm zone="gnutls-x509-crq-set-version"><primary>gnutls_x509_crq_set_version</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_set_version         (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> version</parameter>);</programlisting>
<para>
This function will set the version of the certificate request.  For
version 1 requests this must be one.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>version</parameter>&#160;:</term>
<listitem><simpara>holds the version number, for v1 Requests must be 1</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-sign2" role="function">
<title>gnutls_x509_crq_sign2 ()</title>
<indexterm zone="gnutls-x509-crq-sign2"><primary>gnutls_x509_crq_sign2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_sign2               (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> dig</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will sign the certificate request with a private key.
This must be the same key as the one used in
<link linkend="gnutls-x509-crt-set-key"><function>gnutls_x509_crt_set_key()</function></link> since a certificate request is self
signed.
</para>
<para>
This must be the last step in a certificate request generation
since all the previously set parameters are now signed.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>holds a private key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dig</parameter>&#160;:</term>
<listitem><simpara>The message digest to use, i.e., <link linkend="GNUTLS-DIG-SHA1:CAPS"><literal>GNUTLS_DIG_SHA1</literal></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be 0</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> on success, otherwise a negative error code.
<link linkend="GNUTLS-E-ASN1-VALUE-NOT-FOUND:CAPS"><literal>GNUTLS_E_ASN1_VALUE_NOT_FOUND</literal></link> is returned if you didn't set all
information in the certificate request (e.g., the version using
<link linkend="gnutls-x509-crq-set-version"><function>gnutls_x509_crq_set_version()</function></link>).</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crq-verify" role="function">
<title>gnutls_x509_crq_verify ()</title>
<indexterm zone="gnutls-x509-crq-verify"><primary>gnutls_x509_crq_verify</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crq_verify              (<parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will verify self signature in the certificate
request and return its status.
</para><variablelist role="params">
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>is the crq to be verified</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of a verification failure <link linkend="GNUTLS-E-PK-SIG-VERIFY-FAILED:CAPS"><literal>GNUTLS_E_PK_SIG_VERIFY_FAILED</literal></link>
is returned, and zero or positive code on success.
Since 2.12.0</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-check-hostname" role="function">
<title>gnutls_x509_crt_check_hostname ()</title>
<indexterm zone="gnutls-x509-crt-check-hostname"><primary>gnutls_x509_crt_check_hostname</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_check_hostname      (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *hostname</parameter>);</programlisting>
<para>
This function will check if the given certificate's subject matches
the given hostname.  This is a basic implementation of the matching
described in RFC2818 (HTTPS), which takes into account wildcards,
and the DNSName/IPAddress subject alternative name PKIX extension.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain an gnutls_x509_crt_t structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>hostname</parameter>&#160;:</term>
<listitem><simpara>A null terminated string that contains a DNS name</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>non-zero for a successful match, and zero on failure.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-check-issuer" role="function">
<title>gnutls_x509_crt_check_issuer ()</title>
<indexterm zone="gnutls-x509-crt-check-issuer"><primary>gnutls_x509_crt_check_issuer</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_check_issuer        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>);</programlisting>
<para>
This function will check if the given certificate was issued by the
given issuer. It checks the DN fields and the authority
key identifier and subject key identifier fields match.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>is the certificate to be checked</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer</parameter>&#160;:</term>
<listitem><simpara>is the certificate of a possible issuer</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>It will return true (1) if the given certificate is issued
by the given issuer, and false (0) if not.  A negative error code is
returned in case of an error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-check-revocation" role="function">
<title>gnutls_x509_crt_check_revocation ()</title>
<indexterm zone="gnutls-x509-crt-check-revocation"><primary>gnutls_x509_crt_check_revocation</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_check_revocation    (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crl_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> crl_list_length</parameter>);</programlisting>
<para>
This function will return check if the given certificate is
revoked.  It is assumed that the CRLs have been verified before.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_list</parameter>&#160;:</term>
<listitem><simpara>should contain a list of gnutls_x509_crl_t structures</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_list_length</parameter>&#160;:</term>
<listitem><simpara>the length of the crl_list</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>0 if the certificate is NOT revoked, and 1 if it is.  A
negative error code is returned on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-cpy-crl-dist-points" role="function">
<title>gnutls_x509_crt_cpy_crl_dist_points ()</title>
<indexterm zone="gnutls-x509-crt-cpy-crl-dist-points"><primary>gnutls_x509_crt_cpy_crl_dist_points</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_cpy_crl_dist_points (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> dst</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> src</parameter>);</programlisting>
<para>
This function will copy the CRL distribution points certificate
extension, from the source to the destination certificate.
This may be useful to copy from a CA certificate to issued ones.
</para><variablelist role="params">
<varlistentry><term><parameter>dst</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>src</parameter>&#160;:</term>
<listitem><simpara>the certificate where the dist points will be copied from</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-deinit" role="function">
<title>gnutls_x509_crt_deinit ()</title>
<indexterm zone="gnutls-x509-crt-deinit"><primary>gnutls_x509_crt_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_crt_deinit              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);</programlisting>
<para>
This function will deinitialize a certificate structure.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>The structure to be deinitialized</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-export" role="function">
<title>gnutls_x509_crt_export ()</title>
<indexterm zone="gnutls-x509-crt-export"><primary>gnutls_x509_crt_export</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_export              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the certificate to DER or PEM format.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN CERTIFICATE".
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a certificate PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of failure a negative error code will be
returned, and 0 on success.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-export2" role="function" condition="since:3.1">
<title>gnutls_x509_crt_export2 ()</title>
<indexterm zone="gnutls-x509-crt-export2" role="3.1"><primary>gnutls_x509_crt_export2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_export2             (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the certificate to DER or PEM format.
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN CERTIFICATE".
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a certificate PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of failure a negative error code will be
returned, and 0 on success.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-activation-time" role="function">
<title>gnutls_x509_crt_get_activation_time ()</title>
<indexterm zone="gnutls-x509-crt-get-activation-time"><primary>gnutls_x509_crt_get_activation_time</primary></indexterm>
<programlisting><link linkend="time-t"><returnvalue>time_t</returnvalue></link>              gnutls_x509_crt_get_activation_time (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);</programlisting>
<para>
This function will return the time this Certificate was or will be
activated.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>activation time, or (time_t)-1 on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-authority-info-access" role="function" condition="since:3.0">
<title>gnutls_x509_crt_get_authority_info_access ()</title>
<indexterm zone="gnutls-x509-crt-get-authority-info-access" role="3.0"><primary>gnutls_x509_crt_get_authority_info_access</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_authority_info_access
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> what</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function extracts the Authority Information Access (AIA)
extension, see RFC 5280 section 4.2.2.1 for more information.  The
AIA extension holds a sequence of AccessDescription (AD) data:
</para>
<para>
<informalexample><programlisting>
AuthorityInfoAccessSyntax  ::=
        SEQUENCE SIZE (1..MAX) OF AccessDescription

AccessDescription  ::=  SEQUENCE {
        accessMethod          OBJECT IDENTIFIER,
        accessLocation        GeneralName  }
</programlisting></informalexample>
</para>
<para>
The <parameter>seq</parameter> input parameter is used to indicate which member of the
sequence the caller is interested in.  The first member is 0, the
second member 1 and so on.  When the <parameter>seq</parameter> value is out of bounds,
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.
</para>
<para>
The type of data returned in <parameter>data</parameter> is specified via <parameter>what</parameter> which
should be <link linkend="gnutls-info-access-what-t"><type>gnutls_info_access_what_t</type></link> values.
</para>
<para>
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-ACCESSMETHOD-OID:CAPS"><literal>GNUTLS_IA_ACCESSMETHOD_OID</literal></link> then <parameter>data</parameter> will hold the
accessMethod OID (e.g., "1.3.6.1.5.5.7.48.1").
</para>
<para>
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-ACCESSLOCATION-GENERALNAME-TYPE:CAPS"><literal>GNUTLS_IA_ACCESSLOCATION_GENERALNAME_TYPE</literal></link>, <parameter>data</parameter> will
hold the accessLocation GeneralName type (e.g.,
"uniformResourceIdentifier").
</para>
<para>
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-URI:CAPS"><literal>GNUTLS_IA_URI</literal></link>, <parameter>data</parameter> will hold the accessLocation URI
data.  Requesting this <parameter>what</parameter> value leads to an error if the
accessLocation is not of the "uniformResourceIdentifier" type.
</para>
<para>
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-OCSP-URI:CAPS"><literal>GNUTLS_IA_OCSP_URI</literal></link>, <parameter>data</parameter> will hold the OCSP URI.
Requesting this <parameter>what</parameter> value leads to an error if the accessMethod
is not 1.3.6.1.5.5.7.48.1 aka OSCP, or if accessLocation is not of
the "uniformResourceIdentifier" type.
</para>
<para>
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-CAISSUERS-URI:CAPS"><literal>GNUTLS_IA_CAISSUERS_URI</literal></link>, <parameter>data</parameter> will hold the caIssuers
URI.  Requesting this <parameter>what</parameter> value leads to an error if the
accessMethod is not 1.3.6.1.5.5.7.48.2 aka caIssuers, or if
accessLocation is not of the "uniformResourceIdentifier" type.
</para>
<para>
More <parameter>what</parameter> values may be allocated in the future as needed.
</para>
<para>
If <parameter>data</parameter> is NULL, the function does the same without storing the
output data, that is, it will set <parameter>critical</parameter> and do error checking
as usual.
</para>
<para>
The value of the critical flag is returned in *<parameter>critical</parameter>.  Supply a
NULL <parameter>critical</parameter> if you want the function to make sure the extension
is non-critical, as required by RFC 5280.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the access descriptor (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>what</parameter>&#160;:</term>
<listitem><simpara>what data to get, a <link linkend="gnutls-info-access-what-t"><type>gnutls_info_access_what_t</type></link> type.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>output data to be freed with <link linkend="gnutls-free"><function>gnutls_free()</function></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>pointer to output integer that is set to non-0 if the extension is marked as critical (may be <link linkend="NULL:CAPS"><literal>NULL</literal></link>)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> on success, <link linkend="GNUTLS-E-INVALID-REQUEST:CAPS"><literal>GNUTLS_E_INVALID_REQUEST</literal></link> on
invalid <parameter>crt</parameter>, <link linkend="GNUTLS-E-CONSTRAINT-ERROR:CAPS"><literal>GNUTLS_E_CONSTRAINT_ERROR</literal></link> if the extension is
incorrectly marked as critical (use a non-NULL <parameter>critical</parameter> to
override), <link linkend="GNUTLS-E-UNKNOWN-ALGORITHM:CAPS"><literal>GNUTLS_E_UNKNOWN_ALGORITHM</literal></link> if the requested OID does
not match (e.g., when using <link linkend="GNUTLS-IA-OCSP-URI:CAPS"><literal>GNUTLS_IA_OCSP_URI</literal></link>), otherwise a
negative error code.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-authority-key-gn-serial" role="function" condition="since:3.0">
<title>gnutls_x509_crt_get_authority_key_gn_serial ()</title>
<indexterm zone="gnutls-x509-crt-get-authority-key-gn-serial" role="3.0"><primary>gnutls_x509_crt_get_authority_key_gn_serial</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_authority_key_gn_serial
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *alt</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *alt_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *alt_type</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *serial_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the X.509 authority key
identifier when stored as a general name (authorityCertIssuer) 
and serial number.
</para>
<para>
Because more than one general names might be stored
<parameter>seq</parameter> can be used as a counter to request them all until 
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>alt</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>alt_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of alt.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>alt_type</parameter>&#160;:</term>
<listitem><simpara>holds the type of the alternative name (one of gnutls_x509_subject_alt_name_t).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial</parameter>&#160;:</term>
<listitem><simpara>buffer to store the serial number (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
if the extension is not present, otherwise a negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-authority-key-id" role="function">
<title>gnutls_x509_crt_get_authority_key_id ()</title>
<indexterm zone="gnutls-x509-crt-get-authority-key-id"><primary>gnutls_x509_crt_get_authority_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_authority_key_id
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *id_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the X.509v3 certificate authority's key
identifier.  This is obtained by the X.509 Authority Key
identifier extension field (2.5.29.35). Note that this function
only returns the keyIdentifier field of the extension and
<link linkend="GNUTLS-E-X509-UNSUPPORTED-EXTENSION:CAPS"><literal>GNUTLS_E_X509_UNSUPPORTED_EXTENSION</literal></link>, if the extension contains
the name and serial number of the certificate. In that case
<link linkend="gnutls-x509-crt-get-authority-key-gn-serial"><function>gnutls_x509_crt_get_authority_key_gn_serial()</function></link> may be used.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id</parameter>&#160;:</term>
<listitem><simpara>The place where the identifier will be copied</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the id field.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
if the extension is not present, otherwise a negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-basic-constraints" role="function">
<title>gnutls_x509_crt_get_basic_constraints ()</title>
<indexterm zone="gnutls-x509-crt-get-basic-constraints"><primary>gnutls_x509_crt_get_basic_constraints</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_basic_constraints
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> *pathlen</parameter>);</programlisting>
<para>
This function will read the certificate's basic constraints, and
return the certificates CA status.  It reads the basicConstraints
X.509 extension (2.5.29.19).
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ca</parameter>&#160;:</term>
<listitem><simpara>pointer to output integer indicating CA status, may be NULL,
value is 1 if the certificate CA flag is set, 0 otherwise.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pathlen</parameter>&#160;:</term>
<listitem><simpara>pointer to output integer indicating path length (may be
NULL), non-negative error codes indicate a present pathLenConstraint
field and the actual value, -1 indicate that the field is absent.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>If the certificate is a CA a positive value will be
returned, or (0) if the certificate does not have CA flag set.  A
negative error code may be returned in case of errors.  If the
certificate does not contain the basicConstraints extension
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-ca-status" role="function">
<title>gnutls_x509_crt_get_ca_status ()</title>
<indexterm zone="gnutls-x509-crt-get-ca-status"><primary>gnutls_x509_crt_get_ca_status</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_ca_status       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return certificates CA status, by reading the
basicConstraints X.509 extension (2.5.29.19). If the certificate is
a CA a positive value will be returned, or (0) if the certificate
does not have CA flag set.
</para>
<para>
Use <link linkend="gnutls-x509-crt-get-basic-constraints"><function>gnutls_x509_crt_get_basic_constraints()</function></link> if you want to read the
pathLenConstraint field too.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A negative error code may be returned in case of parsing error.
If the certificate does not contain the basicConstraints extension
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-crl-dist-points" role="function">
<title>gnutls_x509_crt_get_crl_dist_points ()</title>
<indexterm zone="gnutls-x509-crt-get-crl-dist-points"><primary>gnutls_x509_crt_get_crl_dist_points</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_crl_dist_points (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *reason_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function retrieves the CRL distribution points (2.5.29.31),
contained in the given certificate in the X509v3 Certificate
Extensions.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the distribution point (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret</parameter>&#160;:</term>
<listitem><simpara>is the place where the distribution point will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>reason_flags</parameter>&#160;:</term>
<listitem><simpara>Revocation reasons. An ORed sequence of flags from <link linkend="gnutls-x509-crl-reason-flags-t"><literal>gnutls_x509_crl_reason_flags_t</literal></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> and updates <parameter>ret_size</parameter> if
<parameter>ret_size</parameter> is not enough to hold the distribution point, or the
type of the distribution point if everything was ok. The type is
one of the enumerated <link linkend="gnutls-x509-subject-alt-name-t"><literal>gnutls_x509_subject_alt_name_t</literal></link>.  If the
certificate does not have an Alternative name with the specified
sequence number then <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is
returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-dn" role="function">
<title>gnutls_x509_crt_get_dn ()</title>
<indexterm zone="gnutls-x509-crt-get-dn"><primary>gnutls_x509_crt_get_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_dn              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will copy the name of the Certificate in the provided
buffer. The name will be in the form "C=xxxx,O=yyyy,CN=zzzz" as
described in RFC4514. The output string will be ASCII or UTF-8
encoded, depending on the certificate data.
</para>
<para>
If <parameter>buf</parameter> is null then only the size will be filled.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is not
long enough, and in that case the <parameter>buf_size</parameter> will be updated
with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-dn-by-oid" role="function">
<title>gnutls_x509_crt_get_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-dn-by-oid"><primary>gnutls_x509_crt_get_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_dn_by_oid       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will extract the part of the name of the Certificate
subject specified by the given OID. The output, if the raw flag is
not used, will be encoded as described in RFC4514. Thus a string
that is ASCII or UTF-8 encoded, depending on the certificate data.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is (0), this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC4514 --
in hex format with a '#' prefix.  You can check about known OIDs
using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>.
</para>
<para>
If <parameter>buf</parameter> is null then only the size will be filled. If the <parameter>raw_flag</parameter>
is not specified the output is always null terminated, although the
<parameter>buf_size</parameter> will not include the null character.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the RDN, this specifies which to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>If non-zero returns the raw DER data of the DN part.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer where the DN part will be copied (may be null).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is not
long enough, and in that case the <parameter>buf_size</parameter> will be updated with
the required size. <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> if there
are no data in the current index. On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-dn-oid" role="function">
<title>gnutls_x509_crt_get_dn_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-dn-oid"><primary>gnutls_x509_crt_get_dn_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_dn_oid          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);</programlisting>
<para>
This function will extract the OIDs of the name of the Certificate
subject specified by the given index.
</para>
<para>
If <parameter>oid</parameter> is null then only the size will be filled. The <parameter>oid</parameter>
returned will be null terminated, although <parameter>oid_size</parameter> will not
account for the trailing null.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>This specifies which OID to return. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a buffer to hold the OID (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is not
long enough, and in that case the <parameter>buf_size</parameter> will be updated with
the required size. <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> if there
are no data in the current index. On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-expiration-time" role="function">
<title>gnutls_x509_crt_get_expiration_time ()</title>
<indexterm zone="gnutls-x509-crt-get-expiration-time"><primary>gnutls_x509_crt_get_expiration_time</primary></indexterm>
<programlisting><link linkend="time-t"><returnvalue>time_t</returnvalue></link>              gnutls_x509_crt_get_expiration_time (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);</programlisting>
<para>
This function will return the time this Certificate was or will be
expired.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>expiration time, or (time_t)-1 on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-extension-by-oid" role="function">
<title>gnutls_x509_crt_get_extension_by_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-extension-by-oid"><primary>gnutls_x509_crt_get_extension_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_extension_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the extension specified by the OID in the
certificate.  The extensions will be returned as binary data DER
encoded, in the provided buffer.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the extensions, this specifies which to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned,
otherwise a negative error code is returned. If the certificate does not
contain the specified extension
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-extension-data" role="function">
<title>gnutls_x509_crt_get_extension_data ()</title>
<indexterm zone="gnutls-x509-crt-get-extension-data"><primary>gnutls_x509_crt_get_extension_data</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_extension_data  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_data</parameter>);</programlisting>
<para>
This function will return the requested extension data in the
certificate.  The extension data will be stored as a string in the
provided buffer.
</para>
<para>
Use <link linkend="gnutls-x509-crt-get-extension-info"><function>gnutls_x509_crt_get_extension_info()</function></link> to extract the OID and
critical flag.  Use <link linkend="gnutls-x509-crt-get-extension-by-oid"><function>gnutls_x509_crt_get_extension_by_oid()</function></link> instead,
if you want to get data indexed by the extension OID rather than
sequence.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the data (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_data</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned,
otherwise a negative error code is returned.  If you have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-extension-info" role="function">
<title>gnutls_x509_crt_get_extension_info ()</title>
<indexterm zone="gnutls-x509-crt-get-extension-info"><primary>gnutls_x509_crt_get_extension_info</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_extension_info  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the requested extension OID in the
certificate, and the critical flag for it.  The extension OID will
be stored as a string in the provided buffer.  Use
<link linkend="gnutls-x509-crt-get-extension-data"><function>gnutls_x509_crt_get_extension_data()</function></link> to extract the data.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
<parameter>oid_size</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will be
returned. The <parameter>oid</parameter> returned will be null terminated, although 
<parameter>oid_size</parameter> will not account for the trailing null.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the maximum size of <parameter>oid</parameter>, on return
holds actual size of <parameter>oid</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>output variable with critical flag, may be NULL.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned,
otherwise a negative error code is returned.  If you have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-extension-oid" role="function">
<title>gnutls_x509_crt_get_extension_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-extension-oid"><primary>gnutls_x509_crt_get_extension_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_extension_oid   (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);</programlisting>
<para>
This function will return the requested extension OID in the certificate.
The extension OID will be stored as a string in the provided buffer.
</para>
<para>
The <parameter>oid</parameter> returned will be null terminated, although <parameter>oid_size</parameter> will not
account for the trailing null.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Specifies which extension OID to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the OID (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned,
otherwise a negative error code is returned.  If you have reached the
last extension available <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
will be returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-fingerprint" role="function">
<title>gnutls_x509_crt_get_fingerprint ()</title>
<indexterm zone="gnutls-x509-crt-get-fingerprint"><primary>gnutls_x509_crt_get_fingerprint</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_fingerprint     (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> algo</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will calculate and copy the certificate's fingerprint
in the provided buffer.
</para>
<para>
If the buffer is null then only the size will be filled.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>algo</parameter>&#160;:</term>
<listitem><simpara>is a digest algorithm</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the fingerprint (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the *buf_size will be updated
with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer" role="function">
<title>gnutls_x509_crt_get_issuer ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer"><primary>gnutls_x509_crt_get_issuer</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> *dn</parameter>);</programlisting>
<para>
Return the Certificate's Issuer DN as a <link linkend="gnutls-x509-dn-t"><literal>gnutls_x509_dn_t</literal></link> data type,
that can be decoded using <link linkend="gnutls-x509-dn-get-rdn-ava"><function>gnutls_x509_dn_get_rdn_ava()</function></link>. 
</para>
<para>
Note that <parameter>dn</parameter> should be treated as constant. Because it points 
into the <parameter>cert</parameter> object, you should not use <parameter>dn</parameter> after <parameter>cert</parameter> is
deallocated.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>output variable with pointer to uint8_t DN</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>Returns 0 on success, or an error code.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-alt-name" role="function" condition="since:2.10.0">
<title>gnutls_x509_crt_get_issuer_alt_name ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-alt-name" role="2.10.0"><primary>gnutls_x509_crt_get_issuer_alt_name</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_alt_name (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ian</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ian_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function retrieves the Issuer Alternative Name (2.5.29.18),
contained in the given certificate in the X509v3 Certificate
Extensions.
</para>
<para>
When the SAN type is otherName, it will extract the data in the
otherName's value field, and <link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link> is returned.
You may use <link linkend="gnutls-x509-crt-get-subject-alt-othername-oid"><function>gnutls_x509_crt_get_subject_alt_othername_oid()</function></link> to get
the corresponding OID and the "virtual" SAN types (e.g.,
<link linkend="GNUTLS-SAN-OTHERNAME-XMPP:CAPS"><literal>GNUTLS_SAN_OTHERNAME_XMPP</literal></link>).
</para>
<para>
If an otherName OID is known, the data will be decoded.  Otherwise
the returned data will be DER encoded, and you will have to decode
it yourself.  Currently, only the RFC 3920 id-on-xmppAddr Issuer
AltName is recognized.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ian</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ian_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ian.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative issuer name type on success, one of the
enumerated <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link>.  It will return
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if <parameter>ian_size</parameter> is not large enough
to hold the value.  In that case <parameter>ian_size</parameter> will be updated with
the required size.  If the certificate does not have an
Alternative name with the specified sequence number then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.10.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-alt-name2" role="function" condition="since:2.10.0">
<title>gnutls_x509_crt_get_issuer_alt_name2 ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-alt-name2" role="2.10.0"><primary>gnutls_x509_crt_get_issuer_alt_name2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_alt_name2
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ian</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ian_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *ian_type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the alternative names, contained in the
given certificate. It is the same as
<link linkend="gnutls-x509-crt-get-issuer-alt-name"><function>gnutls_x509_crt_get_issuer_alt_name()</function></link> except for the fact that it
will return the type of the alternative name in <parameter>ian_type</parameter> even if
the function fails for some reason (i.e.  the buffer provided is
not enough).
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ian</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ian_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ian_type</parameter>&#160;:</term>
<listitem><simpara>holds the type of the alternative name (one of gnutls_x509_subject_alt_name_t).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative issuer name type on success, one of the
enumerated <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link>.  It will return
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if <parameter>ian_size</parameter> is not large enough
to hold the value.  In that case <parameter>ian_size</parameter> will be updated with
the required size.  If the certificate does not have an
Alternative name with the specified sequence number then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.10.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-alt-othername-oid" role="function" condition="since:2.10.0">
<title>gnutls_x509_crt_get_issuer_alt_othername_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-alt-othername-oid" role="2.10.0"><primary>gnutls_x509_crt_get_issuer_alt_othername_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_alt_othername_oid
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>);</programlisting>
<para>
This function will extract the type OID of an otherName Subject
Alternative Name, contained in the given certificate, and return
the type as an enumerated element.
</para>
<para>
If <parameter>oid</parameter> is null then only the size will be filled. The <parameter>oid</parameter>
returned will be null terminated, although <parameter>oid_size</parameter> will not
account for the trailing null.
</para>
<para>
This function is only useful if
<link linkend="gnutls-x509-crt-get-issuer-alt-name"><function>gnutls_x509_crt_get_issuer_alt_name()</function></link> returned
<link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret</parameter>&#160;:</term>
<listitem><simpara>is the place where the otherName OID will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative issuer name type on success, one of the
enumerated gnutls_x509_subject_alt_name_t.  For supported OIDs, it
will return one of the virtual (GNUTLS_SAN_OTHERNAME_*) types,
e.g. <link linkend="GNUTLS-SAN-OTHERNAME-XMPP:CAPS"><literal>GNUTLS_SAN_OTHERNAME_XMPP</literal></link>, and <link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link> for
unknown OIDs.  It will return <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if
<parameter>ret_size</parameter> is not large enough to hold the value.  In that case
<parameter>ret_size</parameter> will be updated with the required size.  If the
certificate does not have an Alternative name with the specified
sequence number and with the otherName type then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.10.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-dn" role="function">
<title>gnutls_x509_crt_get_issuer_dn ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-dn"><primary>gnutls_x509_crt_get_issuer_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_dn       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will copy the name of the Certificate issuer in the
provided buffer. The name will be in the form
"C=xxxx,O=yyyy,CN=zzzz" as described in RFC4514. The output string
will be ASCII or UTF-8 encoded, depending on the certificate data.
</para>
<para>
If <parameter>buf</parameter> is null then only the size will be filled.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the <parameter>buf_size</parameter> will be updated with
the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-dn-by-oid" role="function">
<title>gnutls_x509_crt_get_issuer_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-dn-by-oid"><primary>gnutls_x509_crt_get_issuer_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_dn_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will extract the part of the name of the Certificate
issuer specified by the given OID. The output, if the raw flag is not
used, will be encoded as described in RFC4514. Thus a string that is
ASCII or UTF-8 encoded, depending on the certificate data.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is (0), this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC4514 --
in hex format with a '#' prefix.  You can check about known OIDs
using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>.
</para>
<para>
If <parameter>buf</parameter> is null then only the size will be filled. If the <parameter>raw_flag</parameter>
is not specified the output is always null terminated, although the
<parameter>buf_size</parameter> will not include the null character.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the RDN, this specifies which to send. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>If non-zero returns the raw DER data of the DN part.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the name (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is not
long enough, and in that case the <parameter>buf_size</parameter> will be updated with
the required size. <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> if there
are no data in the current index. On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-dn-oid" role="function">
<title>gnutls_x509_crt_get_issuer_dn_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-dn-oid"><primary>gnutls_x509_crt_get_issuer_dn_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_dn_oid   (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);</programlisting>
<para>
This function will extract the OIDs of the name of the Certificate
issuer specified by the given index.
</para>
<para>
If <parameter>oid</parameter> is null then only the size will be filled. The <parameter>oid</parameter>
returned will be null terminated, although <parameter>oid_size</parameter> will not
account for the trailing null.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>This specifies which OID to return. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a buffer to hold the OID (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is not
long enough, and in that case the <parameter>buf_size</parameter> will be updated with
the required size. <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> if there
are no data in the current index. On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-issuer-unique-id" role="function" condition="since:2.12.0">
<title>gnutls_x509_crt_get_issuer_unique_id ()</title>
<indexterm zone="gnutls-x509-crt-get-issuer-unique-id" role="2.12.0"><primary>gnutls_x509_crt_get_issuer_unique_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_issuer_unique_id
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will extract the issuerUniqueID value (if present) for
the given certificate.
</para>
<para>
If the user allocated memory buffer is not large enough to hold the
full subjectUniqueID, then a GNUTLS_E_SHORT_MEMORY_BUFFER error will be
returned, and buf_size will be set to the actual length.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>user allocated memory buffer, will hold the unique id</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>size of user allocated memory buffer (on input), will hold
actual size of the unique ID on return.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> on success, otherwise a negative error code.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.12.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-key-id" role="function">
<title>gnutls_x509_crt_get_key_id ()</title>
<indexterm zone="gnutls-x509-crt-get-key-id"><primary>gnutls_x509_crt_get_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_key_id          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will return a unique ID that depends on the public
key parameters. This ID can be used in checking whether a
certificate corresponds to the given private key.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.  The output will normally be a SHA-1 hash output,
which is 20 bytes.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>should be 0 for now</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain the key ID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of failure a negative error code will be
returned, and 0 on success.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-key-purpose-oid" role="function">
<title>gnutls_x509_crt_get_key_purpose_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-key-purpose-oid"><primary>gnutls_x509_crt_get_key_purpose_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_key_purpose_oid (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will extract the key purpose OIDs of the Certificate
specified by the given index.  These are stored in the Extended Key
Usage extension (2.5.29.37) See the GNUTLS_KP_* definitions for
human readable names.
</para>
<para>
If <parameter>oid</parameter> is null then only the size will be filled. The <parameter>oid</parameter>
returned will be null terminated, although <parameter>oid_size</parameter> will not
account for the trailing null.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>This specifies which OID to return. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a buffer to hold the OID (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid_size</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>oid</parameter></simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>output flag to indicate criticality of extension</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if the provided buffer is
not long enough, and in that case the *oid_size will be updated
with the required size.  On success 0 is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-key-usage" role="function">
<title>gnutls_x509_crt_get_key_usage ()</title>
<indexterm zone="gnutls-x509-crt-get-key-usage"><primary>gnutls_x509_crt_get_key_usage</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_key_usage       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *key_usage</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return certificate's key usage, by reading the
keyUsage X.509 extension (2.5.29.15). The key usage value will ORed
values of the: <link linkend="GNUTLS-KEY-DIGITAL-SIGNATURE:CAPS"><literal>GNUTLS_KEY_DIGITAL_SIGNATURE</literal></link>,
<link linkend="GNUTLS-KEY-NON-REPUDIATION:CAPS"><literal>GNUTLS_KEY_NON_REPUDIATION</literal></link>, <link linkend="GNUTLS-KEY-KEY-ENCIPHERMENT:CAPS"><literal>GNUTLS_KEY_KEY_ENCIPHERMENT</literal></link>,
<link linkend="GNUTLS-KEY-DATA-ENCIPHERMENT:CAPS"><literal>GNUTLS_KEY_DATA_ENCIPHERMENT</literal></link>, <link linkend="GNUTLS-KEY-KEY-AGREEMENT:CAPS"><literal>GNUTLS_KEY_KEY_AGREEMENT</literal></link>,
<link linkend="GNUTLS-KEY-KEY-CERT-SIGN:CAPS"><literal>GNUTLS_KEY_KEY_CERT_SIGN</literal></link>, <link linkend="GNUTLS-KEY-CRL-SIGN:CAPS"><literal>GNUTLS_KEY_CRL_SIGN</literal></link>,
<link linkend="GNUTLS-KEY-ENCIPHER-ONLY:CAPS"><literal>GNUTLS_KEY_ENCIPHER_ONLY</literal></link>, <link linkend="GNUTLS-KEY-DECIPHER-ONLY:CAPS"><literal>GNUTLS_KEY_DECIPHER_ONLY</literal></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>key_usage</parameter>&#160;:</term>
<listitem><simpara>where the key usage bits will be stored</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the certificate key usage, or a negative error code in case of
parsing error.  If the certificate does not contain the keyUsage
extension <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> will be
returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-pk-algorithm" role="function">
<title>gnutls_x509_crt_get_pk_algorithm ()</title>
<indexterm zone="gnutls-x509-crt-get-pk-algorithm"><primary>gnutls_x509_crt_get_pk_algorithm</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_pk_algorithm    (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *bits</parameter>);</programlisting>
<para>
This function will return the public key algorithm of an X.509
certificate.
</para>
<para>
If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus.
For DSA the bits returned are of the public
exponent.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>bits</parameter>&#160;:</term>
<listitem><simpara>if bits is non null it will hold the size of the parameters' in bits</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>a member of the <link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link> enumeration on
success, or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-pk-dsa-raw" role="function">
<title>gnutls_x509_crt_get_pk_dsa_raw ()</title>
<indexterm zone="gnutls-x509-crt-get-pk-dsa-raw"><primary>gnutls_x509_crt_get_pk_dsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_pk_dsa_raw      (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *g</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>);</programlisting>
<para>
This function will export the DSA public key's parameters found in
the given certificate.  The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>will hold the p</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>will hold the q</simpara></listitem></varlistentry>
<varlistentry><term><parameter>g</parameter>&#160;:</term>
<listitem><simpara>will hold the g</simpara></listitem></varlistentry>
<varlistentry><term><parameter>y</parameter>&#160;:</term>
<listitem><simpara>will hold the y</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> on success, otherwise a negative error code.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-pk-rsa-raw" role="function">
<title>gnutls_x509_crt_get_pk_rsa_raw ()</title>
<indexterm zone="gnutls-x509-crt-get-pk-rsa-raw"><primary>gnutls_x509_crt_get_pk_rsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_pk_rsa_raw      (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>);</programlisting>
<para>
This function will export the RSA public key's parameters found in
the given structure.  The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>will hold the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>will hold the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> on success, otherwise a negative error code.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-policy" role="function" condition="since:3.1.5">
<title>gnutls_x509_crt_get_policy ()</title>
<indexterm zone="gnutls-x509-crt-get-policy" role="3.1.5"><primary>gnutls_x509_crt_get_policy</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_policy          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><type>struct gnutls_x509_policy_st</type> *policy</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will extract the certificate policy (extension 2.5.29.32) 
specified by the given index. 
</para>
<para>
The policy returned by this function must be deinitialized by using
<link linkend="gnutls-x509-policy-release"><function>gnutls_x509_policy_release()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>This specifies which policy to return. Use (0) to get the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>policy</parameter>&#160;:</term>
<listitem><simpara>A pointer to a policy structure.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
if the extension is not present, otherwise a negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1.5</para></refsect2>
<refsect2 id="gnutls-x509-crt-get-private-key-usage-period" role="function">
<title>gnutls_x509_crt_get_private_key_usage_period ()</title>
<indexterm zone="gnutls-x509-crt-get-private-key-usage-period"><primary>gnutls_x509_crt_get_private_key_usage_period</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_private_key_usage_period
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> *expiration</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the expiration and activation
times of the private key of the certificate. It relies on
the PKIX extension 2.5.29.16 being present.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>activation</parameter>&#160;:</term>
<listitem><simpara>The activation time</simpara></listitem></varlistentry>
<varlistentry><term><parameter>expiration</parameter>&#160;:</term>
<listitem><simpara>The expiration time</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>the extension status</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
if the extension is not present, otherwise a negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-proxy" role="function">
<title>gnutls_x509_crt_get_proxy ()</title>
<indexterm zone="gnutls-x509-crt-get-proxy"><primary>gnutls_x509_crt_get_proxy</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_proxy           (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> *pathlen</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> **policyLanguage</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> **policy</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_policy</parameter>);</programlisting>
<para>
This function will get information from a proxy certificate.  It
reads the ProxyCertInfo X.509 extension (1.3.6.1.5.5.7.1.14).
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pathlen</parameter>&#160;:</term>
<listitem><simpara>pointer to output integer indicating path length (may be
NULL), non-negative error codes indicate a present pCPathLenConstraint
field and the actual value, -1 indicate that the field is absent.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>policyLanguage</parameter>&#160;:</term>
<listitem><simpara>output variable with OID of policy language</simpara></listitem></varlistentry>
<varlistentry><term><parameter>policy</parameter>&#160;:</term>
<listitem><simpara>output variable with policy data</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_policy</parameter>&#160;:</term>
<listitem><simpara>output variable size of policy data</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned,
otherwise a negative error code is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-raw-dn" role="function">
<title>gnutls_x509_crt_get_raw_dn ()</title>
<indexterm zone="gnutls-x509-crt-get-raw-dn"><primary>gnutls_x509_crt_get_raw_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_raw_dn          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *start</parameter>);</programlisting>
<para>
This function will return a pointer to the DER encoded DN structure and
the length. This points to allocated data that must be free'd using <link linkend="gnutls-free"><function>gnutls_free()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>start</parameter>&#160;:</term>
<listitem><simpara>will hold the starting point of the DN</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value. or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-raw-issuer-dn" role="function">
<title>gnutls_x509_crt_get_raw_issuer_dn ()</title>
<indexterm zone="gnutls-x509-crt-get-raw-issuer-dn"><primary>gnutls_x509_crt_get_raw_issuer_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_raw_issuer_dn   (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *start</parameter>);</programlisting>
<para>
This function will return a pointer to the DER encoded DN structure
and the length. This points to allocated data that must be free'd using <link linkend="gnutls-free"><function>gnutls_free()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>start</parameter>&#160;:</term>
<listitem><simpara>will hold the starting point of the DN</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-serial" role="function">
<title>gnutls_x509_crt_get_serial ()</title>
<indexterm zone="gnutls-x509-crt-get-serial"><primary>gnutls_x509_crt_get_serial</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_serial          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *result</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *result_size</parameter>);</programlisting>
<para>
This function will return the X.509 certificate's serial number.
This is obtained by the X509 Certificate serialNumber field. Serial
is not always a 32 or 64bit number. Some CAs use large serial
numbers, thus it may be wise to handle it as something uint8_t.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>result</parameter>&#160;:</term>
<listitem><simpara>The place where the serial number will be copied</simpara></listitem></varlistentry>
<varlistentry><term><parameter>result_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the result field.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-signature" role="function">
<title>gnutls_x509_crt_get_signature ()</title>
<indexterm zone="gnutls-x509-crt-get-signature"><primary>gnutls_x509_crt_get_signature</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_signature       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *sig</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_sig</parameter>);</programlisting>
<para>
This function will extract the signature field of a certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sig</parameter>&#160;:</term>
<listitem><simpara>a pointer where the signature part will be copied (may be null).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_sig</parameter>&#160;:</term>
<listitem><simpara>initially holds the size of <parameter>sig</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value. and a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-signature-algorithm" role="function">
<title>gnutls_x509_crt_get_signature_algorithm ()</title>
<indexterm zone="gnutls-x509-crt-get-signature-algorithm"><primary>gnutls_x509_crt_get_signature_algorithm</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_signature_algorithm
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);</programlisting>
<para>
This function will return a value of the <link linkend="gnutls-sign-algorithm-t"><type>gnutls_sign_algorithm_t</type></link>
enumeration that is the signature algorithm that has been used to
sign this certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>a <link linkend="gnutls-sign-algorithm-t"><type>gnutls_sign_algorithm_t</type></link> value, or a negative error code on
error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-subject" role="function">
<title>gnutls_x509_crt_get_subject ()</title>
<indexterm zone="gnutls-x509-crt-get-subject"><primary>gnutls_x509_crt_get_subject</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_subject         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> *dn</parameter>);</programlisting>
<para>
Return the Certificate's Subject DN as a <link linkend="gnutls-x509-dn-t"><literal>gnutls_x509_dn_t</literal></link> data type,
that can be decoded using <link linkend="gnutls-x509-dn-get-rdn-ava"><function>gnutls_x509_dn_get_rdn_ava()</function></link>. 
</para>
<para>
Note that <parameter>dn</parameter> should be treated as constant. Because it points 
into the <parameter>cert</parameter> object, you should not use <parameter>dn</parameter> after <parameter>cert</parameter> is
deallocated.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>output variable with pointer to uint8_t DN.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>Returns 0 on success, or an error code.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-subject-alt-name" role="function">
<title>gnutls_x509_crt_get_subject_alt_name ()</title>
<indexterm zone="gnutls-x509-crt-get-subject-alt-name"><primary>gnutls_x509_crt_get_subject_alt_name</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_subject_alt_name
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *san</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *san_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function retrieves the Alternative Name (2.5.29.17), contained
in the given certificate in the X509v3 Certificate Extensions.
</para>
<para>
When the SAN type is otherName, it will extract the data in the
otherName's value field, and <link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link> is returned.
You may use <link linkend="gnutls-x509-crt-get-subject-alt-othername-oid"><function>gnutls_x509_crt_get_subject_alt_othername_oid()</function></link> to get
the corresponding OID and the "virtual" SAN types (e.g.,
<link linkend="GNUTLS-SAN-OTHERNAME-XMPP:CAPS"><literal>GNUTLS_SAN_OTHERNAME_XMPP</literal></link>).
</para>
<para>
If an otherName OID is known, the data will be decoded.  Otherwise
the returned data will be DER encoded, and you will have to decode
it yourself.  Currently, only the RFC 3920 id-on-xmppAddr SAN is
recognized.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>san</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>san_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of san.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative subject name type on success, one of the
enumerated <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link>.  It will return
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if <parameter>san_size</parameter> is not large enough to
hold the value.  In that case <parameter>san_size</parameter> will be updated with the
required size.  If the certificate does not have an Alternative
name with the specified sequence number then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-subject-alt-name2" role="function">
<title>gnutls_x509_crt_get_subject_alt_name2 ()</title>
<indexterm zone="gnutls-x509-crt-get-subject-alt-name2"><primary>gnutls_x509_crt_get_subject_alt_name2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_subject_alt_name2
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *san</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *san_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *san_type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the alternative names, contained in the
given certificate. It is the same as
<link linkend="gnutls-x509-crt-get-subject-alt-name"><function>gnutls_x509_crt_get_subject_alt_name()</function></link> except for the fact that it
will return the type of the alternative name in <parameter>san_type</parameter> even if
the function fails for some reason (i.e.  the buffer provided is
not enough).
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>san</parameter>&#160;:</term>
<listitem><simpara>is the place where the alternative name will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>san_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>san_type</parameter>&#160;:</term>
<listitem><simpara>holds the type of the alternative name (one of gnutls_x509_subject_alt_name_t).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative subject name type on success, one of the
enumerated <link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link>.  It will return
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if <parameter>san_size</parameter> is not large enough
to hold the value.  In that case <parameter>san_size</parameter> will be updated with
the required size.  If the certificate does not have an
Alternative name with the specified sequence number then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-subject-alt-othername-oid" role="function">
<title>gnutls_x509_crt_get_subject_alt_othername_oid ()</title>
<indexterm zone="gnutls-x509-crt-get-subject-alt-othername-oid"><primary>gnutls_x509_crt_get_subject_alt_othername_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_subject_alt_othername_oid
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> seq</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *oid_size</parameter>);</programlisting>
<para>
This function will extract the type OID of an otherName Subject
Alternative Name, contained in the given certificate, and return
the type as an enumerated element.
</para>
<para>
This function is only useful if
<link linkend="gnutls-x509-crt-get-subject-alt-name"><function>gnutls_x509_crt_get_subject_alt_name()</function></link> returned
<link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link>.
</para>
<para>
If <parameter>oid</parameter> is null then only the size will be filled. The <parameter>oid</parameter>
returned will be null terminated, although <parameter>oid_size</parameter> will not
account for the trailing null.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>seq</parameter>&#160;:</term>
<listitem><simpara>specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>is the place where the otherName OID will be copied to</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of ret.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the alternative subject name type on success, one of the
enumerated gnutls_x509_subject_alt_name_t.  For supported OIDs, it
will return one of the virtual (GNUTLS_SAN_OTHERNAME_*) types,
e.g. <link linkend="GNUTLS-SAN-OTHERNAME-XMPP:CAPS"><literal>GNUTLS_SAN_OTHERNAME_XMPP</literal></link>, and <link linkend="GNUTLS-SAN-OTHERNAME:CAPS"><literal>GNUTLS_SAN_OTHERNAME</literal></link> for
unknown OIDs.  It will return <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> if
<parameter>ian_size</parameter> is not large enough to hold the value.  In that case
<parameter>ian_size</parameter> will be updated with the required size.  If the
certificate does not have an Alternative name with the specified
sequence number and with the otherName type then
<link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-subject-key-id" role="function">
<title>gnutls_x509_crt_get_subject_key_id ()</title>
<indexterm zone="gnutls-x509-crt-get-subject-key-id"><primary>gnutls_x509_crt_get_subject_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_subject_key_id  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *ret</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *ret_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *critical</parameter>);</programlisting>
<para>
This function will return the X.509v3 certificate's subject key
identifier.  This is obtained by the X.509 Subject Key identifier
extension field (2.5.29.14).
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret</parameter>&#160;:</term>
<listitem><simpara>The place where the identifier will be copied</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ret_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the result field.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>will be non-zero if the extension is marked as critical (may be null)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, <link linkend="GNUTLS-E-REQUESTED-DATA-NOT-AVAILABLE:CAPS"><literal>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</literal></link>
if the extension is not present, otherwise a negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-subject-unique-id" role="function">
<title>gnutls_x509_crt_get_subject_unique_id ()</title>
<indexterm zone="gnutls-x509-crt-get-subject-unique-id"><primary>gnutls_x509_crt_get_subject_unique_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_subject_unique_id
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *buf_size</parameter>);</programlisting>
<para>
This function will extract the subjectUniqueID value (if present) for
the given certificate.
</para>
<para>
If the user allocated memory buffer is not large enough to hold the
full subjectUniqueID, then a GNUTLS_E_SHORT_MEMORY_BUFFER error will be
returned, and buf_size will be set to the actual length.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>user allocated memory buffer, will hold the unique id</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf_size</parameter>&#160;:</term>
<listitem><simpara>size of user allocated memory buffer (on input), will hold
actual size of the unique ID on return.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara><link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> on success, otherwise a negative error code.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-get-version" role="function">
<title>gnutls_x509_crt_get_version ()</title>
<indexterm zone="gnutls-x509-crt-get-version"><primary>gnutls_x509_crt_get_version</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_get_version         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>);</programlisting>
<para>
This function will return the version of the specified Certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>version of certificate, or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-import" role="function">
<title>gnutls_x509_crt_import ()</title>
<indexterm zone="gnutls-x509-crt-import"><primary>gnutls_x509_crt_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_import              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);</programlisting>
<para>
This function will convert the given DER or PEM encoded Certificate
to the native gnutls_x509_crt_t format. The output will be stored
in <parameter>cert</parameter>.
</para>
<para>
If the Certificate is PEM encoded it should have a header of "X509
CERTIFICATE", or "CERTIFICATE".
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed certificate.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded certificate.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-init" role="function">
<title>gnutls_x509_crt_init ()</title>
<indexterm zone="gnutls-x509-crt-init"><primary>gnutls_x509_crt_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_init                (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *cert</parameter>);</programlisting>
<para>
This function will initialize an X.509 certificate structure.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-list-import" role="function">
<title>gnutls_x509_crt_list_import ()</title>
<indexterm zone="gnutls-x509-crt-list-import"><primary>gnutls_x509_crt_list_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_list_import         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *certs</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *cert_max</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will convert the given PEM encoded certificate list
to the native gnutls_x509_crt_t format. The output will be stored
in <parameter>certs</parameter>.  They will be automatically initialized.
</para>
<para>
The flag <link linkend="GNUTLS-X509-CRT-LIST-IMPORT-FAIL-IF-EXCEED:CAPS"><literal>GNUTLS_X509_CRT_LIST_IMPORT_FAIL_IF_EXCEED</literal></link> will cause
import to fail if the certificates in the provided buffer are more
than the available structures. The <link linkend="GNUTLS-X509-CRT-LIST-FAIL-IF-UNSORTED:CAPS"><literal>GNUTLS_X509_CRT_LIST_FAIL_IF_UNSORTED</literal></link>
flag will cause the function to fail if the provided list is not
sorted from subject to issuer.
</para>
<para>
If the Certificate is PEM encoded it should have a header of "X509
CERTIFICATE", or "CERTIFICATE".
</para><variablelist role="params">
<varlistentry><term><parameter>certs</parameter>&#160;:</term>
<listitem><simpara>The structures to store the parsed certificate. Must not be initialized.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert_max</parameter>&#160;:</term>
<listitem><simpara>Initially must hold the maximum number of certs. It will be updated with the number of certs available.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The PEM encoded certificate.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be (0) or an OR'd sequence of gnutls_certificate_import_flags.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the number of certificates read or a negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-list-import2" role="function" condition="since:3.0">
<title>gnutls_x509_crt_list_import2 ()</title>
<indexterm zone="gnutls-x509-crt-list-import2" role="3.0"><primary>gnutls_x509_crt_list_import2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_list_import2        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> **certs</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *size</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will convert the given PEM encoded certificate list
to the native gnutls_x509_crt_t format. The output will be stored
in <parameter>certs</parameter> which will be initialized.
</para>
<para>
If the Certificate is PEM encoded it should have a header of "X509
CERTIFICATE", or "CERTIFICATE".
</para><variablelist role="params">
<varlistentry><term><parameter>certs</parameter>&#160;:</term>
<listitem><simpara>The structures to store the parsed certificate. Must not be initialized.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>size</parameter>&#160;:</term>
<listitem><simpara>It will contain the size of the list.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The PEM encoded certificate.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be (0) or an OR'd sequence of gnutls_certificate_import_flags.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>the number of certificates read or a negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-list-verify" role="function">
<title>gnutls_x509_crt_list_verify ()</title>
<indexterm zone="gnutls-x509-crt-list-verify"><primary>gnutls_x509_crt_list_verify</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_list_verify         (<parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *cert_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> cert_list_length</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *CA_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CA_list_length</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *CRL_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CRL_list_length</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>);</programlisting>
<para>
This function will try to verify the given certificate list and
return its status.  If no flags are specified (0), this function
will use the basicConstraints (2.5.29.19) PKIX extension. This
means that only a certificate authority is allowed to sign a
certificate.
</para>
<para>
You must also check the peer's name in order to check if the verified
certificate belongs to the actual peer.
</para>
<para>
The certificate verification output will be put in <parameter>verify</parameter> and will
be one or more of the gnutls_certificate_status_t enumerated
elements bitwise or'd.  For a more detailed verification status use
<link linkend="gnutls-x509-crt-verify"><function>gnutls_x509_crt_verify()</function></link> per list element.
</para><variablelist role="params">
<varlistentry><term><parameter>cert_list</parameter>&#160;:</term>
<listitem><simpara>is the certificate list to be verified</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert_list_length</parameter>&#160;:</term>
<listitem><simpara>holds the number of certificate in cert_list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CA_list</parameter>&#160;:</term>
<listitem><simpara>is the CA list which will be used in verification</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CA_list_length</parameter>&#160;:</term>
<listitem><simpara>holds the number of CA certificate in CA_list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CRL_list</parameter>&#160;:</term>
<listitem><simpara>holds a list of CRLs.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CRL_list_length</parameter>&#160;:</term>
<listitem><simpara>the length of CRL list.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>verify</parameter>&#160;:</term>
<listitem><simpara>will hold the certificate verification output.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-print" role="function">
<title>gnutls_x509_crt_print ()</title>
<indexterm zone="gnutls-x509-crt-print"><primary>gnutls_x509_crt_print</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_print               (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-certificate-print-formats-t"><type>gnutls_certificate_print_formats_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will pretty print a X.509 certificate, suitable for
display to a human.
</para>
<para>
If the format is <link linkend="GNUTLS-CRT-PRINT-FULL:CAPS"><literal>GNUTLS_CRT_PRINT_FULL</literal></link> then all fields of the
certificate will be output, on multiple lines.  The
<link linkend="GNUTLS-CRT-PRINT-ONELINE:CAPS"><literal>GNUTLS_CRT_PRINT_ONELINE</literal></link> format will generate one line with some
selected fields, which is useful for logging purposes.
</para>
<para>
The output <parameter>out</parameter> needs to be deallocated using <link linkend="gnutls-free"><function>gnutls_free()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>The structure to be printed</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>Indicate the format to use</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>Newly allocated datum with (0) terminated string.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-activation-time" role="function">
<title>gnutls_x509_crt_set_activation_time ()</title>
<indexterm zone="gnutls-x509-crt-set-activation-time"><primary>gnutls_x509_crt_set_activation_time</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_activation_time (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> act_time</parameter>);</programlisting>
<para>
This function will set the time this Certificate was or will be
activated.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>act_time</parameter>&#160;:</term>
<listitem><simpara>The actual time</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-authority-info-access" role="function" condition="since:3.0">
<title>gnutls_x509_crt_set_authority_info_access ()</title>
<indexterm zone="gnutls-x509-crt-set-authority-info-access" role="3.0"><primary>gnutls_x509_crt_set_authority_info_access</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_authority_info_access
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> what</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>);</programlisting>
<para>
This function sets the Authority Information Access (AIA)
extension, see RFC 5280 section 4.2.2.1 for more information.  
</para>
<para>
The type of data stored in <parameter>data</parameter> is specified via <parameter>what</parameter> which
should be <link linkend="gnutls-info-access-what-t"><type>gnutls_info_access_what_t</type></link> values.
</para>
<para>
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-OCSP-URI:CAPS"><literal>GNUTLS_IA_OCSP_URI</literal></link>, <parameter>data</parameter> will hold the OCSP URI.
If <parameter>what</parameter> is <link linkend="GNUTLS-IA-CAISSUERS-URI:CAPS"><literal>GNUTLS_IA_CAISSUERS_URI</literal></link>, <parameter>data</parameter> will hold the caIssuers
URI.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>Holds the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>what</parameter>&#160;:</term>
<listitem><simpara>what data to get, a <link linkend="gnutls-info-access-what-t"><type>gnutls_info_access_what_t</type></link> type.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>output data to be freed with <link linkend="gnutls-free"><function>gnutls_free()</function></link>.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-set-authority-key-id" role="function">
<title>gnutls_x509_crt_set_authority_key_id ()</title>
<indexterm zone="gnutls-x509-crt-set-authority-key-id"><primary>gnutls_x509_crt_set_authority_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_authority_key_id
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> id_size</parameter>);</programlisting>
<para>
This function will set the X.509 certificate's authority key ID extension.
Only the keyIdentifier field can be set with this function.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>id</parameter>&#160;:</term>
<listitem><simpara>The key ID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-basic-constraints" role="function">
<title>gnutls_x509_crt_set_basic_constraints ()</title>
<indexterm zone="gnutls-x509-crt-set-basic-constraints"><primary>gnutls_x509_crt_set_basic_constraints</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_basic_constraints
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> ca</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> pathLenConstraint</parameter>);</programlisting>
<para>
This function will set the basicConstraints certificate extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>ca</parameter>&#160;:</term>
<listitem><simpara>true(1) or false(0). Depending on the Certificate authority status.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>pathLenConstraint</parameter>&#160;:</term>
<listitem><simpara>non-negative error codes indicate maximum length of path,
and negative error codes indicate that the pathLenConstraints field should
not be present.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-ca-status" role="function">
<title>gnutls_x509_crt_set_ca_status ()</title>
<indexterm zone="gnutls-x509-crt-set-ca-status"><primary>gnutls_x509_crt_set_ca_status</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_ca_status       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> ca</parameter>);</programlisting>
<para>
This function will set the basicConstraints certificate extension.
Use <link linkend="gnutls-x509-crt-set-basic-constraints"><function>gnutls_x509_crt_set_basic_constraints()</function></link> if you want to control
the pathLenConstraint field too.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>ca</parameter>&#160;:</term>
<listitem><simpara>true(1) or false(0). Depending on the Certificate authority status.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-crl-dist-points" role="function">
<title>gnutls_x509_crt_set_crl_dist_points ()</title>
<indexterm zone="gnutls-x509-crt-set-crl-dist-points"><primary>gnutls_x509_crt_set_crl_dist_points</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_crl_dist_points (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data_string</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> reason_flags</parameter>);</programlisting>
<para>
This function will set the CRL distribution points certificate extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>is one of the gnutls_x509_subject_alt_name_t enumerations</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data_string</parameter>&#160;:</term>
<listitem><simpara>The data to be set</simpara></listitem></varlistentry>
<varlistentry><term><parameter>reason_flags</parameter>&#160;:</term>
<listitem><simpara>revocation reasons</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-crl-dist-points2" role="function" condition="since:2.6.0">
<title>gnutls_x509_crt_set_crl_dist_points2 ()</title>
<indexterm zone="gnutls-x509-crt-set-crl-dist-points2" role="2.6.0"><primary>gnutls_x509_crt_set_crl_dist_points2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_crl_dist_points2
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> data_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> reason_flags</parameter>);</programlisting>
<para>
This function will set the CRL distribution points certificate extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>is one of the gnutls_x509_subject_alt_name_t enumerations</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The data to be set</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data_size</parameter>&#160;:</term>
<listitem><simpara>The data size</simpara></listitem></varlistentry>
<varlistentry><term><parameter>reason_flags</parameter>&#160;:</term>
<listitem><simpara>revocation reasons</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.6.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-set-crq" role="function">
<title>gnutls_x509_crt_set_crq ()</title>
<indexterm zone="gnutls-x509-crt-set-crq"><primary>gnutls_x509_crt_set_crq</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_crq             (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);</programlisting>
<para>
This function will set the name and public parameters as well as
the extensions from the given certificate request to the certificate. 
Only RSA keys are currently supported.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>holds a certificate request</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-crq-extensions" role="function" condition="since:2.8.0">
<title>gnutls_x509_crt_set_crq_extensions ()</title>
<indexterm zone="gnutls-x509-crt-set-crq-extensions" role="2.8.0"><primary>gnutls_x509_crt_set_crq_extensions</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_crq_extensions  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crq-t"><type>gnutls_x509_crq_t</type></link> crq</parameter>);</programlisting>
<para>
This function will set extensions from the given request to the
certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>crq</parameter>&#160;:</term>
<listitem><simpara>holds a certificate request</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.8.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-set-dn-by-oid" role="function">
<title>gnutls_x509_crt_set_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crt-set-dn-by-oid"><primary>gnutls_x509_crt_set_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_dn_by_oid       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_name</parameter>);</programlisting>
<para>
This function will set the part of the name of the Certificate
subject, specified by the given OID. The input string should be
ASCII or UTF-8 encoded.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
With this function you can only set the known OIDs. You can test
for known OIDs using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>. For OIDs that are
not known (by gnutls) you should properly DER encode your data,
and call this function with <parameter>raw_flag</parameter> set.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identifier in a null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>must be 0, or 1 if the data are DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name</parameter>&#160;:</term>
<listitem><simpara>a pointer to the name</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_name</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>name</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-expiration-time" role="function">
<title>gnutls_x509_crt_set_expiration_time ()</title>
<indexterm zone="gnutls-x509-crt-set-expiration-time"><primary>gnutls_x509_crt_set_expiration_time</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_expiration_time (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> exp_time</parameter>);</programlisting>
<para>
This function will set the time this Certificate will expire.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>exp_time</parameter>&#160;:</term>
<listitem><simpara>The actual time</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-extension-by-oid" role="function">
<title>gnutls_x509_crt_set_extension_by_oid ()</title>
<indexterm zone="gnutls-x509-crt-set-extension-by-oid"><primary>gnutls_x509_crt_set_extension_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_extension_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> sizeof_buf</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);</programlisting>
<para>
This function will set an the extension, by the specified OID, in
the certificate.  The extension data should be binary data DER
encoded.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identified in null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a DER encoded data</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>should be non-zero if the extension is to be marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-issuer-dn-by-oid" role="function">
<title>gnutls_x509_crt_set_issuer_dn_by_oid ()</title>
<indexterm zone="gnutls-x509-crt-set-issuer-dn-by-oid"><primary>gnutls_x509_crt_set_issuer_dn_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_issuer_dn_by_oid
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_name</parameter>);</programlisting>
<para>
This function will set the part of the name of the Certificate
issuer, specified by the given OID.  The input string should be
ASCII or UTF-8 encoded.
</para>
<para>
Some helper macros with popular OIDs can be found in gnutls/x509.h
With this function you can only set the known OIDs. You can test
for known OIDs using <link linkend="gnutls-x509-dn-oid-known"><function>gnutls_x509_dn_oid_known()</function></link>. For OIDs that are
not known (by gnutls) you should properly DER encode your data,
and call this function with <parameter>raw_flag</parameter> set.
</para>
<para>
Normally you do not need to call this function, since the signing
operation will copy the signer's name as the issuer of the
certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identifier in a null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>must be 0, or 1 if the data are DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name</parameter>&#160;:</term>
<listitem><simpara>a pointer to the name</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_name</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>name</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-key" role="function">
<title>gnutls_x509_crt_set_key ()</title>
<indexterm zone="gnutls-x509-crt-set-key"><primary>gnutls_x509_crt_set_key</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_key             (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will set the public parameters from the given
private key to the certificate. Only RSA keys are currently
supported.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>holds a private key</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-key-purpose-oid" role="function">
<title>gnutls_x509_crt_set_key_purpose_oid ()</title>
<indexterm zone="gnutls-x509-crt-set-key-purpose-oid"><primary>gnutls_x509_crt_set_key_purpose_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_key_purpose_oid (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);</programlisting>
<para>
This function will set the key purpose OIDs of the Certificate.
These are stored in the Extended Key Usage extension (2.5.29.37)
See the GNUTLS_KP_* definitions for human readable names.
</para>
<para>
Subsequent calls to this function will append OIDs to the OID list.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>a pointer to a null terminated string that holds the OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>Whether this extension will be critical or not</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned,
otherwise a negative error code is returned.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-key-usage" role="function">
<title>gnutls_x509_crt_set_key_usage ()</title>
<indexterm zone="gnutls-x509-crt-set-key-usage"><primary>gnutls_x509_crt_set_key_usage</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_key_usage       (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> usage</parameter>);</programlisting>
<para>
This function will set the keyUsage certificate extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>usage</parameter>&#160;:</term>
<listitem><simpara>an ORed sequence of the GNUTLS_KEY_* elements.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-pin-function" role="function" condition="since:3.1.0">
<title>gnutls_x509_crt_set_pin_function ()</title>
<indexterm zone="gnutls-x509-crt-set-pin-function" role="3.1.0"><primary>gnutls_x509_crt_set_pin_function</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_crt_set_pin_function    (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-pin-callback-t"><type>gnutls_pin_callback_t</type></link> fn</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *userdata</parameter>);</programlisting>
<para>
This function will set a callback function to be used when
it is required to access a protected object. This function overrides 
the global function set using <link linkend="gnutls-pkcs11-set-pin-function"><function>gnutls_pkcs11_set_pin_function()</function></link>.
</para>
<para>
Note that this callback is currently used only during the import
of a PKCS <link linkend="11:CAPS"><type>11</type></link> certificate with <link linkend="gnutls-x509-crt-import-pkcs11-url"><function>gnutls_x509_crt_import_pkcs11_url()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>The certificate structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>fn</parameter>&#160;:</term>
<listitem><simpara>the callback</simpara></listitem></varlistentry>
<varlistentry><term><parameter>userdata</parameter>&#160;:</term>
<listitem><simpara>data associated with the callback</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-set-policy" role="function" condition="since:3.1.5">
<title>gnutls_x509_crt_set_policy ()</title>
<indexterm zone="gnutls-x509-crt-set-policy" role="3.1.5"><primary>gnutls_x509_crt_set_policy</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_policy          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><type>struct gnutls_x509_policy_st</type> *policy</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> critical</parameter>);</programlisting>
<para>
This function will set the certificate policy extension (2.5.29.32).
Multiple calls to this function append a new policy.
</para>
<para>
Note the maximum text size for the qualifier <link linkend="GNUTLS-X509-QUALIFIER-NOTICE:CAPS"><literal>GNUTLS_X509_QUALIFIER_NOTICE</literal></link>
is 200 characters. This function will fail with <link linkend="GNUTLS-E-INVALID-REQUEST:CAPS"><literal>GNUTLS_E_INVALID_REQUEST</literal></link>
if this is exceeded.
</para><variablelist role="params">
<varlistentry><term><parameter>policy</parameter>&#160;:</term>
<listitem><simpara>A pointer to a policy structure.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>critical</parameter>&#160;:</term>
<listitem><simpara>use non-zero if the extension is marked as critical</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1.5</para></refsect2>
<refsect2 id="gnutls-x509-crt-set-private-key-usage-period" role="function">
<title>gnutls_x509_crt_set_private_key_usage_period ()</title>
<indexterm zone="gnutls-x509-crt-set-private-key-usage-period"><primary>gnutls_x509_crt_set_private_key_usage_period</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_private_key_usage_period
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> activation</parameter>,
                                                         <parameter><link linkend="time-t"><type>time_t</type></link> expiration</parameter>);</programlisting>
<para>
This function will set the private key usage period extension (2.5.29.16).
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>activation</parameter>&#160;:</term>
<listitem><simpara>The activation time</simpara></listitem></varlistentry>
<varlistentry><term><parameter>expiration</parameter>&#160;:</term>
<listitem><simpara>The expiration time</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-proxy" role="function">
<title>gnutls_x509_crt_set_proxy ()</title>
<indexterm zone="gnutls-x509-crt-set-proxy"><primary>gnutls_x509_crt_set_proxy</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_proxy           (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> pathLenConstraint</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *policyLanguage</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *policy</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> sizeof_policy</parameter>);</programlisting>
<para>
This function will set the proxyCertInfo extension.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>pathLenConstraint</parameter>&#160;:</term>
<listitem><simpara>non-negative error codes indicate maximum length of path,
and negative error codes indicate that the pathLenConstraints field should
not be present.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>policyLanguage</parameter>&#160;:</term>
<listitem><simpara>OID describing the language of <parameter>policy</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>policy</parameter>&#160;:</term>
<listitem><simpara>uint8_t byte array with policy language, can be <link linkend="NULL:CAPS"><literal>NULL</literal></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_policy</parameter>&#160;:</term>
<listitem><simpara>size of <parameter>policy</parameter>.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-proxy-dn" role="function">
<title>gnutls_x509_crt_set_proxy_dn ()</title>
<indexterm zone="gnutls-x509-crt-set-proxy-dn"><primary>gnutls_x509_crt_set_proxy_dn</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_proxy_dn        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> eecrt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> sizeof_name</parameter>);</programlisting>
<para>
This function will set the subject in <parameter>crt</parameter> to the end entity's
<parameter>eecrt</parameter> subject name, and add a single Common Name component <parameter>name</parameter>
of size <parameter>sizeof_name</parameter>.  This corresponds to the required proxy
certificate naming style.  Note that if <parameter>name</parameter> is <link linkend="NULL:CAPS"><literal>NULL</literal></link>, you MUST
set it later by using <link linkend="gnutls-x509-crt-set-dn-by-oid"><function>gnutls_x509_crt_set_dn_by_oid()</function></link> or similar.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a gnutls_x509_crt_t structure with the new proxy cert</simpara></listitem></varlistentry>
<varlistentry><term><parameter>eecrt</parameter>&#160;:</term>
<listitem><simpara>the end entity certificate that will be issuing the proxy</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>must be 0, or 1 if the CN is DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name</parameter>&#160;:</term>
<listitem><simpara>a pointer to the CN name, may be NULL (but MUST then be added later)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_name</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>name</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-serial" role="function">
<title>gnutls_x509_crt_set_serial ()</title>
<indexterm zone="gnutls-x509-crt-set-serial"><primary>gnutls_x509_crt_set_serial</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_serial          (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *serial</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> serial_size</parameter>);</programlisting>
<para>
This function will set the X.509 certificate's serial number.
Serial is not always a 32 or 64bit number.  Some CAs use large
serial numbers, thus it may be wise to handle it as something
uint8_t.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial</parameter>&#160;:</term>
<listitem><simpara>The serial number</simpara></listitem></varlistentry>
<varlistentry><term><parameter>serial_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-subject-alt-name" role="function" condition="since:2.6.0">
<title>gnutls_x509_crt_set_subject_alt_name ()</title>
<indexterm zone="gnutls-x509-crt-set-subject-alt-name" role="2.6.0"><primary>gnutls_x509_crt_set_subject_alt_name</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_subject_alt_name
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *data</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> data_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will set the subject alternative name certificate
extension. It can set the following types:
</para>
<para>
<link linkend="GNUTLS-SAN-DNSNAME:CAPS"><literal>GNUTLS_SAN_DNSNAME</literal></link>: as a text string
</para>
<para>
<link linkend="GNUTLS-SAN-RFC822NAME:CAPS"><literal>GNUTLS_SAN_RFC822NAME</literal></link>: as a text string
</para>
<para>
<link linkend="GNUTLS-SAN-URI:CAPS"><literal>GNUTLS_SAN_URI</literal></link>: as a text string
</para>
<para>
<link linkend="GNUTLS-SAN-IPADDRESS:CAPS"><literal>GNUTLS_SAN_IPADDRESS</literal></link>: as a binary IP address (4 or 16 bytes)
</para>
<para>
Other values can be set as binary values with the proper DER encoding.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>is one of the gnutls_x509_subject_alt_name_t enumerations</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The data to be set</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data_size</parameter>&#160;:</term>
<listitem><simpara>The size of data to be set</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>GNUTLS_FSAN_SET to clear previous data or GNUTLS_FSAN_APPEND to append.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.6.0</para></refsect2>
<refsect2 id="gnutls-x509-crt-set-subject-alternative-name" role="function">
<title>gnutls_x509_crt_set_subject_alternative_name ()</title>
<indexterm zone="gnutls-x509-crt-set-subject-alternative-name"><primary>gnutls_x509_crt_set_subject_alternative_name</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_subject_alternative_name
                                                        (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-subject-alt-name-t"><type>gnutls_x509_subject_alt_name_t</type></link> type</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *data_string</parameter>);</programlisting>
<para>
This function will set the subject alternative name certificate
extension. This function assumes that data can be expressed as a null
terminated string.
</para>
<para>
The name of the function is unfortunate since it is incosistent with
<link linkend="gnutls-x509-crt-get-subject-alt-name"><function>gnutls_x509_crt_get_subject_alt_name()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>is one of the gnutls_x509_subject_alt_name_t enumerations</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data_string</parameter>&#160;:</term>
<listitem><simpara>The data to be set, a (0) terminated string</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-subject-key-id" role="function">
<title>gnutls_x509_crt_set_subject_key_id ()</title>
<indexterm zone="gnutls-x509-crt-set-subject-key-id"><primary>gnutls_x509_crt_set_subject_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_subject_key_id  (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *id</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> id_size</parameter>);</programlisting>
<para>
This function will set the X.509 certificate's subject key ID
extension.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>id</parameter>&#160;:</term>
<listitem><simpara>The key ID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>id_size</parameter>&#160;:</term>
<listitem><simpara>Holds the size of the serial field.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-set-version" role="function">
<title>gnutls_x509_crt_set_version ()</title>
<indexterm zone="gnutls-x509-crt-set-version"><primary>gnutls_x509_crt_set_version</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_set_version         (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> version</parameter>);</programlisting>
<para>
This function will set the version of the certificate.  This must
be one for X.509 version 1, and so on.  Plain certificates without
extensions must have version set to one.
</para>
<para>
To create well-formed certificates, you must specify version 3 if
you use any certificate extensions.  Extensions are created by
functions such as <link linkend="gnutls-x509-crt-set-subject-alt-name"><function>gnutls_x509_crt_set_subject_alt_name()</function></link>
or <link linkend="gnutls-x509-crt-set-key-usage"><function>gnutls_x509_crt_set_key_usage()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>version</parameter>&#160;:</term>
<listitem><simpara>holds the version number. For X.509v1 certificates must be 1.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-sign" role="function">
<title>gnutls_x509_crt_sign ()</title>
<indexterm zone="gnutls-x509-crt-sign"><primary>gnutls_x509_crt_sign</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_sign                (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> issuer_key</parameter>);</programlisting>
<para>
This function is the same a <link linkend="gnutls-x509-crt-sign2"><function>gnutls_x509_crt_sign2()</function></link> with no flags,
and SHA1 as the hash algorithm.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer</parameter>&#160;:</term>
<listitem><simpara>is the certificate of the certificate issuer</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer_key</parameter>&#160;:</term>
<listitem><simpara>holds the issuer's private key</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-sign2" role="function">
<title>gnutls_x509_crt_sign2 ()</title>
<indexterm zone="gnutls-x509-crt-sign2"><primary>gnutls_x509_crt_sign2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_sign2               (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> crt</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> issuer</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> issuer_key</parameter>,
                                                         <parameter><link linkend="gnutls-digest-algorithm-t"><type>gnutls_digest_algorithm_t</type></link> dig</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will sign the certificate with the issuer's private key, and
will copy the issuer's information into the certificate.
</para>
<para>
This must be the last step in a certificate generation since all
the previously set parameters are now signed.
</para><variablelist role="params">
<varlistentry><term><parameter>crt</parameter>&#160;:</term>
<listitem><simpara>a certificate of type <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link></simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer</parameter>&#160;:</term>
<listitem><simpara>is the certificate of the certificate issuer</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer_key</parameter>&#160;:</term>
<listitem><simpara>holds the issuer's private key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>dig</parameter>&#160;:</term>
<listitem><simpara>The message digest to use, <link linkend="GNUTLS-DIG-SHA1:CAPS"><literal>GNUTLS_DIG_SHA1</literal></link> is a safe choice</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>must be 0</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-crt-verify" role="function">
<title>gnutls_x509_crt_verify ()</title>
<indexterm zone="gnutls-x509-crt-verify"><primary>gnutls_x509_crt_verify</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_crt_verify              (<parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *CA_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> CA_list_length</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>);</programlisting>
<para>
This function will try to verify the given certificate and return
its status.
</para><variablelist role="params">
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>is the certificate to be verified</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CA_list</parameter>&#160;:</term>
<listitem><simpara>is one certificate that is considered to be trusted one</simpara></listitem></varlistentry>
<varlistentry><term><parameter>CA_list_length</parameter>&#160;:</term>
<listitem><simpara>holds the number of CA certificate in CA_list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>verify</parameter>&#160;:</term>
<listitem><simpara>will hold the certificate verification output.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-dn-deinit" role="function" condition="since:2.4.0">
<title>gnutls_x509_dn_deinit ()</title>
<indexterm zone="gnutls-x509-dn-deinit" role="2.4.0"><primary>gnutls_x509_dn_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_dn_deinit               (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>);</programlisting>
<para>
This function deallocates the DN object as returned by
<link linkend="gnutls-x509-dn-import"><function>gnutls_x509_dn_import()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>a DN uint8_t object pointer.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.4.0</para></refsect2>
<refsect2 id="gnutls-x509-dn-export" role="function">
<title>gnutls_x509_dn_export ()</title>
<indexterm zone="gnutls-x509-dn-export"><primary>gnutls_x509_dn_export</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_dn_export               (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the DN to DER or PEM format.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>output_data_size</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link>
will be returned.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN NAME".
</para><variablelist role="params">
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>Holds the uint8_t DN object</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a DN PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-dn-export2" role="function">
<title>gnutls_x509_dn_export2 ()</title>
<indexterm zone="gnutls-x509-dn-export2"><primary>gnutls_x509_dn_export2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_dn_export2              (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the DN to DER or PEM format.
</para>
<para>
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN NAME".
</para><variablelist role="params">
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>Holds the uint8_t DN object</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a DN PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-dn-get-rdn-ava" role="function">
<title>gnutls_x509_dn_get_rdn_ava ()</title>
<indexterm zone="gnutls-x509-dn-get-rdn-ava"><primary>gnutls_x509_dn_get_rdn_ava</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_dn_get_rdn_ava          (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> irdn</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> iava</parameter>,
                                                         <parameter><link linkend="gnutls-x509-ava-st"><type>gnutls_x509_ava_st</type></link> *ava</parameter>);</programlisting>
<para>
Get pointers to data within the DN. The format of the <parameter>ava</parameter> structure
is shown below.
</para>
<para>
 struct gnutls_x509_ava_st {
   gnutls_datum_t oid;
   gnutls_datum_t value;
   unsigned long value_tag;
 };
</para>
<para>
The X.509 distinguished name is a sequence of sequences of strings
and this is what the <parameter>irdn</parameter> and <parameter>iava</parameter> indexes model.
</para>
<para>
Note that <parameter>ava</parameter> will contain pointers into the <parameter>dn</parameter> structure, so you
should not modify any data or deallocate it.  Note also that the DN
in turn points into the original certificate structure, and thus
you may not deallocate the certificate and continue to access <parameter>dn</parameter>.
</para><variablelist role="params">
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>a pointer to DN</simpara></listitem></varlistentry>
<varlistentry><term><parameter>irdn</parameter>&#160;:</term>
<listitem><simpara>index of RDN</simpara></listitem></varlistentry>
<varlistentry><term><parameter>iava</parameter>&#160;:</term>
<listitem><simpara>index of AVA.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ava</parameter>&#160;:</term>
<listitem><simpara>Pointer to structure which will hold output information.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>Returns 0 on success, or an error code.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-dn-import" role="function" condition="since:2.4.0">
<title>gnutls_x509_dn_import ()</title>
<indexterm zone="gnutls-x509-dn-import" role="2.4.0"><primary>gnutls_x509_dn_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_dn_import               (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> dn</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>);</programlisting>
<para>
This function parses an RDN sequence and stores the result to a
<link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> structure. The structure must have been initialized
with <link linkend="gnutls-x509-dn-init"><function>gnutls_x509_dn_init()</function></link>. You may use <link linkend="gnutls-x509-dn-get-rdn-ava"><function>gnutls_x509_dn_get_rdn_ava()</function></link> to
decode the DN.
</para><variablelist role="params">
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>the structure that will hold the imported DN</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>should contain a DER encoded RDN sequence</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.4.0</para></refsect2>
<refsect2 id="gnutls-x509-dn-init" role="function" condition="since:2.4.0">
<title>gnutls_x509_dn_init ()</title>
<indexterm zone="gnutls-x509-dn-init" role="2.4.0"><primary>gnutls_x509_dn_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_dn_init                 (<parameter><link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> *dn</parameter>);</programlisting>
<para>
This function initializes a <link linkend="gnutls-x509-dn-t"><type>gnutls_x509_dn_t</type></link> structure.
</para>
<para>
The object returned must be deallocated using
<link linkend="gnutls-x509-dn-deinit"><function>gnutls_x509_dn_deinit()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>dn</parameter>&#160;:</term>
<listitem><simpara>the object to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.4.0</para></refsect2>
<refsect2 id="gnutls-x509-dn-oid-known" role="function">
<title>gnutls_x509_dn_oid_known ()</title>
<indexterm zone="gnutls-x509-dn-oid-known"><primary>gnutls_x509_dn_oid_known</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_dn_oid_known            (<parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>);</programlisting>
<para>
This function will inform about known DN OIDs. This is useful since
functions like <link linkend="gnutls-x509-crt-set-dn-by-oid"><function>gnutls_x509_crt_set_dn_by_oid()</function></link> use the information
on known OIDs to properly encode their input. Object Identifiers
that are not known are not encoded by these functions, and their
input is stored directly into the ASN.1 structure. In that case of
unknown OIDs, you have the responsibility of DER encoding your
data.
</para><variablelist role="params">
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identifier in a null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>1 on known OIDs and 0 otherwise.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-dn-oid-name" role="function" condition="since:3.0">
<title>gnutls_x509_dn_oid_name ()</title>
<indexterm zone="gnutls-x509-dn-oid-name" role="3.0"><primary>gnutls_x509_dn_oid_name</primary></indexterm>
<programlisting>const <link linkend="char"><returnvalue>char</returnvalue></link> *        gnutls_x509_dn_oid_name             (<parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will return the name of a known DN OID. If
<link linkend="GNUTLS-X509-DN-OID-RETURN-OID:CAPS"><literal>GNUTLS_X509_DN_OID_RETURN_OID</literal></link> is specified this function
will return the given OID if no descriptive name has been
found.
</para><variablelist role="params">
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>holds an Object Identifier in a null terminated string</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>0 or GNUTLS_X509_DN_OID_*</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>A null terminated string or NULL otherwise.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-dn-t" role="typedef">
<title>gnutls_x509_dn_t</title>
<indexterm zone="gnutls-x509-dn-t"><primary>gnutls_x509_dn_t</primary></indexterm>
<programlisting>  typedef void *gnutls_x509_dn_t;
</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-x509-policy-release" role="function" condition="since:3.1.5">
<title>gnutls_x509_policy_release ()</title>
<indexterm zone="gnutls-x509-policy-release" role="3.1.5"><primary>gnutls_x509_policy_release</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_policy_release          (<parameter><type>struct gnutls_x509_policy_st</type> *policy</parameter>);</programlisting>
<para>
This function will deinitialize all memory associated with the provided
<parameter>policy</parameter>. The policy is allocated using <link linkend="gnutls-x509-crt-get-policy"><function>gnutls_x509_crt_get_policy()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>policy</parameter>&#160;:</term>
<listitem><simpara>a certificate policy</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1.5</para></refsect2>
<refsect2 id="gnutls-x509-privkey-cpy" role="function">
<title>gnutls_x509_privkey_cpy ()</title>
<indexterm zone="gnutls-x509-privkey-cpy"><primary>gnutls_x509_privkey_cpy</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_cpy             (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> dst</parameter>,
                                                         <parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> src</parameter>);</programlisting>
<para>
This function will copy a private key from source to destination
key. Destination has to be initialized.
</para><variablelist role="params">
<varlistentry><term><parameter>dst</parameter>&#160;:</term>
<listitem><simpara>The destination key, which should be initialized.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>src</parameter>&#160;:</term>
<listitem><simpara>The source key</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-deinit" role="function">
<title>gnutls_x509_privkey_deinit ()</title>
<indexterm zone="gnutls-x509-privkey-deinit"><primary>gnutls_x509_privkey_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_privkey_deinit          (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will deinitialize a private key structure.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to be deinitialized</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export" role="function">
<title>gnutls_x509_privkey_export ()</title>
<indexterm zone="gnutls-x509-privkey-export"><primary>gnutls_x509_privkey_export</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export          (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the private key to a PKCS1 structure for
RSA keys, or an integer sequence for DSA keys.  The DSA keys are in
the same format with the parameters used by openssl.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>output_data_size</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link>
will be returned.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN RSA PRIVATE KEY".
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>Holds the key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a private key PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export2" role="function">
<title>gnutls_x509_privkey_export2 ()</title>
<indexterm zone="gnutls-x509-privkey-export2"><primary>gnutls_x509_privkey_export2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export2         (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the private key to a PKCS1 structure for
RSA keys, or an integer sequence for DSA keys.  The DSA keys are in
the same format with the parameters used by openssl.
</para>
<para>
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN RSA PRIVATE KEY".
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>Holds the key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a private key PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.
Since 3.1.3</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export2-pkcs8" role="function">
<title>gnutls_x509_privkey_export2_pkcs8 ()</title>
<indexterm zone="gnutls-x509-privkey-export2-pkcs8"><primary>gnutls_x509_privkey_export2_pkcs8</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export2_pkcs8   (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *out</parameter>);</programlisting>
<para>
This function will export the private key to a PKCS8 structure.
Both RSA and DSA keys can be exported. For DSA keys we use
PKCS <link linkend="11:CAPS"><type>11</type></link> definitions. If the flags do not specify the encryption
cipher, then the default 3DES (PBES2) will be used.
</para>
<para>
The <parameter>password</parameter> can be either ASCII or UTF-8 in the default PBES2
encryption schemas, or ASCII for the PKCS12 schemas.
</para>
<para>
The output buffer is allocated using <link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link>.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN ENCRYPTED PRIVATE KEY" or "BEGIN PRIVATE KEY" if
encryption is not used.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>Holds the key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>password</parameter>&#160;:</term>
<listitem><simpara>the password that will be used to encrypt the key.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>an ORed sequence of gnutls_pkcs_encrypt_flags_t</simpara></listitem></varlistentry>
<varlistentry><term><parameter>out</parameter>&#160;:</term>
<listitem><simpara>will contain a private key PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of failure a negative error code will be
returned, and 0 on success.
Since 3.1.3</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export-dsa-raw" role="function">
<title>gnutls_x509_privkey_export_dsa_raw ()</title>
<indexterm zone="gnutls-x509-privkey-export-dsa-raw"><primary>gnutls_x509_privkey_export_dsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export_dsa_raw  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *g</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>);</programlisting>
<para>
This function will export the DSA private key's parameters found
in the given structure. The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>a structure that holds the DSA parameters</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>will hold the p</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>will hold the q</simpara></listitem></varlistentry>
<varlistentry><term><parameter>g</parameter>&#160;:</term>
<listitem><simpara>will hold the g</simpara></listitem></varlistentry>
<varlistentry><term><parameter>y</parameter>&#160;:</term>
<listitem><simpara>will hold the y</simpara></listitem></varlistentry>
<varlistentry><term><parameter>x</parameter>&#160;:</term>
<listitem><simpara>will hold the x</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export-ecc-raw" role="function" condition="since:3.0">
<title>gnutls_x509_privkey_export_ecc_raw ()</title>
<indexterm zone="gnutls-x509-privkey-export-ecc-raw" role="3.0"><primary>gnutls_x509_privkey_export_ecc_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export_ecc_raw  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-ecc-curve-t"><type>gnutls_ecc_curve_t</type></link> *curve</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *k</parameter>);</programlisting>
<para>
This function will export the ECC private key's parameters found
in the given structure. The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>a structure that holds the rsa parameters</simpara></listitem></varlistentry>
<varlistentry><term><parameter>curve</parameter>&#160;:</term>
<listitem><simpara>will hold the curve</simpara></listitem></varlistentry>
<varlistentry><term><parameter>x</parameter>&#160;:</term>
<listitem><simpara>will hold the x coordinate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>y</parameter>&#160;:</term>
<listitem><simpara>will hold the y coordinate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>k</parameter>&#160;:</term>
<listitem><simpara>will hold the private key</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-privkey-export-pkcs8" role="function">
<title>gnutls_x509_privkey_export_pkcs8 ()</title>
<indexterm zone="gnutls-x509-privkey-export-pkcs8"><primary>gnutls_x509_privkey_export_pkcs8</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export_pkcs8    (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will export the private key to a PKCS8 structure.
Both RSA and DSA keys can be exported. For DSA keys we use
PKCS <link linkend="11:CAPS"><type>11</type></link> definitions. If the flags do not specify the encryption
cipher, then the default 3DES (PBES2) will be used.
</para>
<para>
The <parameter>password</parameter> can be either ASCII or UTF-8 in the default PBES2
encryption schemas, or ASCII for the PKCS12 schemas.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.
</para>
<para>
If the structure is PEM encoded, it will have a header
of "BEGIN ENCRYPTED PRIVATE KEY" or "BEGIN PRIVATE KEY" if
encryption is not used.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>Holds the key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>the format of output params. One of PEM or DER.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>password</parameter>&#160;:</term>
<listitem><simpara>the password that will be used to encrypt the key.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>an ORed sequence of gnutls_pkcs_encrypt_flags_t</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain a private key PEM or DER encoded</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>In case of failure a negative error code will be
returned, and 0 on success.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export-rsa-raw" role="function">
<title>gnutls_x509_privkey_export_rsa_raw ()</title>
<indexterm zone="gnutls-x509-privkey-export-rsa-raw"><primary>gnutls_x509_privkey_export_rsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export_rsa_raw  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>);</programlisting>
<para>
This function will export the RSA private key's parameters found
in the given structure. The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>a structure that holds the rsa parameters</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>will hold the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>will hold the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>d</parameter>&#160;:</term>
<listitem><simpara>will hold the private exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>will hold the first prime (p)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>will hold the second prime (q)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>u</parameter>&#160;:</term>
<listitem><simpara>will hold the coefficient</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-export-rsa-raw2" role="function" condition="since:2.12.0">
<title>gnutls_x509_privkey_export_rsa_raw2 ()</title>
<indexterm zone="gnutls-x509-privkey-export-rsa-raw2" role="2.12.0"><primary>gnutls_x509_privkey_export_rsa_raw2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_export_rsa_raw2 (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e1</parameter>,
                                                         <parameter><link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e2</parameter>);</programlisting>
<para>
This function will export the RSA private key's parameters found
in the given structure. The new parameters will be allocated using
<link linkend="gnutls-malloc"><function>gnutls_malloc()</function></link> and will be stored in the appropriate datum.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>a structure that holds the rsa parameters</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>will hold the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>will hold the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>d</parameter>&#160;:</term>
<listitem><simpara>will hold the private exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>will hold the first prime (p)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>will hold the second prime (q)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>u</parameter>&#160;:</term>
<listitem><simpara>will hold the coefficient</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e1</parameter>&#160;:</term>
<listitem><simpara>will hold e1 = d mod (p-1)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e2</parameter>&#160;:</term>
<listitem><simpara>will hold e2 = d mod (q-1)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.12.0</para></refsect2>
<refsect2 id="gnutls-x509-privkey-fix" role="function">
<title>gnutls_x509_privkey_fix ()</title>
<indexterm zone="gnutls-x509-privkey-fix"><primary>gnutls_x509_privkey_fix</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_fix             (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will recalculate the secondary parameters in a key.
In RSA keys, this can be the coefficient and exponent1,2.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>Holds the key</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-generate" role="function">
<title>gnutls_x509_privkey_generate ()</title>
<indexterm zone="gnutls-x509-privkey-generate"><primary>gnutls_x509_privkey_generate</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_generate        (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link> algo</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> bits</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will generate a random private key. Note that this
function must be called on an empty private key.
</para>
<para>
Do not set the number of bits directly, use <link linkend="gnutls-sec-param-to-pk-bits"><function>gnutls_sec_param_to_pk_bits()</function></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>algo</parameter>&#160;:</term>
<listitem><simpara>is one of the algorithms in <link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link>.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>bits</parameter>&#160;:</term>
<listitem><simpara>the size of the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>unused for now.  Must be 0.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-get-key-id" role="function">
<title>gnutls_x509_privkey_get_key_id ()</title>
<indexterm zone="gnutls-x509-privkey-get-key-id"><primary>gnutls_x509_privkey_get_key_id</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_get_key_id      (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="char"><type>char</type></link> *output_data</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *output_data_size</parameter>);</programlisting>
<para>
This function will return a unique ID that depends on the public key
parameters. This ID can be used in checking whether a certificate
corresponds to the given key.
</para>
<para>
If the buffer provided is not long enough to hold the output, then
*<parameter>output_data_size</parameter> is updated and <link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> will
be returned.  The output will normally be a SHA-1 hash output,
which is 20 bytes.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>Holds the key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>should be 0 for now</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data</parameter>&#160;:</term>
<listitem><simpara>will contain the key ID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>output_data_size</parameter>&#160;:</term>
<listitem><simpara>holds the size of output_data (and will be
replaced by the actual size of parameters)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-get-pk-algorithm" role="function">
<title>gnutls_x509_privkey_get_pk_algorithm ()</title>
<indexterm zone="gnutls-x509-privkey-get-pk-algorithm"><primary>gnutls_x509_privkey_get_pk_algorithm</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_get_pk_algorithm
                                                        (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will return the public key algorithm of a private
key.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>a member of the <link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link> enumeration on
success, or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-get-pk-algorithm2" role="function">
<title>gnutls_x509_privkey_get_pk_algorithm2 ()</title>
<indexterm zone="gnutls-x509-privkey-get-pk-algorithm2"><primary>gnutls_x509_privkey_get_pk_algorithm2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_get_pk_algorithm2
                                                        (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *bits</parameter>);</programlisting>
<para>
This function will return the public key algorithm of a private
key.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><parameter>bits</parameter>&#160;:</term>
<listitem><simpara>The number of bits in the public key algorithm</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>a member of the <link linkend="gnutls-pk-algorithm-t"><type>gnutls_pk_algorithm_t</type></link> enumeration on
success, or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import" role="function">
<title>gnutls_x509_privkey_import ()</title>
<indexterm zone="gnutls-x509-privkey-import"><primary>gnutls_x509_privkey_import</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import          (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>);</programlisting>
<para>
This function will convert the given DER or PEM encoded key to the
native <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> format. The output will be stored in
<parameter>key</parameter> .
</para>
<para>
If the key is PEM encoded it should have a header that contains "PRIVATE
KEY". Note that this function falls back to PKCS #8 decoding without
password, if the default format fails to import.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded certificate.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import2" role="function">
<title>gnutls_x509_privkey_import2 ()</title>
<indexterm zone="gnutls-x509-privkey-import2"><primary>gnutls_x509_privkey_import2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import2         (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will import the given DER or PEM encoded key, to 
the native <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> format, irrespective of the
input format. The input format is auto-detected.
</para>
<para>
The supported formats are typical X.509, PKCS #8 and the openssl
format.
</para>
<para>
If the provided key is encrypted but no password was given, then
<link linkend="GNUTLS-E-DECRYPTION-FAILED:CAPS"><literal>GNUTLS_E_DECRYPTION_FAILED</literal></link> is returned.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded key.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><parameter>password</parameter>&#160;:</term>
<listitem><simpara>A password (optional)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>an ORed sequence of gnutls_pkcs_encrypt_flags_t</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import-dsa-raw" role="function">
<title>gnutls_x509_privkey_import_dsa_raw ()</title>
<indexterm zone="gnutls-x509-privkey-import-dsa-raw"><primary>gnutls_x509_privkey_import_dsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import_dsa_raw  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *g</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>);</programlisting>
<para>
This function will convert the given DSA raw parameters to the
native <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> format.  The output will be stored
in <parameter>key</parameter>.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>holds the p</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>holds the q</simpara></listitem></varlistentry>
<varlistentry><term><parameter>g</parameter>&#160;:</term>
<listitem><simpara>holds the g</simpara></listitem></varlistentry>
<varlistentry><term><parameter>y</parameter>&#160;:</term>
<listitem><simpara>holds the y</simpara></listitem></varlistentry>
<varlistentry><term><parameter>x</parameter>&#160;:</term>
<listitem><simpara>holds the x</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import-ecc-raw" role="function" condition="since:3.0">
<title>gnutls_x509_privkey_import_ecc_raw ()</title>
<indexterm zone="gnutls-x509-privkey-import-ecc-raw" role="3.0"><primary>gnutls_x509_privkey_import_ecc_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import_ecc_raw  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter><link linkend="gnutls-ecc-curve-t"><type>gnutls_ecc_curve_t</type></link> curve</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *x</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *y</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *k</parameter>);</programlisting>
<para>
This function will convert the given elliptic curve parameters to the
native <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> format.  The output will be stored
in <parameter>key</parameter>.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>curve</parameter>&#160;:</term>
<listitem><simpara>holds the curve</simpara></listitem></varlistentry>
<varlistentry><term><parameter>x</parameter>&#160;:</term>
<listitem><simpara>holds the x</simpara></listitem></varlistentry>
<varlistentry><term><parameter>y</parameter>&#160;:</term>
<listitem><simpara>holds the y</simpara></listitem></varlistentry>
<varlistentry><term><parameter>k</parameter>&#160;:</term>
<listitem><simpara>holds the k</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-privkey-import-openssl" role="function">
<title>gnutls_x509_privkey_import_openssl ()</title>
<indexterm zone="gnutls-x509-privkey-import-openssl"><primary>gnutls_x509_privkey_import_openssl</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import_openssl  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>);</programlisting>
<para>
This function will convert the given PEM encrypted to 
the native gnutls_x509_privkey_t format. The
output will be stored in <parameter>key</parameter>.  
</para>
<para>
The <parameter>password</parameter> should be in ASCII. If the password is not provided
or wrong then <link linkend="GNUTLS-E-DECRYPTION-FAILED:CAPS"><literal>GNUTLS_E_DECRYPTION_FAILED</literal></link> will be returned.
</para>
<para>
If the Certificate is PEM encoded it should have a header of
"PRIVATE KEY" and the "DEK-Info" header.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded key.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>password</parameter>&#160;:</term>
<listitem><simpara>the password to decrypt the key (if it is encrypted).</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import-pkcs8" role="function">
<title>gnutls_x509_privkey_import_pkcs8 ()</title>
<indexterm zone="gnutls-x509-privkey-import-pkcs8"><primary>gnutls_x509_privkey_import_pkcs8</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import_pkcs8    (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *data</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> format</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *password</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will convert the given DER or PEM encoded PKCS8 2.0
encrypted key to the native gnutls_x509_privkey_t format. The
output will be stored in <parameter>key</parameter>.  Both RSA and DSA keys can be
imported, and flags can only be used to indicate an unencrypted
key.
</para>
<para>
The <parameter>password</parameter> can be either ASCII or UTF-8 in the default PBES2
encryption schemas, or ASCII for the PKCS12 schemas.
</para>
<para>
If the Certificate is PEM encoded it should have a header of
"ENCRYPTED PRIVATE KEY", or "PRIVATE KEY". You only need to
specify the flags if the key is DER encoded, since in that case
the encryption status cannot be auto-detected.
</para>
<para>
If the <link linkend="GNUTLS-PKCS-PLAIN:CAPS"><literal>GNUTLS_PKCS_PLAIN</literal></link> flag is specified and the supplied data
are encrypted then <link linkend="GNUTLS-E-DECRYPTION-FAILED:CAPS"><literal>GNUTLS_E_DECRYPTION_FAILED</literal></link> is returned.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>data</parameter>&#160;:</term>
<listitem><simpara>The DER or PEM encoded key.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>format</parameter>&#160;:</term>
<listitem><simpara>One of DER or PEM</simpara></listitem></varlistentry>
<varlistentry><term><parameter>password</parameter>&#160;:</term>
<listitem><simpara>the password to decrypt the key (if it is encrypted).</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>0 if encrypted or GNUTLS_PKCS_PLAIN if not encrypted.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import-rsa-raw" role="function">
<title>gnutls_x509_privkey_import_rsa_raw ()</title>
<indexterm zone="gnutls-x509-privkey-import-rsa-raw"><primary>gnutls_x509_privkey_import_rsa_raw</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import_rsa_raw  (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>);</programlisting>
<para>
This function will convert the given RSA raw parameters to the
native <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> format.  The output will be stored in
<parameter>key</parameter>.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>holds the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>holds the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>d</parameter>&#160;:</term>
<listitem><simpara>holds the private exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>holds the first prime (p)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>holds the second prime (q)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>u</parameter>&#160;:</term>
<listitem><simpara>holds the coefficient</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-import-rsa-raw2" role="function">
<title>gnutls_x509_privkey_import_rsa_raw2 ()</title>
<indexterm zone="gnutls-x509-privkey-import-rsa-raw2"><primary>gnutls_x509_privkey_import_rsa_raw2</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_import_rsa_raw2 (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *m</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *d</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *p</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *q</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *u</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e1</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *e2</parameter>);</programlisting>
<para>
This function will convert the given RSA raw parameters to the
native <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> format.  The output will be stored in
<parameter>key</parameter>.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to store the parsed key</simpara></listitem></varlistentry>
<varlistentry><term><parameter>m</parameter>&#160;:</term>
<listitem><simpara>holds the modulus</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e</parameter>&#160;:</term>
<listitem><simpara>holds the public exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>d</parameter>&#160;:</term>
<listitem><simpara>holds the private exponent</simpara></listitem></varlistentry>
<varlistentry><term><parameter>p</parameter>&#160;:</term>
<listitem><simpara>holds the first prime (p)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>q</parameter>&#160;:</term>
<listitem><simpara>holds the second prime (q)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>u</parameter>&#160;:</term>
<listitem><simpara>holds the coefficient</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e1</parameter>&#160;:</term>
<listitem><simpara>holds e1 = d mod (p-1)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>e2</parameter>&#160;:</term>
<listitem><simpara>holds e2 = d mod (q-1)</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-init" role="function">
<title>gnutls_x509_privkey_init ()</title>
<indexterm zone="gnutls-x509-privkey-init"><primary>gnutls_x509_privkey_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_init            (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> *key</parameter>);</programlisting>
<para>
This function will initialize an private key structure.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-privkey-sec-param" role="function" condition="since:2.12.0">
<title>gnutls_x509_privkey_sec_param ()</title>
<indexterm zone="gnutls-x509-privkey-sec-param" role="2.12.0"><primary>gnutls_x509_privkey_sec_param</primary></indexterm>
<programlisting><link linkend="gnutls-sec-param-t"><returnvalue>gnutls_sec_param_t</returnvalue></link>  gnutls_x509_privkey_sec_param       (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will return the security parameter appropriate with
this private key.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>a key structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, a valid security parameter is returned otherwise
<link linkend="GNUTLS-SEC-PARAM-UNKNOWN:CAPS"><literal>GNUTLS_SEC_PARAM_UNKNOWN</literal></link> is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.12.0</para></refsect2>
<refsect2 id="gnutls-x509-privkey-verify-params" role="function">
<title>gnutls_x509_privkey_verify_params ()</title>
<indexterm zone="gnutls-x509-privkey-verify-params"><primary>gnutls_x509_privkey_verify_params</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_privkey_verify_params   (<parameter><link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> key</parameter>);</programlisting>
<para>
This function will verify the private key parameters.
</para><variablelist role="params">
<varlistentry><term><parameter>key</parameter>&#160;:</term>
<listitem><simpara>should contain a <link linkend="gnutls-x509-privkey-t"><type>gnutls_x509_privkey_t</type></link> structure</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-qualifier-t" role="enum">
<title>enum gnutls_x509_qualifier_t</title>
<indexterm zone="gnutls-x509-qualifier-t"><primary>gnutls_x509_qualifier_t</primary></indexterm>
<programlisting>typedef enum {
    GNUTLS_X509_QUALIFIER_UNKNOWN = 0, GNUTLS_X509_QUALIFIER_URI, 
    GNUTLS_X509_QUALIFIER_NOTICE
} gnutls_x509_qualifier_t;
</programlisting>
<para>
Enumeration of types for the X.509 qualifiers, of the certificate policy extension.
</para><variablelist role="enum">
<varlistentry id="GNUTLS-X509-QUALIFIER-UNKNOWN:CAPS" role="constant">
<term><literal>GNUTLS_X509_QUALIFIER_UNKNOWN</literal></term>
<listitem><simpara>Unknown qualifier.
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-X509-QUALIFIER-URI:CAPS" role="constant">
<term><literal>GNUTLS_X509_QUALIFIER_URI</literal></term>
<listitem><simpara>A URL
</simpara></listitem>
</varlistentry>
<varlistentry id="GNUTLS-X509-QUALIFIER-NOTICE:CAPS" role="constant">
<term><literal>GNUTLS_X509_QUALIFIER_NOTICE</literal></term>
<listitem><simpara>
</simpara></listitem>
</varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-rdn-get" role="function">
<title>gnutls_x509_rdn_get ()</title>
<indexterm zone="gnutls-x509-rdn-get"><primary>gnutls_x509_rdn_get</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_rdn_get                 (<parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *idn</parameter>,
                                                         <parameter><link linkend="char"><type>char</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will return the name of the given RDN sequence.  The
name will be in the form "C=xxxx,O=yyyy,CN=zzzz" as described in
RFC4514.
</para><variablelist role="params">
<varlistentry><term><parameter>idn</parameter>&#160;:</term>
<listitem><simpara>should contain a DER encoded RDN sequence</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the peer's name</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, or
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> is returned and *<parameter>sizeof_buf</parameter> is
updated if the provided buffer is not long enough, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-rdn-get-by-oid" role="function">
<title>gnutls_x509_rdn_get_by_oid ()</title>
<indexterm zone="gnutls-x509-rdn-get-by-oid"><primary>gnutls_x509_rdn_get_by_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_rdn_get_by_oid          (<parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *idn</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *oid</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> raw_flag</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will return the name of the given Object identifier,
of the RDN sequence.  The name will be encoded using the rules
from RFC4514.
</para><variablelist role="params">
<varlistentry><term><parameter>idn</parameter>&#160;:</term>
<listitem><simpara>should contain a DER encoded RDN sequence</simpara></listitem></varlistentry>
<varlistentry><term><parameter>oid</parameter>&#160;:</term>
<listitem><simpara>an Object Identifier</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>In case multiple same OIDs exist in the RDN indicates which
to send. Use 0 for the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>raw_flag</parameter>&#160;:</term>
<listitem><simpara>If non-zero then the raw DER data are returned.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the peer's name</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, or
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> is returned and *<parameter>sizeof_buf</parameter> is
updated if the provided buffer is not long enough, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist></refsect2>
<refsect2 id="gnutls-x509-rdn-get-oid" role="function" condition="since:2.4.0">
<title>gnutls_x509_rdn_get_oid ()</title>
<indexterm zone="gnutls-x509-rdn-get-oid" role="2.4.0"><primary>gnutls_x509_rdn_get_oid</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_rdn_get_oid             (<parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *idn</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> indx</parameter>,
                                                         <parameter><link linkend="void"><type>void</type></link> *buf</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> *sizeof_buf</parameter>);</programlisting>
<para>
This function will return the specified Object identifier, of the
RDN sequence.
</para><variablelist role="params">
<varlistentry><term><parameter>idn</parameter>&#160;:</term>
<listitem><simpara>should contain a DER encoded RDN sequence</simpara></listitem></varlistentry>
<varlistentry><term><parameter>indx</parameter>&#160;:</term>
<listitem><simpara>Indicates which OID to return. Use 0 for the first one.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>buf</parameter>&#160;:</term>
<listitem><simpara>a pointer to a structure to hold the peer's name OID</simpara></listitem></varlistentry>
<varlistentry><term><parameter>sizeof_buf</parameter>&#160;:</term>
<listitem><simpara>holds the size of <parameter>buf</parameter></simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, or
<link linkend="GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><literal>GNUTLS_E_SHORT_MEMORY_BUFFER</literal></link> is returned and *<parameter>sizeof_buf</parameter> is
updated if the provided buffer is not long enough, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 2.4.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-add-cas" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_add_cas ()</title>
<indexterm zone="gnutls-x509-trust-list-add-cas" role="3.0"><primary>gnutls_x509_trust_list_add_cas</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_add_cas      (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *clist</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> clist_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will add the given certificate authorities
to the trusted list. The list of CAs must not be deinitialized
during this structure's lifetime.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>clist</parameter>&#160;:</term>
<listitem><simpara>A list of CAs</simpara></listitem></varlistentry>
<varlistentry><term><parameter>clist_size</parameter>&#160;:</term>
<listitem><simpara>The length of the CA list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>should be 0.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>The number of added elements is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-add-crls" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_add_crls ()</title>
<indexterm zone="gnutls-x509-trust-list-add-crls" role="3.0"><primary>gnutls_x509_trust_list_add_crls</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_add_crls     (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="gnutls-x509-crl-t"><type>gnutls_x509_crl_t</type></link> *crl_list</parameter>,
                                                         <parameter><link linkend="int"><type>int</type></link> crl_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> verification_flags</parameter>);</programlisting>
<para>
This function will add the given certificate revocation lists
to the trusted list. The list of CRLs must not be deinitialized
during this structure's lifetime.
</para>
<para>
This function must be called after <link linkend="gnutls-x509-trust-list-add-cas"><function>gnutls_x509_trust_list_add_cas()</function></link>
to allow verifying the CRLs for validity.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_list</parameter>&#160;:</term>
<listitem><simpara>A list of CRLs</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_size</parameter>&#160;:</term>
<listitem><simpara>The length of the CRL list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>if GNUTLS_TL_VERIFY_CRL is given the CRLs will be verified before being added.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>verification_flags</parameter>&#160;:</term>
<listitem><simpara>gnutls_certificate_verify_flags if flags specifies GNUTLS_TL_VERIFY_CRL</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>The number of added elements is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-add-named-crt" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_add_named_crt ()</title>
<indexterm zone="gnutls-x509-trust-list-add-named-crt" role="3.0"><primary>gnutls_x509_trust_list_add_named_crt</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_add_named_crt
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> name_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will add the given certificate to the trusted
list and associate it with a name. The certificate will not be
be used for verification with <link linkend="gnutls-x509-trust-list-verify-crt"><function>gnutls_x509_trust_list_verify_crt()</function></link>
but only with <link linkend="gnutls-x509-trust-list-verify-named-crt"><function>gnutls_x509_trust_list_verify_named_crt()</function></link>.
</para>
<para>
In principle this function can be used to set individual "server"
certificates that are trusted by the user for that specific server
but for no other purposes.
</para>
<para>
The certificate must not be deinitialized during the lifetime
of the trusted list.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>A certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name</parameter>&#160;:</term>
<listitem><simpara>An identifier for the certificate</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name_size</parameter>&#160;:</term>
<listitem><simpara>The size of the identifier</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>should be 0.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-add-system-trust" role="function" condition="since:3.1">
<title>gnutls_x509_trust_list_add_system_trust ()</title>
<indexterm zone="gnutls-x509-trust-list-add-system-trust" role="3.1"><primary>gnutls_x509_trust_list_add_system_trust</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_add_system_trust
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_vflags</parameter>);</programlisting>
<para>
This function adds the system's default trusted certificate
authorities to the trusted list. Note that on unsupported system
this function returns <link linkend="GNUTLS-E-UNIMPLEMENTED-FEATURE:CAPS"><literal>GNUTLS_E_UNIMPLEMENTED_FEATURE</literal></link>.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>tl_flags</parameter>&#160;:</term>
<listitem><simpara>GNUTLS_TL_*</simpara></listitem></varlistentry>
<varlistentry><term><parameter>tl_vflags</parameter>&#160;:</term>
<listitem><simpara>gnutls_certificate_verify_flags if flags specifies GNUTLS_TL_VERIFY_CRL</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>The number of added elements or a negative error code on error.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-add-trust-file" role="function" condition="since:3.1">
<title>gnutls_x509_trust_list_add_trust_file ()</title>
<indexterm zone="gnutls-x509-trust-list-add-trust-file" role="3.1"><primary>gnutls_x509_trust_list_add_trust_file</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_add_trust_file
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *ca_file</parameter>,
                                                         <parameter>const <link linkend="char"><type>char</type></link> *crl_file</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_vflags</parameter>);</programlisting>
<para>
This function will add the given certificate authorities
to the trusted list. pkcs11 URLs are also accepted, instead
of files, by this function.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>ca_file</parameter>&#160;:</term>
<listitem><simpara>A file containing a list of CAs (optional)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crl_file</parameter>&#160;:</term>
<listitem><simpara>A file containing a list of CRLs (optional)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>The format of the certificates</simpara></listitem></varlistentry>
<varlistentry><term><parameter>tl_flags</parameter>&#160;:</term>
<listitem><simpara>GNUTLS_TL_*</simpara></listitem></varlistentry>
<varlistentry><term><parameter>tl_vflags</parameter>&#160;:</term>
<listitem><simpara>gnutls_certificate_verify_flags if flags specifies GNUTLS_TL_VERIFY_CRL</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>The number of added elements is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-add-trust-mem" role="function" condition="since:3.1">
<title>gnutls_x509_trust_list_add_trust_mem ()</title>
<indexterm zone="gnutls-x509-trust-list-add-trust-mem" role="3.1"><primary>gnutls_x509_trust_list_add_trust_mem</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_add_trust_mem
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *cas</parameter>,
                                                         <parameter>const <link linkend="gnutls-datum-t"><type>gnutls_datum_t</type></link> *crls</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-fmt-t"><type>gnutls_x509_crt_fmt_t</type></link> type</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> tl_vflags</parameter>);</programlisting>
<para>
This function will add the given certificate authorities
to the trusted list.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cas</parameter>&#160;:</term>
<listitem><simpara>A buffer containing a list of CAs (optional)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>crls</parameter>&#160;:</term>
<listitem><simpara>A buffer containing a list of CRLs (optional)</simpara></listitem></varlistentry>
<varlistentry><term><parameter>type</parameter>&#160;:</term>
<listitem><simpara>The format of the certificates</simpara></listitem></varlistentry>
<varlistentry><term><parameter>tl_flags</parameter>&#160;:</term>
<listitem><simpara>GNUTLS_TL_*</simpara></listitem></varlistentry>
<varlistentry><term><parameter>tl_vflags</parameter>&#160;:</term>
<listitem><simpara>gnutls_certificate_verify_flags if flags specifies GNUTLS_TL_VERIFY_CRL</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>The number of added elements is returned.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.1</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-deinit" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_deinit ()</title>
<indexterm zone="gnutls-x509-trust-list-deinit" role="3.0"><primary>gnutls_x509_trust_list_deinit</primary></indexterm>
<programlisting><link linkend="void"><returnvalue>void</returnvalue></link>                gnutls_x509_trust_list_deinit       (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> all</parameter>);</programlisting>
<para>
This function will deinitialize a trust list.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure to be deinitialized</simpara></listitem></varlistentry>
<varlistentry><term><parameter>all</parameter>&#160;:</term>
<listitem><simpara>if non-(0) it will deinitialize all the certificates and CRLs contained in the structure.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-get-issuer" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_get_issuer ()</title>
<indexterm zone="gnutls-x509-trust-list-get-issuer" role="3.0"><primary>gnutls_x509_trust_list_get_issuer</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_get_issuer   (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *issuer</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>);</programlisting>
<para>
This function will attempt to find the issuer of the
given certificate.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>is the certificate to find issuer for</simpara></listitem></varlistentry>
<varlistentry><term><parameter>issuer</parameter>&#160;:</term>
<listitem><simpara>Will hold the issuer if any. Should be treated as constant.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Use (0).</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-init" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_init ()</title>
<indexterm zone="gnutls-x509-trust-list-init" role="3.0"><primary>gnutls_x509_trust_list_init</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_init         (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> *list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> size</parameter>);</programlisting>
<para>
This function will initialize an X.509 trust list structure.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure to be initialized</simpara></listitem></varlistentry>
<varlistentry><term><parameter>size</parameter>&#160;:</term>
<listitem><simpara>The size of the internal hash table. Use (0) for default size.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-t" role="typedef">
<title>gnutls_x509_trust_list_t</title>
<indexterm zone="gnutls-x509-trust-list-t"><primary>gnutls_x509_trust_list_t</primary></indexterm>
<programlisting>  typedef struct gnutls_x509_trust_list_st *gnutls_x509_trust_list_t;
</programlisting>
<para>
</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-verify-crt" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_verify_crt ()</title>
<indexterm zone="gnutls-x509-trust-list-verify-crt" role="3.0"><primary>gnutls_x509_trust_list_verify_crt</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_verify_crt   (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> *cert_list</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> cert_list_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>,
                                                         <parameter><link linkend="gnutls-verify-output-function"><type>gnutls_verify_output_function</type></link> func</parameter>);</programlisting>
<para>
This function will try to verify the given certificate and return
its status. The <parameter>verify</parameter> parameter will hold an OR'ed sequence of
<link linkend="gnutls-certificate-status-t"><literal>gnutls_certificate_status_t</literal></link> flags.
</para>
<para>
Limitation: Pathlen constraints or key usage flags are not consulted.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert_list</parameter>&#160;:</term>
<listitem><simpara>is the certificate list to be verified</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert_list_size</parameter>&#160;:</term>
<listitem><simpara>is the certificate list size</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>verify</parameter>&#160;:</term>
<listitem><simpara>will hold the certificate verification output.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>func</parameter>&#160;:</term>
<listitem><simpara>If non-null will be called on each chain element verification with the output.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>
<refsect2 id="gnutls-x509-trust-list-verify-named-crt" role="function" condition="since:3.0">
<title>gnutls_x509_trust_list_verify_named_crt ()</title>
<indexterm zone="gnutls-x509-trust-list-verify-named-crt" role="3.0"><primary>gnutls_x509_trust_list_verify_named_crt</primary></indexterm>
<programlisting><link linkend="int"><returnvalue>int</returnvalue></link>                 gnutls_x509_trust_list_verify_named_crt
                                                        (<parameter><link linkend="gnutls-x509-trust-list-t"><type>gnutls_x509_trust_list_t</type></link> list</parameter>,
                                                         <parameter><link linkend="gnutls-x509-crt-t"><type>gnutls_x509_crt_t</type></link> cert</parameter>,
                                                         <parameter>const <link linkend="void"><type>void</type></link> *name</parameter>,
                                                         <parameter><link linkend="size-t"><type>size_t</type></link> name_size</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> flags</parameter>,
                                                         <parameter>unsigned <link linkend="int"><type>int</type></link> *verify</parameter>,
                                                         <parameter><link linkend="gnutls-verify-output-function"><type>gnutls_verify_output_function</type></link> func</parameter>);</programlisting>
<para>
This function will try to find a certificate that is associated with the provided 
name --see <link linkend="gnutls-x509-trust-list-add-named-crt"><function>gnutls_x509_trust_list_add_named_crt()</function></link>. If a match is found the certificate is considered valid. In addition to that
this function will also check CRLs. The <parameter>verify</parameter> parameter will hold an OR'ed sequence of
<link linkend="gnutls-certificate-status-t"><literal>gnutls_certificate_status_t</literal></link> flags.
</para><variablelist role="params">
<varlistentry><term><parameter>list</parameter>&#160;:</term>
<listitem><simpara>The structure of the list</simpara></listitem></varlistentry>
<varlistentry><term><parameter>cert</parameter>&#160;:</term>
<listitem><simpara>is the certificate to be verified</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name</parameter>&#160;:</term>
<listitem><simpara>is the certificate's name</simpara></listitem></varlistentry>
<varlistentry><term><parameter>name_size</parameter>&#160;:</term>
<listitem><simpara>is the certificate's name size</simpara></listitem></varlistentry>
<varlistentry><term><parameter>flags</parameter>&#160;:</term>
<listitem><simpara>Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>verify</parameter>&#160;:</term>
<listitem><simpara>will hold the certificate verification output.</simpara></listitem></varlistentry>
<varlistentry><term><parameter>func</parameter>&#160;:</term>
<listitem><simpara>If non-null will be called on each chain element verification with the output.</simpara></listitem></varlistentry>
<varlistentry><term><emphasis>Returns</emphasis>&#160;:</term><listitem><simpara>On success, <link linkend="GNUTLS-E-SUCCESS:CAPS"><literal>GNUTLS_E_SUCCESS</literal></link> (0) is returned, otherwise a
negative error value.</simpara></listitem></varlistentry>
</variablelist><para role="since">Since 3.0</para></refsect2>

</refsect1>

</refentry>
